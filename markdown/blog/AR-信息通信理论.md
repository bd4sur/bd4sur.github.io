#!title:    信息通信理论

#!content

References

- 奥本海姆 等. 信号与系统（第二版）[M]. 刘树棠, 译. 电子工业出版社.
- 奥本海姆 等. 信号、系统及推理[M]. 机械工业出版社, 2017.
- S W Smith. [实用数字信号处理：从原理到应用](http://www.dspguide.com/)[M]. 人民邮电出版社, 2010.
- Simon Haykin. Communication Systems (4th Edition) [M]. Wiley, 2001.
- 樊昌信, 曹丽娜. 通信原理（第七版）[M]. 国防工业出版社.
- 江志红. 深入浅出数字信号处理[M]. 北京航空航天大学出版社, 2012.

![ ](./image/G3/gate-spectrum.png)

# 信号与系统基础

## 信号的简单变换

已知信号f(t)的时域波形，如何绘制f(at+b)的波形：

- 将f(at+b)改写为$f(a(t + \frac{b}{a}))$
- **先反转**
-- 如果a\<0，则将f(t)的波形关于y轴翻转。
- **再缩放**（尺度变换）
-- 如果$0 < |a| < 1$，则将上一步得到的波形拉伸$1/|a|$倍。
-- 如果$|a| > 1$，则将上一步得到的波形压缩$|a|$倍。
- **最后平移**（时延）
-- 如果$b/a > 0$，则将上一步得到的波形左移$|b/a|$单位。
-- 如果$b/a < 0$，则将上一步得到的波形右移$|b/a|$单位。

## 信号的分类

**周期信号的判断**

如果含有n个不同频率余弦分量的复合信号，是一个周期为T的周期信号，则其周期必为各分量周期的公倍数。只要能够将各分量的角频率表示为整数的比，即可判定该信号为周期信号。如果各分量的角频率之比为$\omega_1 : \omega_2 : … : \omega_n = m_1 : m_2 : … : m_n$，则周期T为

$$ T = m_i T_i = m_i \frac{2 \pi}{\omega_i}$$

如果某两个分量的比值为无理数，则合成信号为**概周期信号**，不是周期信号。

**能量信号与功率信号**

定义连续信号x(t)在所有时间上的能量E和平均功率P：

$$ E = \lim_{T→ \infty}{ \int_{-T}^{T} { x^2(t) \mathrm d t } } $$

$$ P = \lim_{T→ \infty}{ \frac{1}{2T} \int_{-T}^{T} { x^2(t) \mathrm d t } } $$

- **能量信号**：信号能量E为非零的有限值。
- **功率信号**：信号平均功率P为非零的有限值。
- 非能量信号且非功率信号。
- 不可能同时是能量信号和功率信号。（能量信号在无限长时间内的平均功率为0）
- 周期信号是功率信号；单位冲激是能量信号。
- 非周期信号未必是能量（有限）信号。反例：单位阶跃。
- 能量信号必为非周期信号。

## 重要信号

**复指数信号**

连续复指数信号是周期信号：

$$ x(t) = \mathrm{e} ^{ \mathrm{j} \omega_0 t} $$

其基波频率为$ \omega_0$，周期为$2\pi / \omega_0$。

离散情况下，复指数信号具有以下两个重要性质（参见奥本海默教材§1.3.3）：

+ 离散复指数信号未必是周期信号。只有当$\omega_0 / 2 \pi$为有理数时，离散复指数信号才是周期信号。
+ 两个角频率相差$2 \pi$的离散复指数信号完全相同。因而处理离散复指数信号集合的时候，只需要考虑角频率范围$[\omega, \omega + 2 \pi)$的区间就足够了。

**单位冲激信号**

单位冲激信号$ \delta (t)$，①其值仅在0时刻为非0（不关心具体是什么），其余时刻均为0，且②总能量为1，即

$$ \int _{- \infty} ^{ + \infty} \delta (t) \mathrm{d}t = 1$$

以上两点即构成单位冲激信号的完整定义。它的主要性质有：

- 筛选性质：$ x(t) \delta (t - k) = x(k) \delta (t - k)$
- 采样性质：$ \int  _{- \infty} ^{ + \infty} x(t) \delta (t-k) dt = x(k)$
- 坐标变换：$ \delta (at) = \frac{1}{|a|} \delta (t)$

其一阶导数是一对冲激，称为“冲激偶”。

# 线性时不变系统

线性系统，指的是满足叠加性质的系统。即，如果输入信号是若干个基本信号的线性组合，将其输入线性系统后的输出，等于这些基本信号分别输入该线性系统后得到的输出信号的线性组合。记基本信号为$s_1$和$s_2$，线性系统对输入信号s的响应为$T(s)$，则线性系统满足：

$$ T(as_1 + bs_2) = aT(s_1) + bT(s2) $$

时不变系统，指满足$ T(s(t)) = T(s(t-t_0))$的系统，这意味着时不变系统对于时移信号的响应与输入信号的时移是一致的，进一步地说，时不变系统本身是不随时间变化的。作为对比，时间压缩系统$y(t) = x(2t)$是一个典型的时变系统，因为它压缩了时间的尺度，使得该系统对时移信号的响应信号的时移，仅有输入信号的一半。

线性和时不变性是两个独立的性质。同时具有线性和时不变性质的系统，称为**线性时不变（Linear Time-Invariant，LTI）系统**。

## 离散信号的脉冲表示

首先考虑一个问题：如何使用一组不同时移的单位脉冲序列的线性组合，来表示任意的离散信号（序列）x[n]。

这个问题在直观上很容易理解：离散序列的每个点，都是移位并加权了的单位脉冲序列（在移位位置上的值）。那么显然，将所有这些移位加权的序列加总起来，就得到了原始的离散序列。根据单位脉冲序列的性质也可以知道：

$$ x[n] = \sum _{k = - \infty} ^{ + \infty} x[k] \delta [n - k]$$

这与直观理解是一致的，即离散序列可以视为k移位加权的单位脉冲序列的加总，权重即为序列在相应移位位置k上的值x[k]。

## LTI系统对离散序列的响应

**① 考虑线性系统对离散序列的响应。**

由于离散序列可以表示为一组不同时移的单位脉冲的线性组合，所以线性系统对离散序列的响应，就等于线性系统对于每个时移单位脉冲的响应的线性组合。

记线性系统对时移单位脉冲的响应为$h_k[n]$，其中k为时移量。线性系统未必是时不变的，因此$h_k[n]$可能与k有关。

因此，线性系统对于离散序列$x[n]$的响应$y[n]$就是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h_k[n] $$

**② 如果线性系统也是时不变系统呢？**

既然是时不变系统，那么$h_k[n]$就等于$h_0[n - k]$，其中$h_0[n]$就是这个线性时不变系统对于（无时移）单位脉冲序列的响应，称为系统的**单位脉冲响应**。简单起见，将$h_0[n]$直接写成$h[n]$，这样的话，线性时不变系统对于离散序列的响应，就可以写成是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h[n - k] \tag{3-1}$$

上式（3-1）定义为x[n]与h[n]的**卷积**（和）运算，记为

$$ y[n] = x[n] * h[n] $$

于是可以说：**LTI系统对于离散序列的响应，等于输入序列与系统单位脉冲响应的卷积。**

## 连续信号的冲激表示

这一节要解决的问题与3.1节的问题是类似的：如何用一组不同时移的单位冲激信号的线性组合，来表示任意的连续信号x(t)。

直观上的理解与离散序列的情况是类似的，不同的是需要使用极短间隔Δ→0的极限去代替离散序列的加总。这种情况下，加总就变成了积分，但思想是一致的。根据单位冲激函数的性质可知

$$ x(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) \delta (t - \tau) \mathrm{d} \tau $$

与离散情况类似，连续信号可以表示为加权的单位冲激函数在所有位移τ上的积分，权重即为原信号在相应位移τ上的值x(τ)。

## LTI系统对连续信号的响应

与3.2节的分析类似，这里不再详细讨论，直接给出结论。

设h(t)为LTI系统的**单位冲激响应**，则LTI系统对连续信号x(t)的响应y(t)为

$$ y(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) h (t - \tau) \mathrm{d} \tau  \tag{3-2}$$

式（3-2）定义为x(t)与h(t)的**卷积**（积分）运算，记为

$$ y(t) = x(t) * h(t) $$

因此可以说，**LTI系统对于连续信号的响应，等于输入信号与系统单位冲激响应的卷积。**

## 叠加积分和卷积

**如何理解卷积？**

卷积可以看作是滑动平均的推广。在卷积的表达式(3-1)(3-2)中，将积分变量$k$（或$\tau$）视为绝对时间，而将$n$（或$t$）视为位移量，则，卷积所得到的结果，实际上是关于位移量的函数。

为了便于理解，考虑一个时限函数（如矩形窗等）与另一个函数做卷积的场景。在这里，将时限函数视为作滑动平均操作时所使用的**滑动窗口**，其函数值即为窗口内每点的权重。考虑到反褶的函数$g(t-\tau)$含有位移变量$t$，因此可将其视为滑动窗口，其中位移变量$t$即为滑动窗口的位移量。

窗口函数$g(\tau)$一般应当有比较好的性质，例如明显的对称性、起始点等，这样有利于画出它的反褶$g(-\tau)$，也便于确定“锚点”。在反褶窗口的基础上，选定原点为反褶窗口的“锚点”，将其以锚点为中心平移$t$个单位，得到位移后的滑动窗口$g(-(\tau-t))=g(t-\tau)$。注意，这里的平移应当是算术平移，即：当t为正数时，则将反褶窗口的锚点从原点向右移动到t点处；当t为负数时，则将反褶窗口的锚点从原点向左移动到t点（位于负半轴）处。

当位移量$t$确定后，即可将滑动窗口$g(t-\tau)$与$f(\tau)$相乘，得到乘积函数。相乘的方法是相同位置（$\tau$的取值）上的函数值相乘。对这个乘积函数作积分，积分限为负无穷到正无穷，得到一个积分值。这个积分值，即为$(f*g)(t)$的值。将其绘制到以$t$为横轴的图像上，逐点描点连线，即可得$(f*g)$的图像。

对于这个积分过程需要说明的是，由于滑动窗口往往是时限的，因而它只在$t$附近的一段区间内为非0，除此之外均为0。因而这个滑动窗口与$f(\tau)$相乘的结果，就是只保留了$f(\tau)$与滑动窗口重叠部分的值，并以$g(t-\tau)$的值作为权重，对$f(\tau)$加了权。而$f(\tau)$位于窗口以外的部分，则因乘以0而被“屏蔽”。因此，积分的上下限，事实上就是滑动窗口的范围。

当然，卷积作为一种运算，并不会对参与运算的信号提出时限或者如何的要求。只不过站在做题的角度，一般都会使用时限的窗口来出题。最典型的就是两个矩形窗口作卷积。

**卷积的性质及其证明**

**卷积交换律**

$$ f(t) * g(t) = g(t) * f(t) $$

交换律很容易证明，从定义式出发，简单换元即可。

**卷积分配律**

$$ f * ( g_1 * g_2 ) = f * g_1 + f * g_2 $$

证明：

$$ \begin{align}
&f * (g_1 * g_2) = \\\\
&= \int _{-\infty} ^{\infty} f(\tau) (g_1(t - \tau) + g_2(t - \tau)) \mathrm{d} \tau \\\\
&= \int _{-\infty} ^{\infty} f(\tau) g_1(t - \tau) \mathrm{d} \tau + \int _{-\infty} ^{\infty} f(\tau) g_2(t - \tau) \mathrm{d} \tau \\\\
&= f * g_1 + f * g_2
\end{align} $$

**卷积结合律**

![ ](./image/G3/SS-1-卷积结合律.png)

**卷积的微分**

$$ \begin{align}
&\frac{\mathrm{d}}{\mathrm{d} t} (f(t) * g(t)) \\\\
&= \left( \frac{\mathrm{d}}{\mathrm{d} t} f(t) \right) * g(t) \\\\
&= f(t) * \left( \frac{\mathrm{d}}{\mathrm{d} t} g(t) \right)
\end{align} $$

证明：直接把导数算子移进卷积定义式，结合交换律即可证明。

**卷积的积分**

$$ \begin{align}
&\int _{- \infty} ^t (f(\tau) * g(\tau)) \mathrm{d} \tau \\\\
&= f(t) * \int _{- \infty} ^t g(\tau) \mathrm{d} \tau \\\\
&= \int _{- \infty} ^t f(\tau) \mathrm{d} \tau * g(t) \\\\
\end{align} $$

证明方法与微分性质类似，把积分移入定义式即可。

**时移的卷积**

如果$f_1 * f_2 = f$，则：

$$ f_1(t - t1) * f_2(t - t_2) = f(t - t_1 - t_2)$$

证明方法是从卷积定义式出发，换元整理即可。

**常用卷积公式**

$$ f(t) * \delta (t) = f(t) \tag{全通} $$

$$ f(t) * \delta (t - t_0) = f(t - t_0) \tag{时移} $$

$$ f(t) * \delta '(t) = \frac{\mathrm{d}}{\mathrm{d}t} f(t) \tag{微分} $$

$$ f(t) * \epsilon (t) = \int _{-\infty} ^t f(\tau) \mathrm{d} \tau \tag{积分} $$

TODO 两个矩形窗卷积

**相关函数**

**互相关函数**$R_{xy}(t)$定义为两个函数$x(\tau)$和$y(\tau)$错位相乘的乘积结果，在所有时间上的积分，关于错位量s(hift)的函数。即

$$ R_{xy}(s) = \int _{- \infty} ^{+ \infty} x(\tau) y(\tau - s) \mathrm{d} \tau $$

这个定义式里面的“错位部分”跟卷积定义式是相反的。二者物理意义截然不同。

**自相关函数**就是某个函数与其自身作互相关。**自相关函数是偶函数**，因为对于同一个函数而言，错位量的正负，仅代表参考者的选取不同，无论往哪个方向错位，结果都仅与错位量的绝对值有关。

直觉上可以看出，周期函数的自相关函数也是周期函数，且在周期的整数倍上取得极值。

# 傅里叶分析

## 信号的正交分解理论

向量内积（点积），可用于描述两个向量之间的“距离”。即，当两个向量同向时，内积取得最大值；当两个向量反向时，内积取得最小值。而当（且仅当）两个向量正交时，内积取0。

如果将向量看成两列数，则两个向量的内积，等于对应维度上的数相乘，然后相加。

现在研究一个问题：现有基准向量$\mathbf U$以及任意向量$\mathbf A$，希望把$\mathbf A$表示成$c \mathbf U$的形式，使得误差的模的平方$|c \mathbf U - \mathbf A|^2$最小化，那么系数c应当如何取值？从几何直观的角度看，只需误差向量$\mathbf A - c \mathbf U$与基准向量$\mathbf U$垂直即可。此时可求出**平方误差最小意义下的**最佳表示系数

$$ c = \frac{\mathbf A \cdot \mathbf U}{\mathbf U \cdot \mathbf U} \tag{4.1.1}$$

这个式子可以这样理解：分子是向量$\mathbf A$在基准向量$\mathbf U$上的投影长度，而分母是基准向量的长度。二者之比即为最佳表示系数。

如果基准向量有两个，则可以通过平行四边形法则，找到两个系数$c_1$和$c_2$，使得$\mathbf A = c_1 \mathbf U_1 + c_2 \mathbf U_2$。可以想象，如果$\mathbf U_1$和$\mathbf U_2$正交，则每个表示系数都仅与对应的基准向量有关，这样每个表示系数都可以运用式(4.1.1)计算。

以上讨论并不严密，仅为建立直观帮助理解，并为后面引入信号在正交基上作合成分解做铺垫。

------

对于复值函数而言，也可以看成是一列复数，只不过这个复数序列是稠密的。因而比照向量内积的概念，可以给出函数内积的概念，用以衡量两个函数的“距离”。复值函数内积定义为：

$$ f \cdot g = \int f(\tau) g^*(\tau) \mathrm d \tau $$

需要注意的是：①由于函数自变量的取值是稠密的，因而求和变成积分；②复信号（向量）内积实际上是所谓的Hermitian（厄米特/埃尔米特）内积。一个复信号与其自身的Hermitian内积，数值上等于其模平方。由于与能量/功率保持相似的量纲和物理含义，故赋予其此种物理解释。至于Hermitian内积为什么要取共轭，这是复向量空间自身的性质所决定。如果不取共轭，则会推出矛盾。

至此可以提出函数（能量）正交的概念：**在某个区间T内**，两个函数f和g的内积为0，即

$$ \int _T f(\tau) g^*(\tau) \mathrm d \tau = 0$$

进而可以给出**正交函数集合**的概念：在某个区间T内，一组函数构成的集合，任意两个不同的函数相互正交，而每个函数与自己的内积都不为0。

仿照上面向量正交分解的问题，可提出函数的正交分解问题。函数的正交分解，目的是将函数$f(t)$表示为一组正交基底函数集合$\{u_n(t)\}$的加权和。那么，仿照上面的讨论过程，可以得出一般的计算第n个基底函数$u_n(t)$上的分解系数$c_n$的公式：

$$ c_n = \frac{u_n \cdot f}{u_n \cdot u_n} = \frac{\int_{T} f(\tau)u_n^*(\tau) \mathrm d \tau}{\int_{T} u_n(\tau)u_n^*(\tau) \mathrm d \tau} $$

这样，如果分解是可行的，则函数$f(t)$被分解为这种形式：

$$ f(t) = \sum_{n}^{所有可行取值} c_n u_n(t) $$

这就是傅里叶级数和傅里叶变换——把信号分解为三角正交基的加权和——的基本模式。

## 连续周期信号的傅里叶级数

傅里叶级数FS的作用对象是**[[#ff0000:连续的周期信号#]]**，因而要时刻牢记周期信号的**周期**$T$（对应**基波频率**$\Omega = 2 \pi / T$），这是本节一切内容所共用的“全局参数”。

<details>

<summary>其他形式</summary>

**形式1：三角正交基**

这是傅里叶最初提出的形式，也是物理意义最显著的形式，但计算较复杂。

$$ x(t) = \frac{a_0}{2} + \sum _{n=1}^{\infty} \left( a_n \cos(n \Omega t) + b_n \sin(n \Omega t) \right) \tag{FS-1}$$

$$ \begin{cases}
a_n = \frac{2}{T} \int _{T} x(t) \cos(n \Omega t) \mathrm d t \\\\
b_n = \frac{2}{T} \int _{T} x(t) \sin(n \Omega t) \mathrm d t
\end{cases} \tag{FS-1A}$$

注意：①在任意整周期内积分结果相同（这是周期函数积分的性质）；②谐波系数前缀的$2/T$。

**形式2：余弦正交基**

考虑到正弦函数与余弦函数本质上是同一函数（仅相位相差90°），因而可以统一使用余弦函数作为正交基。这种情况下，**三角展开式的余/正弦系数$a_n$和$b_n$，就相应地转换成了余弦基的幅度$|A_n|$和相位$\phi_n$。**

$$ x(t) = \frac{a_0}{2} + \sum _{n=1}^{\infty} |A_n| \cos(n \Omega t + \phi_n) \tag{FS-2}$$

其中$|A_n|$（实数）和$\phi_n$与$a_n$和$b_n$的关系是：

$$ \begin{cases}
|A_n| = \sqrt {a_n^2 + b_n^2} \\\\
\phi_n = - \arctan \frac{b_n}{a_n}
\end{cases} \tag{FS-2A}$$

通过欧拉公式将余弦基底拆成复指数形式，并根据$|A_n|$和$\phi_n$关于n的对称性（幅度是偶函数，相位是奇函数），将二者合成为复数系数$A_n$，得到：

$$ x(t) = \frac{1}{2} \sum _{n=- \infty} ^{\infty} A_n \mathrm e ^{\mathrm j n \Omega t} \tag{FS-2.1}$$

**忘掉这个形式吧，只会徒增混乱。**

</details>

**形式3：复指数正交基**

直接使用复指数信号作为正交基底。这种形式在数学上比较简洁，但会引入“负频率”，降低了物理直观性。

$$ x(t) = \sum _{n=- \infty} ^{\infty} c_n \mathrm e ^{\mathrm j n \Omega t} \tag{FS-3}$$

$$ c_n = \frac{1}{T} \int _T x(t) \mathrm e ^{- \mathrm j n \Omega t} \tag{FS-3A}$$

注意：①任意整周期内积分；②谐波系数前缀的$1/T$；③计算谐波系数时，是与复指数的**共轭（指数上带负号）**相乘（同CTFT）。

<details>

<summary>系数的关系</summary>

将(FS-2)与(FS-3)两种形式相比较，可见，二者的区别仅在于是否乘了1/2系数。因而复值谐波系数$A_n$与$c_n$的关系为：

$$ A_n = 2 c_n $$

从应试的角度来看，$A_n$以及$a_n$和$b_n$似乎更常用一些。因此要记住以下结论：

- 就谐波的相位而言，$A_n$和$c_n$是一致的。
- 三角正交基的谐波系数，是复指数正交基的系数的两倍。
- 信号的直流分量$a_0/2=c_0$。

</details>

![方波信号的4次谐波展开](./image/G3/fourier-series-deferent-epicycle.gif)

根据以上给出的傅里叶级数的形式，可以得到（一般的）周期实函数的频谱的一些性质：

- **周期函数的频谱是离散谱**。相邻谐波成分的间隔即为基波频率$\Omega$，也就是第一个谐波成分的频率。每个谐波成分都必然是基波频率的整数倍。
- 复频谱的实部是偶对称、虚部是奇对称。
- 幅度谱为偶对称、相位谱为奇对称。

信号对称性与其频谱的关系：

- 偶信号只包含余弦分量（频谱的实部）。
- 奇信号只包含正弦分量（频谱的虚部）。
- 非奇非偶信号，可以作奇偶分解。
- **奇谐函数**：满足$x(t + T/2) = - x(-t)$，图形上就是：**其任意半个周期的图形，可以由前半周期的波形取反（沿横轴反转）后得到**。
- 奇谐函数不含直流分量和偶次谐波，**只包含奇次谐波**。
- **偶谐函数**：满足$x(t + T/2) = x(t)$，图形上就是：**两半周期完全相同的周期函数**。
- 偶谐函数**只包含偶次谐波**（当然可以有直流分量）。

周期信号能够表示成傅里叶级数是有条件的。目前没有找到充要条件，但是有一个能够满足绝大多数现实信号的充分（不必要）条件，即**Dirichlet条件**：

+ 信号在每个周期内，都必须绝对可积。
+ 信号在每个周期内，都只有有限个极大值或极小值。
+ 信号在任何有限区间内，都只有有限个第一类间断点（可去、跳跃）。

注意：根据第1节描述的有关信号正交分解的知识，傅里叶级数的收敛，是均方误差意义上的收敛，而非一致收敛。因而在**吉布斯现象**中，尽管过冲量不会消失，但是在均方误差（能量）的意义上是收敛的。

## 连续时间傅里叶变换（CTFT）

连续时间傅里叶变换，其作用对象是满足Dirichlet条件的、一般是**非周期的连续信号**。

> **公式 连续时间傅里叶变换 CTFT**

> $$ X(j \omega) = \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - j \omega t } \mathrm{d} t $$

> $$ x(t) = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} X(j \omega) \mathrm{e} ^{ j \omega t } \mathrm{d} \omega $$

傅里叶变换系数$X(j \omega)$具有“单位频率的幅度”的量纲，因此其物理意义可以视为“频谱密度”。

CTFT是周期函数傅里叶级数（FS）的推广。其推广思路简要叙述如下：

- 首先，**非周期信号，可以看成是周期→∞（基波频率→0）的周期信号**。
- 第二，周期信号的傅里叶级数频谱是离散谱，其周期越长，基波频率越低，谱线越密集。
- 如果非周期信号是时限的（使其满足Dirichlet条件），那么可以对其作**周期延拓**。
- 若延拓周期→∞（基波频率→0），则延拓信号**就是**原来的非周期信号，其FS的谱线将无限密集，变成连续谱。这就是非周期信号的傅里叶变换。

上面介绍的都的傅里叶变换，为了使无限长的周期信号统一于傅里叶变换的体系内，可引入奇异函数如单位冲激函数，将周期信号的傅里叶级数，表示成单位冲激函数以谐波系数加权的和，这样就可以将有限长非周期信号和无限长周期信号的傅里叶变换纳入到统一的框架中。周期信号的傅里叶级数系数是离散的若干个值，代表各个谐波成分的强度。那么在连续谱的情形下，就可以推广为一族冲激信号的位移加权和。例如，频率为$\omega_0$的复指数信号$ \mathrm{e} ^{ \mathrm{j} \omega_0 t} $，其傅里叶变换$X( \mathrm{j} \omega)$为

$$ X( \mathrm{j} \omega) = 2 \pi \delta (\omega - \omega_0) $$

<details>

<summary>展开：非周期信号CTFT的导出过程。</summary>

![以周期T延拓一个长度为$2T_1$的矩形窗脉冲，所得到的频谱。从图中可以看到，**延拓周期越长，谱线越密集，但是频谱的包络不变。**可以推知，如果延拓周期无穷长，谱线之间的距离会无穷小，最终变成如包络线的连续谱。图源[1]](./image/G3/CTFT.png)

**① 延拓信号的傅里叶级数**

考虑一个时间有限的连续非周期信号$x(t)$。将其以周期T（对应基波频率$\Omega = 2 \pi / T$）重复并延拓，得到延拓后的周期信号$\tilde x(t)$。延拓信号可以表示成傅里叶级数的形式，并且取一个周期为[-T/2, T/2]作为主值周期：

$$ \tilde x(t) = \sum _{k = - \infty} ^{ + \infty} c_k \mathrm{e} ^{ \mathrm{j} k \Omega t} \tag{A1}$$

其频谱系数表达式为：

$$ c_k = \frac {1}{T} \int _{-T/2} ^{T/2} \tilde x(t) \mathrm{e} ^{ - \mathrm{j} k \Omega t} \mathrm{d} t \tag{A2}$$

尝试将频谱系数表达式（A2）中的$\tilde x(t)$换成$x(t)$，因为在[-T/2, T/2]内$ \tilde x(t) = x(t) $，除此之外$x(t) = 0$，因此可以将$\tilde x(t)$换成$x(t)$，同时可以将积分限换成正负无穷：

$$ c_k = \frac {1}{T} \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} k \Omega t} \mathrm{d} t \tag{A3}$$

**② 频谱系数的与延拓周期无关的包络函数**

频谱系数表达式（A3）中的$Tc_k$，可以看成是如下函数$X(\mathrm{j} \omega)$作为包络，在离散频点$\omega = k \Omega$处的采样。

$$ X( \mathrm{j} \omega) = \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} \omega t} \mathrm{d} t \tag{A4} $$

可见，这个包络函数$X( \mathrm{j} \omega)$与延拓周期$T$（以及基波频率$\Omega$）并没有关系，它仅由原来的非周期信号$x(t)$决定。将频谱系数$c_k$用包络函数$X( \mathrm{j} \omega)$来表示即为

$$ c_k = \frac{1}{T} X(\mathrm{j} k \Omega)$$

至此，延拓信号的傅里叶级数（A1）就可以用（与延拓周期无关，仅由原来的非周期信号决定的）包络函数$X( \mathrm{j} \omega)$表示成（注意$ T = 2 \pi / \Omega $）

$$ \tilde x(t) = \frac{1}{2 \pi} \sum _{k = - \infty} ^{ + \infty} \Omega X(\mathrm{j} k \Omega) \mathrm{e} ^{ \mathrm{j} k \Omega t} \tag{A5} $$

**③ 将周期性延拓信号的FS推广到原来的非周期信号**

若延拓周期$T → \infty$（即基波频率$\Omega → 0$），则延拓信号$\tilde x(t)$就**变成了**原来的非周期信号x(t)。考察延拓信号的傅里叶级数展开式（A5），这个离散谱的各个谐波成分之间的间隔，即基波频率，将趋于0。在这种极限情况下，频点$k \Omega$将变成连续的频率值$\omega$，而单独的基波频率因子$\Omega$变成连续频率的微分$\mathrm{d} \omega$。此时，延拓周期无限长的延拓信号，即原来的非周期信号的傅里叶级数，就从求和式转换成了积分式：

$$ x(t) = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} X(\mathrm{j} \omega) \mathrm{e} ^{ \mathrm{j} \omega t} \mathrm{d} \omega \tag{A6} $$

式（A6）为的合成形式，即$x(t)$的**傅里叶逆变换**（傅里叶积分）。式（A4）为$x(t)$的**傅里叶变换**。式（A6）的自变量之所以是$\mathrm{j} \omega$，是为了兼容拉普拉斯变换。

</details>

## 离散时间傅里叶变换（DTFT）

离散时间傅里叶变换的推导思路与连续时间情形的思路是类似的，即从非周期序列的延拓序列的傅里叶级数出发，推广到非周期序列的傅里叶变换，进而推广到周期序列的傅里叶变换。以下直接给出**离散时间傅里叶变换（DTFT）**的公式：

> **公式 离散时间傅里叶变换 DTFT**

> $$ X(\mathrm{e} ^{ \mathrm{j} \omega}) = \sum _{n = - \infty} ^{ + \infty} x[n] \mathrm{e} ^{- \mathrm{j}  \omega n} $$

> $$ x[n] = \frac{1}{2 \pi} \int _{2 \pi} X(\mathrm{e} ^{ \mathrm{j} \omega}) \mathrm{e} ^{ \mathrm{j} \omega n} \mathrm{d} \omega $$

由于频率相差2π的谐波信号是完全相同的，因此DTFT的积分限是任何长度为2π的区间，这也导致**离散序列的频谱是周期的**。该式实际上就是非周期信号x[n]的谐波组合表示，只不过由于x[n]是非周期的，组成它的谐波成分的基波频率趋于0，因此每个谐波成分之间的间距也趋于0，其频谱$X(\mathrm{e} ^{ \mathrm{j} \omega})$体现为连续谱，也就是说，**非周期信号的频谱是连续的**。

式DTFT的自变量之所以是$\mathrm{e} ^{ \mathrm{j} \omega}$，是为了兼容Z变换。

**离散时间傅里叶级数和DTFT的关系**：非周期有限长序列x[n]的傅里叶变换是连续谱，其等间隔采样就是x[n]的周期延拓序列的傅里叶级数的系数。

## 离散傅里叶变换（DFT）

| | | | | | |
|-----------|
|采样点数|-N|-N/2|0|+N/2|+N|
|物理频率|-fs|-fs/2|0|+fs/2|+fs|
|圆周频率|-2π|-π|0|+π|+2π|
|归—频率|-1|-0.5|0|+0.5|+1|

离散复指数序列，只需要考虑[0,2π)内的**归—化角频率**即可，对应物理频率的[0,fs)。因为如果把离散信号视为连续的冲激序列，它的频谱也是梳状的，并且每一个梳齿周围都是相同的频谱。

对于**无混叠带限实信号**而言，考虑到频谱的共轭对称性，只考虑[0,π)即可，因频谱搬移性质，[π,2π)的部分是[0,π)的镜像。但是对于一般的实信号来说，尽管频谱是共轭对称的，但由于存在混叠的可能性，[π,2π)与[0,π)未必是镜像关系。

一般的复信号，未必是带限的，离散采样后也有混叠的可能性，因此DFT后得到的实际上是有混叠的结果。这就是为什么在做DFT之前，一定要给原始信号加窗。因为不加窗的话，说不清得到的频谱究竟有没有混叠。

## 各种傅里叶变换之间的关系

在傅里叶变换和傅里叶级数中，存在着**离散-连续**和**周期-非周期**两大对立。对偶性质将这两大对立联系起来。一句话总结：**[[#ff0000:离散对周期，采样对延拓#]]**。

**[[#ff0000:信号不可能同时是时限和带限的。#]]**（[参考](https://en.wikipedia.org/wiki/Uncertainty_principle#Signal_processing)）在短时傅里叶变换中，要么牺牲时间分辨率换取频率分辨率，要么牺牲频率分辨率换取时间分辨率。

## 傅里叶变换的性质

如果$x(t) ↔ X(j \omega)$、$x_1(t) ↔ X_1(j \omega)$、$x_2(t) ↔ X_2(j \omega)$：

**4.0 对偶**

$$ X(jt) ↔ 2 \pi x(- \omega) $$

**4.1 线性**

$$ a x_1(t) + b x_2(t) ↔ a X_1(j \omega) + b X_2(j \omega) $$

**4.2 时移（频谱线性相移）**

$$ x(t - t_0) ↔ X(j \omega) \mathrm{e} ^{- j \omega t_0} $$

**4.3 频移（调制）**

$$ x(t) \mathrm{e} ^{j \omega_c t} ↔ X(j (\omega - \omega_c)) $$

**4.4 尺度变换**

$$ x(at) ↔ \frac{1}{|a|} X(j \frac{\omega}{a}) $$

**4.5 微分**

时域微分：

$$ \frac{\mathrm{d}}{\mathrm{d} t} x(t) ↔ j \omega X(j \omega)$$

频域微分：

$$ -jtx(t) ↔ \frac{\mathrm{d}}{\mathrm{d} \omega} X(j \omega)$$

**4.6 积分**

时域积分：

$$ \int _{- \infty} ^{t} x(\tau) \mathrm{d} \tau ↔ \pi \delta(w) X(0) + \frac{1}{jw} X(j \omega)$$

频域积分：

$$ \pi \delta(t) x(0) - \frac{1}{jt} x(t) ↔ \int _{- \infty} ^{\omega} X(\Omega) \mathrm{d} \Omega$$

> 注意：其证明过程需要用到以下关系，即将反褶平移后的单位阶跃函数作为窗口，将变限积分转换为无穷界限积分，以便于构造傅里叶变换的无穷限积分形式。

> $$ \int _{- \infty} ^{t} x(\tau) \mathrm{d} \tau = \int _{- \infty} ^{+ \infty} x(\tau) \epsilon(t - \tau) \mathrm{d} \tau  $$

**4.7 卷积**

时域卷积：

$$ x_1(t) * x_2(t) ↔ X_1(j \omega) \cdot X_2(j \omega)$$

频域卷积：

$$ x_1(t) \cdot x_2(t) ↔ \frac{1}{2 \pi} \left( X_1(j \omega) * X_2(j \omega) \right)$$

**4.8 帕斯瓦尔定理**

$$ \int _{- \infty} ^{+ \infty} | x(t) | ^2 \mathrm{d} t = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} | X(j \omega) | ^2 \mathrm{d} \omega $$

**4.9 共轭对称性**

若x(t)为实信号：

- $ X(j \omega) = X^*(-j \omega) $（画图方便理解）
- 频谱的实部为偶函数，对应偶成分（余弦成分）：$ \mathrm{Re} \{ X(j \omega) \} = \mathrm{Re} \{ X(-j \omega) \} $
- 频谱的虚部为奇函数，对应奇成分（正弦成分）：$ \mathrm{Im} \{ X(j \omega) \} = - \mathrm{Im} \{ X(-j \omega) \} $
- 频谱的模为偶函数
- 频谱的辐角为奇函数

一般地，若x(t)为复信号：

$$ x^*(t) ↔ X^*(-j \omega) $$

**4.10 实信号的奇偶分解**

- $ \mathrm{Ev} \{ x(t) \} ↔ \mathrm{Re} \{ X(j \omega) \} $
- $ \mathrm{Od} \{ x(t) \} ↔ j \mathrm{Im} \{ X(j \omega) \} $

## 常用信号的傅里叶变换

![ ](./image/G3/SS-2-常用傅里叶变换对.png)

# 快速傅里叶变换（FFT）

## 二进制反转（2016-09-08）

在FFT算法中，有一步是对数组下标进行“码位倒置”，具体说来就是把一个数字的各二进制位倒过来写。

最直接的想法是使用移位操作将输入数字的各个二进制位提取出来，然后按照相反的顺序压入另一个数字。但是，如果设下标二进制位数为n，那么这种算法的时间复杂度是$O(n)$。

下面是一种更快、更适合硬件的“就地”码位倒置算法。对于八位无符号整数，只需要三步操作即可。

```:C
#include <stdio.h>

unsigned char bit_reverse(unsigned char i)
{
    unsigned char n = i;
    n = ( (n&0x55)<<1 ) | ( (n&0xaa)>>1 );
    n = ( (n&0x33)<<2 ) | ( (n&0xcc)>>2 );
    n = ( (n&0x0f)<<4 ) | ( (n&0xf0)>>4 );
    return n;
}

int main(void)
{
    unsigned char n = 0;

    while(1)
    {
        printf("Please input the number = ");
        scanf("%d", &n);
        n = bit_reverse(n);
        printf("The reversed number is  = %d\n", n);
    }

    return 0;
}
```

该算法可以将码位倒置算法的时间复杂度控制在$O(\mathrm {log}(n))$，挺机智的。

这个算法是在编写FFT算法的时候找到的。

**参考资料**

- [Bit-reversal permutation](https://en.wikipedia.org/wiki/Bit-reversal_permutation)
- [Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)

## 基于FFT的大数乘法算法（2018-09-10）

大数乘法是很经典的一个问题，说简单也简单，说难也难。从最简单的错位相乘，到加入分治以提高效率，再到各种高效算法，是学习数值计算的很好的切入点。

大数乘法算法可以突破数据宽度的限制，保持运算结果的位数，因此在金融等场景中非常有用。在实现MikuRec解释器的时候，测试阶乘会遇到非常大的数字相乘，为了方便调试，打算使用大数相乘算法，取代JS语言提供的乘法。长远来看，这也有利于实现CAS之类的系统。

两个大整数相乘，本质上是卷积操作。卷积的时间复杂度是O(n<sup>2</sup>)。在数字位数很大的时候，效率不是很理想。

为了提高效率，可以利用卷积定理，通过快速傅里叶变换，将时间复杂度压缩到O(n*log(n))的级别。卷积定理指的是，两个序列卷积的傅里叶变换，等于两个序列傅里叶变换的按位相乘。因此，两个大数相乘，可以按照如下算法进行：

+ 对两个大数分别做FFT，得到两个新序列。
+ 两个序列按位相乘，得到傅里叶变换的乘积序列。这一步的时间复杂度是线性的。
+ 对乘积序列作傅里叶反变换，即为大数相乘结果。

FFT涉及浮点数运算，存在精度问题。如果使用不涉及浮点数运算的快速数论变换（NTT），就可以避免这个问题。

```
// 2018.10.10 大数乘法
function bigIntMultiply(astr, bstr) {
    // 自适应FFT长度
    let maxlen = Math.max(astr.length, bstr.length) * 2;
    let loglen = Math.round(Math.log2(maxlen));
    let FFTSIZE = (loglen % 2 === 0) ? POW[loglen+2] : POW[loglen+1]; // 偶数POW
    // 字符串->复数序列
    let a = new Array(FFTSIZE);
    let b = new Array(FFTSIZE);
    for(let i = 0; i < FFTSIZE; i++) {
        aDigit = (i < astr.length) ? parseInt(astr[astr.length-1-i]) : 0;
        bDigit = (i < bstr.length) ? parseInt(bstr[bstr.length-1-i]) : 0;
        a[i] = new Complex(aDigit, 0);
        b[i] = new Complex(bDigit, 0);
    }
    // 傅氏变换
    let A = FFT(a, FFTSIZE);
    let B = FFT(b, FFTSIZE);
    // 卷积
    let C = new Array();
    for(let i = 0; i < FFTSIZE; i++) {
        let c = A[i].mul(B[i]);
        C.push(c);
    }
    let c = IFFT(C, FFTSIZE);
    // 以字符串输出
    return (function(n) {
        let numstr = '';
        let carry = 0;
        for(let i = 0; i < n.length; i++) {
            let c = Math.round(n[i].rep) + carry;
            if(c >= 0 && c <= 9) {
                numstr = c.toString() + numstr;
                carry = 0;
            }
            else {
                numstr = (c % 10).toString() + numstr;
                carry = Math.round((c - c % 10) / 10);
            }
        }
        return numstr.replace(/^0*/gi, '');
    })(c);
}
```

**参考资料**

+ [Schönhage–Strassen algorithm](https://en.wikipedia.org/wiki/Sch%C3%B6nhage%E2%80%93Strassen_algorithm)
+ [大数乘法（快速傅立叶变换）](https://blog.csdn.net/u013351484/article/details/48739415)
+ [FFT详解&大数乘法](https://blog.csdn.net/ripped/article/details/70241716)

## 离散余弦变换（DCT）

8点快速DCT信号流图（Loeffler C , Ligtenberg A , Moschytz G S . **Practical fast 1-D DCT algorithms with 11 multiplications**[C]. ICASSP-89.）：

![8点快速DCT信号流图](./image/G3/DCT8-fast.svg)

8点快速IDCT信号流图（基于上面的信号流图推导）：

![8点快速IDCT信号流图](./image/G3/IDCT8-fast.svg)

附：蝴蝶结反向的系数关系，本质上是解二元一次方程组。

![蝴蝶结反向的系数关系](./image/G3/butterfly.svg)

**改进的离散余弦变换（MDCT）**

## 快速沃尔什变换

## 快速数论变换（NTT）

## K-L变换

# 采样

## Nyquist采样定理

2022-06-04

从[这篇文章](https://zhuanlan.zhihu.com/p/33554898)提供的第一个视频开始讲起。

譬如，用纸片刮风扇扇叶，如果转速比较慢，那么每个脉冲都保持自己的“音色”，人耳可以区分出每个脉冲。随着转速升高，脉冲连成“一片”，出现音调，并且转速越快，音调越高。

下图蓝色的连续谱是脉宽为1ms的方波的频谱，可见其大部分能量分布在1kHz以内，说明这是个听起来比较低沉的脉冲。

而黄色的离散谱，是以5ms为周期，重复播放这个脉宽为1ms的脉冲的方波。可以看到，谱线的第一基频是200Hz，其余谱线是方波连续谱的采样。这其实就是周期方波的频谱，听起来是典型的“电音”音色。其基音频率，就是第一基频的200Hz。

采样定理在直观上可以理解为对时域的均匀采样，会导致信号（带限）频谱的周期延拓。而上述现象可以理解为采样定理的对偶形式：对时域（时限）信号的周期延拓，会导致信号频谱的离散化。

![实测](./image/G3/pulse_series_spectrogram.jpg)

![理论分析（Octave代码见下文）](./image/G3/pulse_series_spect.png)

```
# Octave

sample_rate = 8000; %采样率（Hz）
T = (0 * sample_rate) : 1 : (1 * sample_rate - 1); %时间轴（采样点）
duration = length(T); %采样点数量
pulse = zeros(1, 1 * sample_rate); %初始化脉冲序列

%% 构造单个脉冲
amp = 1; %脉冲幅度
pulsewidth = 0.001; %脉宽（秒）
for t = T
    if (t >= ((0.5 - (pulsewidth/2)) * sample_rate)) && (t <= ((0.5 + (pulsewidth/2)) * sample_rate))
        pulse(t) = amp;
    endif
end

%% 构造脉冲序列
pulse_series = zeros(1, 1 * sample_rate);
interval = 0.005; %脉冲间隔（秒）
for i = 1 : 1 : floor(length(T) / (interval * sample_rate))
    offset_left  =  floor(interval * sample_rate * i);
    offset_right = -floor(interval * sample_rate * i);
    pulse_series = pulse_series + circshift(pulse, offset_left);
    pulse_series = pulse_series + circshift(pulse, offset_right);
end
%% 能量归一化（便于比较频谱）
pulse_series = pulse_series ./ (2 * length(T) / (interval * sample_rate));

%% 计算并绘制频谱
freq_axis = -(sample_rate / 2) : 1 : (sample_rate / 2) - 1;
pulse_spect = fftshift(abs(fft(pulse).^2 / length(T)));
pulse_series_spect = fftshift(abs(fft(pulse_series).^2 / length(T)));

plot(freq_axis, pulse_spect);
hold on;
plot(freq_axis, pulse_series_spect);

title ("Power Spectrum");
legend("single square pulse", "pulse series");
```

## 压缩感知

**问题：传统Nyquist采样成本高、效率低**

- 传统Nyquist采样是均匀采样。受Nyquist采样定理限制，其采样率一般需要**高于被采样信号带宽的两倍**，才不至于发生混叠失真。
- 对于高分辨率音视频、宽带射频信号等，由于其带宽本就非常宽，因而所需采样率非常高。工程上，高采样率的实现是**非常昂贵、困难**的。
- 自然界中的许多信号，例如音视频信号，在某个表示域内往往是**稀疏的**、存在冗余的，因而消耗大量采样成本采集到的“生”信号，最终往往要被压缩编码才适合处理，这是**对感知资源的浪费**。
- 能否将采样（感知）与压缩合二为一？

**解决方案：压缩感知**

- 对于**在某个表示域稀疏**的信号，可使用一组“采样信号”对原信号作内积（采样），其中采样信号的数量**远少于**原信号维度，这就是对原信号的稀疏采样。
- 从稀疏采样中恢复原始信号的过程，可以理解成解方程组。然而稀疏采样与原信号和采样信号之间构成欠定方程组，因而需要通过求解优化问题的方式，从采样结果中**估计出**最优（即所有可能的原始信号中最稀疏）的原信号。不幸的是，此类问题一般是需遍历所有可能结果的NP-hard的非凸优化问题。但在**某些简化条件**下，问题可被转化为凸优化问题，能行地解决。
- 近年来有使用深度学习算法解决CS采样恢复问题的工作。
- 压缩感知及恢复可行的条件是**原信号稀疏**、采样信号和恢复算法满足一定条件。

------

**稀疏数据与数据压缩**

许多物理信号是稀疏的，或者说存在大量冗余，可能是时域、空域稀疏，也可能是变换域稀疏。

传统的信息通信模型：

数据采集→数据压缩→数据传输→数据解压

- 采集成本高（动辄一亿像素摄像头之类的）
- 压缩成本高（编码器复杂度高）
- 传输成本视乎压缩技术而定
- 解压成本低（解码器复杂度远低于编码器）

新的针对稀疏数据的信息通信模型：

压缩感知→数据编码→数据传输→数据解压

要点是：①如何保证少量的采样数据可以包含原始信号的全局信息，实现采样压缩的合并；②寻找算法从少量数据中尽可能低失真地恢复出原先的信息。

这样可以减少采集和压缩成本，但是理论和工程可行性仍需探索。

传统Nyquist采样痛点：信号带宽越来越大，采样成本越来越高。但是实际采样到的数据又往往存在大量冗余，采样到之后还要进行数据压缩。这种先采样再压缩的过程，是对采样资源的巨大浪费。

**压缩感知一般过程**

![Compressive sensing measurement process with (random Gaussian) measurement matrix Ф and discrete cosine transform (DCT) matrix Ψ. The coefficient vector s is sparse with K = 4.](./image/G3/compressive-sensing-sampling.png)

+ 将原始信号变换为稀疏信号（稀疏变换）。
+ 使用感知信号对稀疏信号作随机欠采样，得到远少于采样定理所要求的数量的少量样本。采集到的少量样本与感知信号构成一个线性欠定方程组。
+ 在“稀疏”和失真最小化的约束下，求解优化问题，以得到欠定方程组的稀疏解。

**压缩感知应用**

单像素照相机

![ ](./image/G3/compressive-single-pixel-camera.png)

**参考资料**

- [形象易懂讲解压缩感知](https://zhuanlan.zhihu.com/p/22445302)
- 戴琼海, 付长军, 季向阳. **[压缩感知研究](http://cjc.ict.ac.cn/quanwenjiansuo/2011-3/dqh.pdf)**[J]. 计算机学报, 2011, 34(3): 425-434.
- Richard Baraniuk. **Compressive Sensing - A New Approach to Signal Acquisition and Processing**[S]. Rice Univ. （包括相关的课程讲义等资料）

传统奈奎斯特采样，底大一级压死人。通过增加时空采样率的方式，提升采样精度。但是这样成本太高，提升采样率的边际收益很低。

对于稀疏的、长度为n的原始信号x[n]，可以事先指定一组信号作为采样信号（探针），这组采样信号构成一个矩阵phi[m*n]（m远小于n），称为采样矩阵。对稀疏信号采样时，使用采样信号与原始信号做内积，得到一个采样值，而采样频率可以远小于原始信号的奈奎斯特频率，得到一组较少的采样y[m] = phi x。

通过这种方式得到的采样值，与原始信号和采样矩阵之间构成了一个欠定方程，一般情况下无法通过采样点恢复出原始的稀疏信号。但是只要满足一些条件，就可以利用某种优化算法去求解这个方程，即在欠定方程的所有可能的解中，寻找最稀疏的解作为恢复出的原始信号。

但是，如果选择稀疏性（0范数）作为优化目标，会使得问题变成NP难问题。选择p范数（0\<p\<1）也有类似的困难。但是，在某些条件下，对0范数的优化可以等价为对1范数的优化，这就使得问题转化为相对简单的线性规划问题。至于为什么不用2范数，可通过图形作粗略说明。

有许多物理信号往往并非稀疏，但是在某个变换域上是稀疏的。如果记输入信号为x，变换矩阵为psi，那么变换域上的稀疏信号为s = psi x。如果对变换域稀疏信号应用上面所说的采样，就得到y = phi s = phi psi x。

记观测矩阵A = phi psi，如果A也满足采样矩阵的某些条件，那么就可以按照上面的论述，通过最优化算法从输出的采样值y估计出输入x。

那么以上方法对于原始信号和观测矩阵都有哪些限定条件？

① 原始信号在某个正交基上是稀疏的（待续）

------

2021-07-17：支持向量机应该是传统二分类算法的极致了。最妙的是核方法和软间隔两个核心思想。重要的是这两者都有坚实的数学基础和能行的算法。这就是理论和实践完美结合的艺术品。压缩感知也算一个艺术品，思想巧妙，理论坚实，计算可行，可惜目前不太实用。

# 拉普拉斯变换

复指数信号$\mathrm{e}^{st}$（$s \in \mathbb{C}$）是我们的好朋友，因为LTI系统对复指数信号的响应也是复指数信号，只不过是被加权了。也就是说，复指数信号是LTI系统的特征函数，而加权权重是系统的特征值。数学推导如下：

设LTI系统的单位冲激响应是$h(t)$，则其对输入信号$x(t) = \mathrm{e}^{st}$的响应

$$ \begin{align}
y(t) &= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot x(t - \tau)} \mathrm{d} \tau \\\\
&= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{s(t - \tau)}} \mathrm{d} \tau \\\\
&= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{st} \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau \\\\
&= \mathrm{e}^{st} \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau \\\\
\end{align}
$$

如果右边的无穷限积分收敛，则可以写成某个关于s的变量$H(s) = \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau$。这样，系统对复指数信号的响应就可以写成

$$ y(t) = H(s) \cdot \mathrm{e}^{st} $$

意味着，复指数信号就是LTI系统的特征信号。对于离散信号和离散系统也如此。

------

考虑到LTI系统的线性和时不变性，如果LTI系统的输入信号可以被分解成复指数信号的线性组合（正交分解），那么LTI系统对于输入信号的响应，就等于LTI系统对于每个复指数信号的响应的线性组合。

关于信号的正交分解，如果选用三角正交函数族$\{ \mathrm{e} ^{j \omega} \}$，那么这就是傅里叶变换。当然，傅里叶变换是有条件的，也就是Dirichlet条件。如果选用一般的复指数信号作为基底，对信号做正交分解，这就是拉普拉斯变换：

$$ X(s) = \int _{- \infty} ^{+\infty} x(t) \mathrm{e} ^{-st} \mathrm{d} t $$

从形式上看，这就是复指数信号通过LTI系统之后，系统为输入信号所施加的权重（特征值）。

单边拉普拉斯变换：

$$ X(s) = \int _{0^-} ^{+\infty} x(t) \mathrm{e} ^{-st} \mathrm{d} t $$

![引自[www.dspguide.com](http://www.dspguide.com/CH32.PDF)](./image/G3/laplace-transform.png)

常用拉普拉斯变换表：以下处理的均为单边信号、单边拉氏变换，收敛区略。

|$f(t)$|$F(s)$|
|------------------|
|$\delta^{(n)}(t)$|$s^n$|
|$\delta(t)$|$1$|
|$\epsilon(t)$|$\frac{1}{s}$|
|$t \epsilon(t)$|$\frac{1}{s^2}$|
|$\frac{t^n}{n!} \epsilon(t)$|$\frac{1}{s^{n+1}}$|
|$𝐞^{at} \epsilon(t)$|$\frac{1}{s - a}$|
|$t𝐞^{at} \epsilon(t)$|$\frac{1}{(s - a)^2}$|
|$\frac{t^n}{n!} 𝐞^{at} \epsilon(t)$|$\frac{1}{(s - a)^{n+1}}$|
|$\sin (\omega t) \epsilon(t)$|$\frac{\omega}{s^2 + \omega^2}$|
|$\cos (\omega t) \epsilon(t)$|$\frac{s}{s^2 + \omega^2}$|
|$\sinh (\beta t) \epsilon(t)$|$\frac{\beta}{s^2 - \beta^2}$|
|$\cosh (\beta t) \epsilon(t)$|$\frac{s}{s^2 - \beta^2}$|
|$𝐞^{at} \sin (\omega t) \epsilon(t)$|$\frac{\omega}{(s - a)^2 + \omega^2}$|
|$𝐞^{at} \cos (\omega t) \epsilon(t)$|$\frac{s - a}{(s - a)^2 + \omega^2}$|
|$2A 𝐞^{at} \cos(\omega t + \phi)$|$\frac{A 𝐞^{𝓳 \phi}}{s - a - 𝓳 \omega} + \frac{A 𝐞^{-𝓳 \phi}}{s - a + 𝓳 \omega}$|

拉普拉斯逆变换：

- 部分分式展开法
- 留数法

拉氏变换的性质：

- 线性
- 时移
- 频移
- 尺度
- 微分（时域、频域、对参）
- 积分（时域、频域、对参）
- 卷积定理（时域、频域）
- 初值定理
- 终值定理

# z变换

# 信号与系统分析

小波分析

拉东变换

**基于高阶统计量的信号检测方法（2021-05-20）**

- 高斯（有色）噪声的高阶（大于2阶）累积量恒为0，可以提取混杂在高斯噪声中的非高斯信号，并且可以用来度量信号的“非高斯性”。
- 高阶累积量含有相位信息。
- 高阶累积量可以刻画系统的非线性性质。
- 高阶统计量可以作为深度神经网络的输入特征，用来解决频谱感知问题，如信号调制方式分类等。

参考资料：吴嗣亮. 高阶统计量信号处理方法.（本地存档有）

# 数字滤波器

2022-03-06：数字滤波器作为920的最后一个考点，无疑是不简单的。但是它实现起来又是那么简单，落实到代码上，只是一堆简单的加减乘除而已。这就有点像复杂度理论中的现象：验证一个答案是简单的，而得到一个答案是困难的。

## 概述

描述LTI数字滤波器的四种等价方式：差分方程、单位冲激响应、z域传递函数、频率响应。频率响应是TF在单位圆上的取值，是IR的傅里叶变换。

分类方式：

- 按IR分类：FIR、IIR
- 按FR分类：低通、高通、带通、带阻、全通
- 按结构分类：递归滤波器、非递归滤波器。IIR通常是递归的。FIR未必是非递归的。

性能参数：很多性能参数是鱼与熊掌不可兼得的关系。

- 频域参数：截止频率、过渡带宽、通带纹波、阻带衰减…
- 时域参数：主要看单位阶跃响应（边缘）
- 其他：相位特性（是否线性相位）、阶数、结构、稳定性、是否对有限字长效应敏感等

滤波器选型：

- 从传函结构来看，IIR因存在反馈结构，容易受有限字长效应影响，例如如果IIR的极点位于单位圆附近，量化误差容易使极点跑到单位圆外面，引起寄生振荡而不稳定。
- 从IR来看，FIR可以通过卷积计算，而卷积可以通过FFT加速。
- 从成本和复杂度来看，同样的频率选择性，IIR的阶数比FIR要低5~10倍，因此成本也较低。
- 从相位特性来看，FIR可以实现严格的线性相位特性，IIR不行。
- 从设计来看，IIR可以从模拟滤波器出发，用现成的公式或者查表转换得到；而FIR的设计方法多而复杂，性能参数往往没有公式可以算。
- 从功能来看，IIR只适合设计具有片段常数特性的滤波器，如BPF等；FIR花样很多，如微分（差分）器、希尔伯特变换等。
- 总而言之，IIR在实现较高的频率选择性方面有优势，而FIR在保持线性相位上有优势。

滤波器实现结构：

- 基本运算就3种：加法、乘法、延时
- 有理分式形式的TF，可以因式分解，可以部分分式展开，对应不同的结构和计算复杂度（参见[秦九韶算法](https://zh.wikipedia.org/zh-cn/%E7%A7%A6%E4%B9%9D%E9%9F%B6%E7%AE%97%E6%B3%95)）。

从低通滤波器出发…高通 = 全通 - 低通，带通和带阻可以从低通和高通组合而得到。

![引自[www.dspguide.com](http://www.dspguide.com/CH14.PDF)](./image/G3/hpf-bpf-brf.png)

## 无限冲激响应（IIR）滤波器

## 有限冲激响应（FIR）滤波器

FIR滤波器的单位冲激响应是有限长的，其长度（点数）记为N，则其阶数为(N-1)，因为N点FIR滤波器有(N-1)个零点。其传递函数是单位冲激响应$h(n)$的z变换：

$$ H(z) = \sum _{n = 0} ^{N-1} h(n) z^{-n} = h[0] + h[1]z^{-1} + ... + h[N-1]z^{-(N-1)} $$

这实际上描述了一个差分方程的形式。是全零点系统。

<iframe class="MikumarkIframe" src="./html/digital-filter.html" height="600px"></iframe>

```
% Octave

N = 1024;
t = -N/2 : 1 : N/2-1;
a = 0.4;
x = a .* sinc(t .* a);
hamming = 0.54 - 0.46 .* cos(2 * pi * (t - N/2) / N);
lpf = x .* hamming;

%高通 = 全通 - 低通
hpf = lpf .* (-1);
hpf(N/2 + 1) = hpf(N/2 + 1) + 1;

kernel = hpf; %或者hpf

X = fftshift(20 * log10(abs(fft(kernel))));

plot(t ./ N, X, "-");
axis([-0.5, 0.5]);
xlabel("归一化频率");
ylabel("幅度(dB)");
grid on;
```

线性相位特性：滤波器频率响应可以分解为幅度相应和相位响应两部分，所谓线性相位特性指的是相位响应为线性函数。而滤波器的群延时是相位关于频率的导数，因此线性相位特性意味着系统对于所有频率具有相同的群延时。

**FIR滤波器具有线性相位特性，等价于其单位冲激响应具有对称性。**如何理解？根据DFT的时延性质，IR的每个点，都对应一个延迟效果，这反映出IR与差分方程的等价性。从物理直观的角度来看，IR关于某个点对称，意味着IR上每两个对称点所造成的平均延迟，都等于对称中心带来的延迟，总起来看，也就是所有频率上都有相同的群延时。至于IR对称和线性相位两者之间的充要条件，在数学上也容易验证。

线性相位FIR滤波器有4种，每一种都有各自的适用场景和局限性。

## 滑动平均滤波器

其冲激响应h[n]是矩形脉冲，频域响应是sinc。时域上奇数个点，单边或双边（单边会造成相移；线性相位必须双边对称）。Pros：时域边沿陡峭；线性相位（好的平滑滤波器）；滑动平均滤波器用递归实现极其高效（最快的数字滤波器），可通过定点或者整数运算实现。Cons：频域滚降慢；阻带衰減小（差的低通滤波器）。

级联的滑动平均滤波器：矩形窗自卷积+三角窗+...+高斯窗（中心极限定理）高斯窗的时域和频域是同样形状的。（[视频解说](https://www.bilibili.com/video/BV1Yk4y1K7Az/)）

## 窗函数法设计FIR滤波器

理想低通滤波器是矩形窗口，但是其冲激响应sinc函数无限长，物理上不可实现。若强行用矩形窗简单截断冲激响应，在频域上会引发吉布斯效应，劣化纹波、滚降、阻带衰减指标。因此需要为sinc内核加合适的窗，使其频率响应的边缘缓慢过渡。

两个基本参数：归—化截止频率fc∈(0，0.5)和IR点数M。IR点数越长，滚降越快（归一化过渡带宽越窄）：TBW=4/M

## 希尔伯特变换

**实信号**的傅里叶变换具有共轭对称性，又叫Hermitian（厄米特/埃尔米特）对称性，即$F(-x) = F^*(x)$（星号代表共轭，F(x)是复值函数）。反之，共轭对称复信号的傅里叶变换是实信号。

这意味着，**实信号的傅里叶变换（下面姑且称为频谱）是双边带的**，并且其实部是偶对称、虚部是奇对称，进而幅度是偶对称、相位是奇对称。两个边带对称，意味着有一个边带是冗余的，浪费了一倍的带宽。

如果想只保留单边频谱，那么原来的信号就不会是实信号。为了从原来的实信号构造出单边带信号，需要引入希尔伯特变换。

希尔伯特变换，实际上是一种全通滤波器，它的物理意义是为信号施加90°相移。其单位冲激响应记为$h_h(t)$，频率响应为

$$ H_h(\omega) = -j \cdot \mathrm{sgn}(\omega) $$

有了希尔伯特变换，就可以引入**解析信号**的概念。实信号$x(t)$的解析信号$x_a(t)$是一个复信号，其实部是原来的实信号$x(t)$，虚部是$x(t)$的希尔伯特变换$x_h(t) = x(t) * h_h(t)$：

$$ x_a(t) = x(t) + j \cdot x_h(t) $$

解析信号$x_a(t)$的傅里叶变换$X_a(\omega) = X(\omega) + j \cdot X_h(\omega)$，而$X_h(\omega) = X(\omega) \cdot H_h(\omega) = -j \cdot X(\omega) \cdot \mathrm{sgn}(\omega)$，所以$X_a(\omega) = (1 + \mathrm{sgn}(\omega)) \cdot X(\omega)$，即当ω大于0时，$X_a(\omega) = 2 X(\omega)$；ω小于等于0时，$X_a(\omega) = 0$。这是一个单边带频谱。

因此，解析信号$x_a(t)$是单边带信号。直观上来看，对实信号构造解析信号，相当于把实信号频谱的负频率部分（下边带）翻转并叠加到正频率部分，因此是能量守恒的。

为了将单边带的解析信号恢复为双边带的实信号，直接取其实部即可，即

$$ x(t) = \mathrm{Re} \{ x_a(t) \} $$

在实信号和解析信号的互相转换的过程中，没有发生任何信息和能量的损失，其根本原因可能就是某种数学结构内在的共轭对称性。

希尔伯特变换是相移法单边带调制的核心，详见单边带调制的章节。

TODO 希尔伯特变换FIR滤波器的设计实现

# 多采样率数字信号处理

# 数字逻辑系统

## 数值编码

## 组合逻辑

## 时序逻辑

## 74系列逻辑电路

# 模数数模转换器

- [ADC的理论信噪比公式](https://www.analog.com/media/cn/training-seminars/tutorials/mt-001_cn.pdf)

## Δ-Σ调制

# 随机过程

[Box–Muller transform](https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform) is a random number sampling method for generating pairs of independent, standard, normally distributed (zero expectation, unit variance) random numbers, given a source of uniformly distributed random numbers.

# 信息论

# 信道

# 调制

## 模拟连续波调制

**线性调制（调频）**

在通信系统中，信源所产生的基带信号，往往是实信号。为了节约频谱，通过希尔伯特变换（相移网络/数字滤波器）将其变换为解析信号，得到复基带信号，再将其调制到复载波$\mathrm{e}^{j \omega_c t}$上，得到复通带信号。然而发射出去的只能是实信号，因此将复通带信号取实部发射出去，没有损失任何信息。尽管实的通带信号又变成了双边带信号，但是在载波频率附近只保留了基带信号的一个边带，实现了节约频谱的目标。

![ ](./image/G3/ssb-modulation.svg)

![SSB相移调制](./image/G3/SSB相移调制.png)

**非线性调制（调角）**

![调频频谱图和瀑布图](./image/G3/fm-spectrum.png)

![贝塞尔函数](./image/G3/bessel.svg)

使用Octave或Matlab绘制：

```
z = 0:0.1:20;
J = zeros(5,201);
for i = 0:4
    J(i+1,:) = besselj(i,z);
end
plot(z,J);
grid on;
legend('J_0','J_1','J_2','J_3','J_4','Location','northeast');
title('Bessel Functions of the First Kind');
xlabel('z');
ylabel('J')
```

## 模拟脉冲调制

**关于阻尼波通信（2021-05-06）**

国内国际的无线电规章，如ITU《无线电规则》3.15条和《中华人民共和国无线电频率划分规定》2.12条规定，一切电台都不得使用**阻尼波**（减幅波）发射。为什么？按照[维基百科](https://en.wikipedia.org/wiki/Damped_wave_\(radio_transmission\))的说法，“阻尼波”在法律上的定义是模糊的，这也就导致我在读到《频率划分规定》2.12条时产生很大的疑问。

不过一般来讲，阻尼波，与CW连续波相对，是按照指数规律减弱的有阻尼电磁波，一般体现为窄脉冲序列。古早的[火花发报机](https://zhuanlan.zhihu.com/p/29598819)，就是利用发射阻尼波工作的。但阻尼波会占用大量并不需要的带宽，干扰临近的业务，因此CW出现后，火花发报机就被淘汰了。其实现在也存在着某种意义上的火花发报机，那就是煤气灶点火器，一种按下按钮后就会发出连续电火花脉冲的小工具。

如何改进CP16、AM32等图形调制的显示效果？诸如CP16，以及我自己改良的“[AM32](./html/am32.html)”这类技巧，实际上是多个频率上的OOK（开关键控），是ASK的一种特殊情况。如果开关的边沿很陡（相当于时域上加矩形窗），那么在频域上就会体现出比较强的旁瓣成分，导致瀑布图很不好看（见下图左侧）。为了抑制旁瓣，在简单OOK的基础上，在时域上加三角窗。由于边沿变缓，旁瓣被削弱，瀑布图效果明显改善（见下图右侧）。

![ ](./image/G3/CW-bandwidth.jpg)

成品CW发报机实际上也不是简单的矩形窗OOK。如[参考资料](https://zhuanlan.zhihu.com/p/30593852)(*)所述：锋利的上升下降沿会在电码侧音起始和结束时耳机中引起难受的咔嗒声，同时较强的旁瓣会给临近频率的电台带来潜在干扰。设计精良的CW发报机，会使用升余弦滤波器等手段作脉冲整形，以最小化无用的发射。

难道阻尼波真的毫无价值吗？在检索阻尼波相关资料时，了解到[超宽带通信](https://zh.wikipedia.org/wiki/%E8%B6%85%E5%AF%AC%E9%A0%BB)（UWB）这一概念。简单来说，就是用时间上极短（纳秒~皮秒级）、但频域带宽极宽（GHz级）的脉冲进行通信。由于发射信号的功率谱密度很低，因此可以与其他采用连续波载波的体制共用频谱，而不互相干扰。在瀑布图上闲逛的时候，偶尔会在V/U段（短波似乎也有？）看到某些占用带宽非常宽，但持续时间很短、强度很弱的信号（2021-08-20补充：有些是AIS、ADS-B）。猜想这也是某种宽带通信或者扩频通信方式。（2023-01-30补充：100kHz上的[Loran-C](https://en.wikipedia.org/wiki/Loran-C)信号就是一种脉冲信号）

翻阅《实用射频技术手册》时，在第11章（p.138）偶然发现超再生发射/接收机也是利用阻尼波进行通信。

## 数字基带调制

## 数字通带调制

## OFDM

主要参考资料：Yong Soo Cho, et al. **MIMO-OFDM无线通信技术及Matlab实现**[M]. 电子工业出版社, 2013.

**无ISI传输的条件（Nyquist准则）**

信道总体脉冲响应，期望在本码元的**抽样时刻**非零，而在其他码元的**抽样时刻**为零。这样就可以消除ISI。因为信道IR在非本码元抽样时刻上的值，起到了时移的效果，造成延迟和拖尾，将能量叠加到其他码元的抽样时刻上，形成了ISI。

无ISI的时域条件是：$g(nT_s) = \delta[n]$，其中g是信道总体IR，$T_s$是码元周期，n是码元序号，$nT_s$即为抽样时刻。

与其等效的频域条件是：信道总体频率响应可以**等效**成理想矩形窗，这里不展开数学推导，但是可以做一个直观解释：将信道频率响应以$1/T_s$为间隔切成小段，平移到$(-1/T_s, 1/T_s)$区间内，叠加起来，得到的结果应当是常数，也就是在主值区间内得到了一个理想矩形窗。进一步理解，考虑到频域延拓等效于时域采样，既然抽样时刻$nT_s$的时域响应都是0，说明频域每隔$1/T_s$延拓出去的部分并没有引入多余的能量。因此极限地看，如果采样间隔→0（延拓周期$1/T_s$→∞），得到了一个连续的$\delta(t)$，那么频域也就没有延拓，频域响应在无穷长的主值周期内是常数，可以看成是一个无限宽的矩形窗。既然延拓出去的部分并未引入新的能量，那么延拓出去的部分实际上就是把这个矩形窗拆解之后延拓出去的。如果再把它们“收回来”，叠加在一起，就会恢复成原来的矩形窗。

这个理想矩形窗的截止频率是**0.5倍的波特率，此为Nyquist带宽**。如果信道相干带宽低于Nyquist带宽，则无法保证无ISI传输。

**单载波高速传输的难点**

高波特率传输，意味着高带宽需求，容易受到多径衰落的影响。另外，波特率增加，均衡器的复杂度也增加。

**从FMT多载波到OFDM**

FMT（滤波多音）为每个子载波使用独立的信号通路（滤波器、振荡器等），子载波频谱之间是没有重叠的。而OFDM基于能量正交的思想，同样是划分为多个子载波，但子载波频谱之间有重叠，它们之间的正交性是积分（内积）意义上的正交性，可以用数学方式复用和解复用，物理上无需也不能用独立的信号通路去处理。

**OFDM子载波正交条件**

下文将OFDM的symbol称为“符号”，而串并转换前经QAM等单载波调制得到的symbol称为“码元”。OFDM最基本的参数有两个：子载波数$N$、OFDM符号周期$T_{sym}$。为了实现子载波正交（在一个符号周期$T_{sym}$内积分），需要满足以下关系：

+ 第k个子载波频率为$f_k = k / T_{sym}$（基波频率$f_1 = 1 / T_{sym}$）
+ 子载波间隔为$\Delta f = 1 / T_{sym}$

第k个子载波的频率是基波频率的k倍，即$f_k = k / T_{sym}$，且所有子载波在一个符号周期$T_{sym}$内是正交的。第一个子载波就是基波，其频率即为OFDM符号速率。频率最高的子载波，其频率就等于串并转换前码元序列的波特率。

其推导过程见《通信原理》（第七版）P243。如何解释？每个子载波可以认为是被QAM/QPSK符号调制（加权）了的ASK信号，其持续时间有限（$T_{sym}$），频谱是频移了的sinc函数，其中心为子载波频率$f_k = k / T_{sym}$，第一零点（也等于零点间隔）为$1/T_{sym}$。因此OFDM符号的频谱就是多个频移sinc函数在频域上的叠加。如果满足子载波正交条件，那么每个子载波的sinc频谱的中心$f_k = k / T_{sym}$，正好落在其余子载波的sinc频谱的零点位置，直观上看是有“正交”的意思在里面的。

![OFDM示意。[来源](https://rfmw.em.keysight.com/wireless/helpfiles/89600B/WebHelp/Subsystems/wlan-ofdm/Content/ofdm_basicprinciplesoverview.htm)](./image/G3/ofdm-f-t.png)

从正交条件还可以导出以下关系：

- 子载波数$N$ = 每个OFDM符号所携带的码元数
- $T_{sym}$ = 基波频率 = 第一个子载波频率 = 子载波间隔
- 码元周期$T_s$ = $T_{sym} / N$

**OFDM调制过程**

把QPSK/QAM码元分组，每组N个码元，将其调制到N个子载波上，然后将子载波叠加起来，就得到了一个OFDM符号。由于各个子载波间正交，因此解调时可以分离。保持正交的前提是，必须精确地在一个完整的符号周期内积分，这就是为什么OFDM对符号同步非常敏感。如果积分起始位置不对，则会破坏正交条件。

- 把串行QPSK/QAM码元分组，每组N个码元（串并转换）。
- 组号为$l$，组内码元编号$k$，则第$l$组的第$k$个码元记为$X_l[k]$，$k \in [0, N-1]$。
- 将组内每个码元$X_l[k]$调制到第k个正交子载波（时间连续）上，将所有N个调制了的正交子载波加起来，就得到一个连续的OFDM符号。
- 对OFDM符号进行采样：以码元速率为采样率（见下文说明），在$t = l \cdot T_{sym} + k \cdot T_s$（记住$T_{sym} = N \cdot T_s$）时刻对OFDM符号采样，得到N个采样点。可以证明，这N个采样点，就是$\{ X_l[k] \} \vert ^{N-1}_{k=0}$的N点IDFT。

> 2023-07-11：OFDM有一个十分微妙的细节：运用IDFT实现OFDM调制的推导过程中，很重要的一点是在串行码元时刻对OFDM符号波形作采样。于是这里就比较令我费解了：根据采样定理，采样频率不应该大于码元频率的两倍才对吗？

> 然而，这里处理的是复信号。

> 通常所说的采样定理，一般针对的是实信号。对实信号作傅里叶变换，所得到的频谱是共轭对称的，也就是实部/幅度偶对称、虚部/相位奇对称，这就是双边带信号。对实信号采样，相当于频域上周期延拓，因而延拓后的一个边带有与另一个边带混叠的可能性。

> 而复信号的频谱未必是共轭对称的。只有一个边带的单边带复信号可以通过提取实部的方式转化为双边带实信号，而（双边带）实信号也可以通过所谓的解析变换变成解析信号，解析信号是单边带的。这也就是说，单边带复信号实际上就是实信号，这就是IQ调制的理论基础。空中传播的无线电信号，是实信号，经过IQ调制之后，变成单边带复信号，信息没有损失，当然，更没有凭空增加。

> 对带限的单边带复信号作采样，其频谱以采样频率周期延拓，但由于只有一个边带，不会与另一侧边带相混叠，所以复信号的采样频率就是不低于信号带宽，而不是两倍带宽。而在工程实现上，这一结论并未给出偷懒的可能性：尽管采样频率可以降低一半，但却要同时对两路信号进行采样，总的代价并未降低，只是时空相互代换罢了。

> 所以，在OFDM的IDFT实现的推导过程中，以码元频率对复数的OFDM波形进行采样，这并未违反采样定律。

表面上看，OFDM没有带来明显的效率提升或者频谱节约，但是它带来了抗衰落、抗码间串扰（把时间上相邻的码元排列到频域上了，符号速率降低了）、降低信道均衡器复杂度、载波自适应等好处。劣势就是多个载波叠加容易产生高PAPR进而降低PA效率、以及对于同步误差相当敏感。OFDM系统很大一部分复杂度就是在处理这两个问题上。

**保护间隔**

为了消除OFDM符号间的ISI，时域上会在符号间插入保护间隔GI。

信道IR的每一点都可以看成是对传输信号的延迟加权。理想的信道应当是单位冲激，不存在延时，但这几乎不可能。信道IR一般都有一定的宽度，这个宽度称为最大时延扩展τ。这意味着，如果OFDM符号连续发射，上一个符号最多会被延迟τ，叠加到下一个符号上，引起ISI，破坏子载波正交性。这就好比在一个有回声的大厅里说话，如果说得太快，上一个字的回声就会淹没下一个字，什么也听不清。一种解决办法就是说完一个字停顿一下，等回声消失后再说下一个字。

OFDM符号之间的这种“停顿”，就是保护间隔。大致有两种，一种是补零，一种是循环前缀CP或者循环后缀CS。补零适合用于UWB等场景，而CP或CS可利用循环卷积性质。

**保护频带**

由于OFDM符号是时限的，其频谱不是带限的，会有比较强的带外成分。为了减小带外成分，一方面可以对OFDM符号加窗，另一方面可以在最外侧子载波上设置虚拟载波。

**频域注水算法**

**同步技术**


------

2022-03-02

今天发现，OFDM的实现，犯了一个根本性的原理上的错误。这个错误可以归结为对多速率信号处理不熟悉。问题简要记录如下：

OFDM是利用多路正交子载波对复序列（每个点这里姑且称为码元）进行调制。当采样速率等于码元速率时，多载波调制在数学上与IDFT一致，因此可以利用IFFT加速这个过程。但是必须注意的是，这种方法的可行性，是来源于采样速率等于码元速率。对于我现在的设计参数来说，码元速率为2.56kHz，因此通过IFFT输出的复序列，实际上等于是采样率为2.56kHz的离散信号。按照多数文献上的说法，此信号将被分为IQ两路，输出到DAC转换成模拟信号，再进行后续的射频处理。

然而！在浏览器中处理数字音频信号，其采样率是48kHz，跟OFDM算法直接生成的2.56kHz采样率并不一致。这也就是说，需要对OFDM算法生成的序列进行上采样，将其变换到音频信号处理所需的48kHz采样率上，才能在浏览器中生成合适的时域音频信号。于是问题被归约为实现数字上采样。上采样的算法是信号处理领域的基本算法，其过程分为内插和滤波两个步骤。内插就是在低采样率序列中补0，然而这样会在奈奎斯特带宽内引入额外的镜像成分，因此还需要用低通滤波器将所需的基带信号过滤出来。但是，数字低通滤波器对我来说是个尚未掌握的领域，我目前还不具备自行设计FIR滤波器的技能。于是这个问题暂且保持开放，先将现有实现中错误引入的IFFT/FFT去掉。

为了换换脑子，开始读那本《RRU设计原理与实现》，却震惊地发现我刚刚遇到的问题全写在这本书里了…所以说这种闭环的感觉是很奇妙的。另外孙宇彤先生写的那本书，虽然事情是对的，但总觉得像 The Little Schemer 的风格，他会把事情描述清楚，却不告诉你那“是”什么。这样就很难按图索骥地学习。还是要给事情一个名分才行。

------

2022-02-18：信源编码，尤其是音视频编码，往往是编码器的复杂度远高于解码器；但是最近在研究OFDM，发现解码器（解调器）的复杂度要高于编码器（调制器）。原因似乎是因为解调器需要处理无线信道对信号引入的各种失真和噪声，而信源编码层面不需要处理这个问题。

------

2022-02-11

说到通信中的时间同步问题，一般的串行总线协议总是要有一条时钟线（如I2C），或者在协议层面约定同步字和传输速率（如UART）。读取DNA上的遗传信息也是类似，因为密码子是3个碱基一组，所以有3种起始读法。像HIV这类病毒可以实现三种读法都有意义。

对于OFDM，每个符号就是时域上的一个“波包”，由于符号间干扰等因素，接收端并不能单纯通过接收到的时域波形找到波包的起点，也就无法恢复出发射的符号。那么于是就发展出很多巧妙的时间同步技术，这有待深入调研。移动通信系统中，多使用GNSS提供绝对的一致的时钟基准。移动通信系统OFDM符号长度在十几毫秒量级，这个粒度比GNSS的不确定度大得多。

# 编码

## 信源编码

## 信道编码

**Reed-Solomon编码**

2022-02-12：交织的目的是将较长的差错打散为离散的随机差错，有利于纠错。为了克服无线信道衰落的影响，DRM引入了交织。而CD为了克服划痕影响，采用交叉交织的里德-所罗门编码。因此清洁CD光盘提倡径向擦拭。通俗地讲，交织是避免“一死死一片”，如同某些公司不允许多人乘坐同一架飞机。

# 解调与估计

## 数字信号的最优接收

## 匹配滤波

# 扩频

# 同步

## 载波同步

## 码元同步

## 群同步

## 网络同步

# 多址与复用

# 电子对抗与认知无线电

[蓝剑-B](https://zh.wikipedia.org/zh-hans/%E2%80%9C%E8%93%9D%E5%89%91-B%E2%80%9D%E8%AE%A1%E5%88%92)

## 关于“扫描”功能的猜想（2021-05-20）

突然意识到，接收机的扫描功能其实也属于认知无线电，只不过是认知无线电中的一小部分——频谱感知的一部分。单纯的扫描功能没有形成认知无线电的闭环，但它是基础。

没有调查研究过，但我理解（猜想）的扫描，大概有这样几个要点：

- 搜索策略方面。对于窄带接收机，可以简单遍历频段内每个可能的频点，或者依据某种先验知识（如中波广播频道宽度9kHz）缩小搜索空间。对于宽带接收机，尤其是SDR接收机，一方面可否充分利用硬件并行化能力将宽带扫描问题转化为多个子带并行扫描的问题，另一方面是否可以引入压缩感知、深度学习等手段，以“归一化”信道、接收机在不同子带上的不同参数。
- 信号检测方面。对于已知信号（如广播、模拟和数字对讲、CW等），可以引入大量先验知识，人为构造特征（模式）进行匹配。对于未知信号，至少可以通过能量、高阶统计量等通用特征，把感兴趣的信号从底噪中区分出来。

# 前沿技术展望

**信息通信的目标和愿景**

- 多·宽容泛在：大容量、全模态、全场景、全时空无缝衔接
- 快·又快又稳：高速率、高实时、低时延、稳定低抖动
- 好·优质靠谱：高质量、高精度、高安全可靠可信、高度智能化语义化
- 省·省电廉价：高效率、低成本、自运维自迭代、综合费效比高

**基本矛盾**

**方向·范式·方法论**

战略方向：感知通信计算一体化

- 应用层：交互智能，如NLP、搜索引擎、图像语音、VR/AR；应用智能，如推荐系统、专家系统（智能决策）、智能控制等。
- 表示/会话层：智能信源编码（协议）如音视频、语义网；智能安全如加密、内容识别、风险控制、访问控制。
- 传输/网络层：智能交换如路由寻径、内容分发、负载均衡、任务调度；网络状态感知分析预测、自组织自诊断自恢复自优化。
- DL/物理层：纠错、信道状态感知预测、信道资源控制管理、分集和复用（多天线）、信道编码、端到端TCVR、介质特定算法（光、量子、轨道角动量、智能超表面、毫米波太赫兹等等）。

工程基础：软件定义万物vs介质创新，软硬双向深挖

- 频谱挖潜：太赫兹、可见光…
- 全息挖潜：相位、轨道角动量…
- 材料挖潜：超材料、MEMS、光器件、量子器件

两种范式：

- 数据驱动范式：启发式的、学习式的、归纳式的
- 第一性原理范式：理性的、演绎式的

**通信革命**

语义通信

智能收发信机：

- 基于MLP的QAM解调器
- OFDM接收机：完全数据驱动 vs 数据模型双驱动
- CSI压缩
- 智能序列检测与信道译码

信息超材料：智能超表面、超透镜

认知无线电

智能能源/无线传能

**计算革命**

无线空中计算：通算一体

端到端音视频编码

**架构革命**

- 异构计算、存算融合
- 虚拟化和云化、云网融合
- 云边端协同、算力网络、东数西算
- 计算智能：复杂系统模拟、优化、动力学预测
- AIOps：复杂系统自运维

**赛博安全**

AI for Sec / Sec for AI

**感知/采集革命**

压缩感知：通感一体

全息采集/呈现→元宇宙

成像新技术

**总结与启示**

- 人工智能不完全是“人类智能”。模拟人类的感官、行为、思维，并非人工智能的唯一的任务。
- 人工智能另一方面的重要任务，应当是把人类的知识、经验输入到信息系统里面去，使其与人类协作共生、协同进化。
- 深度学习有潜力应用于一切领域，但它可能并非银弹。
- 与其寻找AI可以与哪些领域相结合，不如寻找还有哪些领域还没有与AI结合。
- 管理预期和深挖需求同等重要。AI等技术只是锤子，而问题在于钉钉子，要明确问题域和方案域。但也必须知道锤子还可以砸核桃。
- 感知、通信、计算、存储、控制，合久必分，分久必合。CI和IT融合，云网融合，信息通信和具体业务融合。
- 有些旧技术、旧理念由于**过于超前**而成为旧东西。旧东西不等于没有潜力，神经网络当年也是旧技术。
- 要注意挖掘传统算法中蕴含的精妙思想，螺蛳壳里做道场的手艺不能丢。当年算力不够技巧来凑，现在不能有了算力就不管技巧了。大力出奇迹和极致优化都是需要的。由奢入俭难。
- 数据驱动范式（开普勒、第谷）和第一性原理范式（牛顿）需要融合。
- 信息论是包括神经网络在内的所有信息系统所遵循的共同底层规律，要注意此类原则性的、尤其是限制性的底层规律。它可以指导优化方向和优化目标，防止研究者提出不切实际的目标，比如数学基础的逻辑主义探索史。
- 要重视成本收益原则。要在多快好省之间权衡。科学追求极致，但工程必须权衡。比特决定瓦特，要竭尽全力提升效率，竭尽全力提升每焦耳的比特数、每赫兹带宽的速率数。
