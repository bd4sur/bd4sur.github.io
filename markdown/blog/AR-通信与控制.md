#!title:    通信与控制

#!content

References

- 奥本海姆 等. 信号与系统（第二版）[M]. 刘树棠, 译. 电子工业出版社.
- 奥本海姆 等. 信号、系统及推理[M]. 机械工业出版社, 2017.
- S W Smith. [实用数字信号处理：从原理到应用](http://www.dspguide.com/)[M]. 人民邮电出版社, 2010.
- Simon Haykin. Communication Systems (4th Edition) [M]. Wiley, 2001.
- 樊昌信, 曹丽娜. 通信原理（第七版）[M]. 国防工业出版社.
- 江志红. 深入浅出数字信号处理[M]. 北京航空航天大学出版社, 2012.

![ ](./image/G3/gate-spectrum.png)

# 信号与系统基础

## 信号的简单变换

已知信号f(t)的时域波形，如何绘制f(at+b)的波形：

- 将f(at+b)改写为$f(a(t + \frac{b}{a}))$
- **先反转**
-- 如果a\<0，则将f(t)的波形关于y轴翻转。
- **再缩放**（尺度变换）
-- 如果$0 < |a| < 1$，则将上一步得到的波形拉伸$1/|a|$倍。
-- 如果$|a| > 1$，则将上一步得到的波形压缩$|a|$倍。
- **最后平移**（时延）
-- 如果$b/a > 0$，则将上一步得到的波形左移$|b/a|$单位。
-- 如果$b/a < 0$，则将上一步得到的波形右移$|b/a|$单位。

## 信号的分类

**周期信号的判断**

如果含有n个不同频率余弦分量的复合信号，是一个周期为T的周期信号，则其周期必为各分量周期的公倍数。只要能够将各分量的角频率表示为整数的比，即可判定该信号为周期信号。如果各分量的角频率之比为$\omega_1 : \omega_2 : … : \omega_n = m_1 : m_2 : … : m_n$，则周期T为

$$ T = m_i T_i = m_i \frac{2 \pi}{\omega_i}$$

如果某两个分量的比值为无理数，则合成信号为**概周期信号**，不是周期信号。

**能量信号与功率信号**

定义连续信号x(t)在所有时间上的能量E和平均功率P：

$$ E = \lim_{T→ \infty}{ \int_{-T}^{T} { x^2(t) \mathrm d t } } $$

$$ P = \lim_{T→ \infty}{ \frac{1}{2T} \int_{-T}^{T} { x^2(t) \mathrm d t } } $$

- **能量信号**：信号能量E为非零的有限值。
- **功率信号**：信号平均功率P为非零的有限值。
- 非能量信号且非功率信号。
- 不可能同时是能量信号和功率信号。（能量信号在无限长时间内的平均功率为0）
- 周期信号是功率信号；单位冲激是能量信号。
- 非周期信号未必是能量（有限）信号。反例：单位阶跃。
- 能量信号必为非周期信号。

## 重要信号

**复指数信号**

连续复指数信号是周期信号：

$$ x(t) = \mathrm{e} ^{ \mathrm{j} \omega_0 t} $$

其基波频率为$ \omega_0$，周期为$2\pi / \omega_0$。

离散情况下，复指数信号具有以下两个重要性质（参见奥本海默教材§1.3.3）：

+ 离散复指数信号未必是周期信号。只有当$\omega_0 / 2 \pi$为有理数时，离散复指数信号才是周期信号。
+ 两个角频率相差$2 \pi$的离散复指数信号完全相同。因而处理离散复指数信号集合的时候，只需要考虑角频率范围$[\omega, \omega + 2 \pi)$的区间就足够了。

**单位冲激信号**

单位冲激信号$ \delta (t)$，①其值仅在0时刻为非0（不关心具体是什么），其余时刻均为0，且②总能量为1，即

$$ \int _{- \infty} ^{ + \infty} \delta (t) \mathrm{d}t = 1$$

以上两点即构成单位冲激信号的完整定义。它的主要性质有：

- 筛选性质：$ x(t) \delta (t - k) = x(k) \delta (t - k)$
- 采样性质：$ \int  _{- \infty} ^{ + \infty} x(t) \delta (t-k) dt = x(k)$
- 坐标变换：$ \delta (at) = \frac{1}{|a|} \delta (t)$

其一阶导数是一对冲激，称为“冲激偶”。

# 线性时不变系统

线性系统，指的是满足叠加性质的系统。即，如果输入信号是若干个基本信号的线性组合，将其输入线性系统后的输出，等于这些基本信号分别输入该线性系统后得到的输出信号的线性组合。记基本信号为$s_1$和$s_2$，线性系统对输入信号s的响应为$T(s)$，则线性系统满足：

$$ T(as_1 + bs_2) = aT(s_1) + bT(s2) $$

时不变系统，指满足$ T(s(t)) = T(s(t-t_0))$的系统，这意味着时不变系统对于时移信号的响应与输入信号的时移是一致的，进一步地说，时不变系统本身是不随时间变化的。作为对比，时间压缩系统$y(t) = x(2t)$是一个典型的时变系统，因为它压缩了时间的尺度，使得该系统对时移信号的响应信号的时移，仅有输入信号的一半。

线性和时不变性是两个独立的性质。同时具有线性和时不变性质的系统，称为**线性时不变（Linear Time-Invariant，LTI）系统**。

## 离散信号的脉冲表示

首先考虑一个问题：如何使用一组不同时移的单位脉冲序列的线性组合，来表示任意的离散信号（序列）x[n]。

这个问题在直观上很容易理解：离散序列的每个点，都是移位并加权了的单位脉冲序列（在移位位置上的值）。那么显然，将所有这些移位加权的序列加总起来，就得到了原始的离散序列。根据单位脉冲序列的性质也可以知道：

$$ x[n] = \sum _{k = - \infty} ^{ + \infty} x[k] \delta [n - k]$$

这与直观理解是一致的，即离散序列可以视为k移位加权的单位脉冲序列的加总，权重即为序列在相应移位位置k上的值x[k]。

## LTI系统对离散序列的响应

**① 考虑线性系统对离散序列的响应。**

由于离散序列可以表示为一组不同时移的单位脉冲的线性组合，所以线性系统对离散序列的响应，就等于线性系统对于每个时移单位脉冲的响应的线性组合。

记线性系统对时移单位脉冲的响应为$h_k[n]$，其中k为时移量。线性系统未必是时不变的，因此$h_k[n]$可能与k有关。

因此，线性系统对于离散序列$x[n]$的响应$y[n]$就是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h_k[n] $$

**② 如果线性系统也是时不变系统呢？**

既然是时不变系统，那么$h_k[n]$就等于$h_0[n - k]$，其中$h_0[n]$就是这个线性时不变系统对于（无时移）单位脉冲序列的响应，称为系统的**单位脉冲响应**。简单起见，将$h_0[n]$直接写成$h[n]$，这样的话，线性时不变系统对于离散序列的响应，就可以写成是

$$ y[n] = \sum _{k = - \infty} ^{ + \infty} x[k] h[n - k] \tag{3-1}$$

上式（3-1）定义为x[n]与h[n]的**卷积**（和）运算，记为

$$ y[n] = x[n] * h[n] $$

于是可以说：**LTI系统对于离散序列的响应，等于输入序列与系统单位脉冲响应的卷积。**

## 连续信号的冲激表示

这一节要解决的问题与3.1节的问题是类似的：如何用一组不同时移的单位冲激信号的线性组合，来表示任意的连续信号x(t)。

直观上的理解与离散序列的情况是类似的，不同的是需要使用极短间隔Δ→0的极限去代替离散序列的加总。这种情况下，加总就变成了积分，但思想是一致的。根据单位冲激函数的性质可知

$$ x(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) \delta (t - \tau) \mathrm{d} \tau $$

与离散情况类似，连续信号可以表示为加权的单位冲激函数在所有位移τ上的积分，权重即为原信号在相应位移τ上的值x(τ)。

## LTI系统对连续信号的响应

与3.2节的分析类似，这里不再详细讨论，直接给出结论。

设h(t)为LTI系统的**单位冲激响应**，则LTI系统对连续信号x(t)的响应y(t)为

$$ y(t) = \int  _{- \infty} ^{ + \infty} x( \tau ) h (t - \tau) \mathrm{d} \tau  \tag{3-2}$$

式（3-2）定义为x(t)与h(t)的**卷积**（积分）运算，记为

$$ y(t) = x(t) * h(t) $$

因此可以说，**LTI系统对于连续信号的响应，等于输入信号与系统单位冲激响应的卷积。**

## 叠加积分和卷积

**如何理解卷积？**

卷积可以看作是滑动平均的推广。在卷积的表达式(3-1)(3-2)中，将积分变量$k$（或$\tau$）视为绝对时间，而将$n$（或$t$）视为位移量，则，卷积所得到的结果，实际上是关于位移量的函数。

为了便于理解，考虑一个时限函数（如矩形窗等）与另一个函数做卷积的场景。在这里，将时限函数视为作滑动平均操作时所使用的**滑动窗口**，其函数值即为窗口内每点的权重。考虑到反褶的函数$g(t-\tau)$含有位移变量$t$，因此可将其视为滑动窗口，其中位移变量$t$即为滑动窗口的位移量。

窗口函数$g(\tau)$一般应当有比较好的性质，例如明显的对称性、起始点等，这样有利于画出它的反褶$g(-\tau)$，也便于确定“锚点”。在反褶窗口的基础上，选定原点为反褶窗口的“锚点”，将其以锚点为中心平移$t$个单位，得到位移后的滑动窗口$g(-(\tau-t))=g(t-\tau)$。注意，这里的平移应当是算术平移，即：当t为正数时，则将反褶窗口的锚点从原点向右移动到t点处；当t为负数时，则将反褶窗口的锚点从原点向左移动到t点（位于负半轴）处。

当位移量$t$确定后，即可将滑动窗口$g(t-\tau)$与$f(\tau)$相乘，得到乘积函数。相乘的方法是相同位置（$\tau$的取值）上的函数值相乘。对这个乘积函数作积分，积分限为负无穷到正无穷，得到一个积分值。这个积分值，即为$(f*g)(t)$的值。将其绘制到以$t$为横轴的图像上，逐点描点连线，即可得$(f*g)$的图像。

对于这个积分过程需要说明的是，由于滑动窗口往往是时限的，因而它只在$t$附近的一段区间内为非0，除此之外均为0。因而这个滑动窗口与$f(\tau)$相乘的结果，就是只保留了$f(\tau)$与滑动窗口重叠部分的值，并以$g(t-\tau)$的值作为权重，对$f(\tau)$加了权。而$f(\tau)$位于窗口以外的部分，则因乘以0而被“屏蔽”。因此，积分的上下限，事实上就是滑动窗口的范围。

当然，卷积作为一种运算，并不会对参与运算的信号提出时限或者如何的要求。只不过站在做题的角度，一般都会使用时限的窗口来出题。最典型的就是两个矩形窗口作卷积。

**卷积的性质及其证明**

**卷积交换律**

$$ f(t) * g(t) = g(t) * f(t) $$

交换律很容易证明，从定义式出发，简单换元即可。

**卷积分配律**

$$ f * ( g_1 * g_2 ) = f * g_1 + f * g_2 $$

证明：

$$ \begin{align}
&f * (g_1 * g_2) = \\\\
&= \int _{-\infty} ^{\infty} f(\tau) (g_1(t - \tau) + g_2(t - \tau)) \mathrm{d} \tau \\\\
&= \int _{-\infty} ^{\infty} f(\tau) g_1(t - \tau) \mathrm{d} \tau + \int _{-\infty} ^{\infty} f(\tau) g_2(t - \tau) \mathrm{d} \tau \\\\
&= f * g_1 + f * g_2
\end{align} $$

**卷积结合律**

![ ](./image/G3/SS-1-卷积结合律.png)

**卷积的微分**

$$ \begin{align}
&\frac{\mathrm{d}}{\mathrm{d} t} (f(t) * g(t)) \\\\
&= \left( \frac{\mathrm{d}}{\mathrm{d} t} f(t) \right) * g(t) \\\\
&= f(t) * \left( \frac{\mathrm{d}}{\mathrm{d} t} g(t) \right)
\end{align} $$

证明：直接把导数算子移进卷积定义式，结合交换律即可证明。

**卷积的积分**

$$ \begin{align}
&\int _{- \infty} ^t (f(\tau) * g(\tau)) \mathrm{d} \tau \\\\
&= f(t) * \int _{- \infty} ^t g(\tau) \mathrm{d} \tau \\\\
&= \int _{- \infty} ^t f(\tau) \mathrm{d} \tau * g(t) \\\\
\end{align} $$

证明方法与微分性质类似，把积分移入定义式即可。

**时移的卷积**

如果$f_1 * f_2 = f$，则：

$$ f_1(t - t1) * f_2(t - t_2) = f(t - t_1 - t_2)$$

证明方法是从卷积定义式出发，换元整理即可。

**常用卷积公式**

$$ f(t) * \delta (t) = f(t) \tag{全通} $$

$$ f(t) * \delta (t - t_0) = f(t - t_0) \tag{时移} $$

$$ f(t) * \delta '(t) = \frac{\mathrm{d}}{\mathrm{d}t} f(t) \tag{微分} $$

$$ f(t) * \epsilon (t) = \int _{-\infty} ^t f(\tau) \mathrm{d} \tau \tag{积分} $$

TODO 两个矩形窗卷积

**相关函数**

**互相关函数**$R_{xy}(t)$定义为两个函数$x(\tau)$和$y(\tau)$错位相乘的乘积结果，在所有时间上的积分，关于错位量s(hift)的函数。即

$$ R_{xy}(s) = \int _{- \infty} ^{+ \infty} x(\tau) y(\tau - s) \mathrm{d} \tau $$

这个定义式里面的“错位部分”跟卷积定义式是相反的。二者物理意义截然不同。

**自相关函数**就是某个函数与其自身作互相关。**自相关函数是偶函数**，因为对于同一个函数而言，错位量的正负，仅代表参考者的选取不同，无论往哪个方向错位，结果都仅与错位量的绝对值有关。

直觉上可以看出，周期函数的自相关函数也是周期函数，且在周期的整数倍上取得极值。

# 傅里叶分析

## 信号的正交分解理论

向量内积（点积），可用于描述两个向量之间的“距离”。即，当两个向量同向时，内积取得最大值；当两个向量反向时，内积取得最小值。而当（且仅当）两个向量正交时，内积取0。

如果将向量看成两列数，则两个向量的内积，等于对应维度上的数相乘，然后相加。

现在研究一个问题：现有基准向量$\mathbf U$以及任意向量$\mathbf A$，希望把$\mathbf A$表示成$c \mathbf U$的形式，使得误差的模的平方$|c \mathbf U - \mathbf A|^2$最小化，那么系数c应当如何取值？从几何直观的角度看，只需误差向量$\mathbf A - c \mathbf U$与基准向量$\mathbf U$垂直即可。此时可求出**平方误差最小意义下的**最佳表示系数

$$ c = \frac{\mathbf A \cdot \mathbf U}{\mathbf U \cdot \mathbf U} \tag{4.1.1}$$

这个式子可以这样理解：分子是向量$\mathbf A$在基准向量$\mathbf U$上的投影长度，而分母是基准向量的长度。二者之比即为最佳表示系数。

如果基准向量有两个，则可以通过平行四边形法则，找到两个系数$c_1$和$c_2$，使得$\mathbf A = c_1 \mathbf U_1 + c_2 \mathbf U_2$。可以想象，如果$\mathbf U_1$和$\mathbf U_2$正交，则每个表示系数都仅与对应的基准向量有关，这样每个表示系数都可以运用式(4.1.1)计算。

以上讨论并不严密，仅为建立直观帮助理解，并为后面引入信号在正交基上作合成分解做铺垫。

------

对于复值函数而言，也可以看成是一列复数，只不过这个复数序列是稠密的。因而比照向量内积的概念，可以给出函数内积的概念，用以衡量两个函数的“距离”。复值函数内积定义为：

$$ f \cdot g = \int f(\tau) g^*(\tau) \mathrm d \tau $$

需要注意的是：①由于函数自变量的取值是稠密的，因而求和变成积分；②复信号（向量）内积实际上是所谓的Hermitian（厄米特/埃尔米特）内积。一个复信号与其自身的Hermitian内积，数值上等于其模平方。由于与能量/功率保持相似的量纲和物理含义，故赋予其此种物理解释。至于Hermitian内积为什么要取共轭，这是复向量空间自身的性质所决定。如果不取共轭，则会推出矛盾。

至此可以提出函数（能量）正交的概念：**在某个区间T内**，两个函数f和g的内积为0，即

$$ \int _T f(\tau) g^*(\tau) \mathrm d \tau = 0$$

进而可以给出**正交函数集合**的概念：在某个区间T内，一组函数构成的集合，任意两个不同的函数相互正交，而每个函数与自己的内积都不为0。

仿照上面向量正交分解的问题，可提出函数的正交分解问题。函数的正交分解，目的是将函数$f(t)$表示为一组正交基底函数集合$\{u_n(t)\}$的加权和。那么，仿照上面的讨论过程，可以得出一般的计算第n个基底函数$u_n(t)$上的分解系数$c_n$的公式：

$$ c_n = \frac{u_n \cdot f}{u_n \cdot u_n} = \frac{\int_{T} f(\tau)u_n^*(\tau) \mathrm d \tau}{\int_{T} u_n(\tau)u_n^*(\tau) \mathrm d \tau} $$

这样，如果分解是可行的，则函数$f(t)$被分解为这种形式：

$$ f(t) = \sum_{n}^{所有可行取值} c_n u_n(t) $$

这就是傅里叶级数和傅里叶变换——把信号分解为三角正交基的加权和——的基本模式。

## 连续周期信号的傅里叶级数

傅里叶级数FS的作用对象是**[[#ff0000:连续的周期信号#]]**，因而要时刻牢记周期信号的**周期**$T$（对应**基波频率**$\Omega = 2 \pi / T$），这是本节一切内容所共用的“全局参数”。

<details>

<summary>其他形式</summary>

**形式1：三角正交基**

这是傅里叶最初提出的形式，也是物理意义最显著的形式，但计算较复杂。

$$ x(t) = \frac{a_0}{2} + \sum _{n=1}^{\infty} \left( a_n \cos(n \Omega t) + b_n \sin(n \Omega t) \right) \tag{FS-1}$$

$$ \begin{cases}
a_n = \frac{2}{T} \int _{T} x(t) \cos(n \Omega t) \mathrm d t \\\\
b_n = \frac{2}{T} \int _{T} x(t) \sin(n \Omega t) \mathrm d t
\end{cases} \tag{FS-1A}$$

注意：①在任意整周期内积分结果相同（这是周期函数积分的性质）；②谐波系数前缀的$2/T$。

**形式2：余弦正交基**

考虑到正弦函数与余弦函数本质上是同一函数（仅相位相差90°），因而可以统一使用余弦函数作为正交基。这种情况下，**三角展开式的余/正弦系数$a_n$和$b_n$，就相应地转换成了余弦基的幅度$|A_n|$和相位$\phi_n$。**

$$ x(t) = \frac{a_0}{2} + \sum _{n=1}^{\infty} |A_n| \cos(n \Omega t + \phi_n) \tag{FS-2}$$

其中$|A_n|$（实数）和$\phi_n$与$a_n$和$b_n$的关系是：

$$ \begin{cases}
|A_n| = \sqrt {a_n^2 + b_n^2} \\\\
\phi_n = - \arctan \frac{b_n}{a_n}
\end{cases} \tag{FS-2A}$$

通过欧拉公式将余弦基底拆成复指数形式，并根据$|A_n|$和$\phi_n$关于n的对称性（幅度是偶函数，相位是奇函数），将二者合成为复数系数$A_n$，得到：

$$ x(t) = \frac{1}{2} \sum _{n=- \infty} ^{\infty} A_n \mathrm e ^{\mathrm j n \Omega t} \tag{FS-2.1}$$

**忘掉这个形式吧，只会徒增混乱。**

</details>

**形式3：复指数正交基**

直接使用复指数信号作为正交基底。这种形式在数学上比较简洁，但会引入“负频率”，降低了物理直观性。

$$ x(t) = \sum _{n=- \infty} ^{\infty} c_n \mathrm e ^{\mathrm j n \Omega t} \tag{FS-3}$$

$$ c_n = \frac{1}{T} \int _T x(t) \mathrm e ^{- \mathrm j n \Omega t} \tag{FS-3A}$$

注意：①任意整周期内积分；②谐波系数前缀的$1/T$；③计算谐波系数时，是与复指数的**共轭（指数上带负号）**相乘（同CTFT）。

<details>

<summary>系数的关系</summary>

将(FS-2)与(FS-3)两种形式相比较，可见，二者的区别仅在于是否乘了1/2系数。因而复值谐波系数$A_n$与$c_n$的关系为：

$$ A_n = 2 c_n $$

从应试的角度来看，$A_n$以及$a_n$和$b_n$似乎更常用一些。因此要记住以下结论：

- 就谐波的相位而言，$A_n$和$c_n$是一致的。
- 三角正交基的谐波系数，是复指数正交基的系数的两倍。
- 信号的直流分量$a_0/2=c_0$。

</details>

![方波信号的4次谐波展开](./image/G3/fourier-series-deferent-epicycle.gif)

根据以上给出的傅里叶级数的形式，可以得到（一般的）周期实函数的频谱的一些性质：

- **周期函数的频谱是离散谱**。相邻谐波成分的间隔即为基波频率$\Omega$，也就是第一个谐波成分的频率。每个谐波成分都必然是基波频率的整数倍。
- 复频谱的实部是偶对称、虚部是奇对称。
- 幅度谱为偶对称、相位谱为奇对称。

信号对称性与其频谱的关系：

- 偶信号只包含余弦分量（频谱的实部）。
- 奇信号只包含正弦分量（频谱的虚部）。
- 非奇非偶信号，可以作奇偶分解。
- **奇谐函数**：满足$x(t + T/2) = - x(-t)$，图形上就是：**其任意半个周期的图形，可以由前半周期的波形取反（沿横轴反转）后得到**。
- 奇谐函数不含直流分量和偶次谐波，**只包含奇次谐波**。
- **偶谐函数**：满足$x(t + T/2) = x(t)$，图形上就是：**两半周期完全相同的周期函数**。
- 偶谐函数**只包含偶次谐波**（当然可以有直流分量）。

周期信号能够表示成傅里叶级数是有条件的。目前没有找到充要条件，但是有一个能够满足绝大多数现实信号的充分（不必要）条件，即**Dirichlet条件**：

+ 信号在每个周期内，都必须绝对可积。
+ 信号在每个周期内，都只有有限个极大值或极小值。
+ 信号在任何有限区间内，都只有有限个第一类间断点（可去、跳跃）。

注意：根据第1节描述的有关信号正交分解的知识，傅里叶级数的收敛，是均方误差意义上的收敛，而非一致收敛。因而在**吉布斯现象**中，尽管过冲量不会消失，但是在均方误差（能量）的意义上是收敛的。

## 连续时间傅里叶变换（CTFT）

连续时间傅里叶变换，其作用对象是满足Dirichlet条件的、一般是**非周期的连续信号**。

> **公式 连续时间傅里叶变换 CTFT**

> $$ X(j \omega) = \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - j \omega t } \mathrm{d} t $$

> $$ x(t) = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} X(j \omega) \mathrm{e} ^{ j \omega t } \mathrm{d} \omega $$

傅里叶变换系数$X(j \omega)$具有“单位频率的幅度”的量纲，因此其物理意义可以视为“频谱密度”。

CTFT是周期函数傅里叶级数（FS）的推广。其推广思路简要叙述如下：

- 首先，**非周期信号，可以看成是周期→∞（基波频率→0）的周期信号**。
- 第二，周期信号的傅里叶级数频谱是离散谱，其周期越长，基波频率越低，谱线越密集。
- 如果非周期信号是时限的（使其满足Dirichlet条件），那么可以对其作**周期延拓**。
- 若延拓周期→∞（基波频率→0），则延拓信号**就是**原来的非周期信号，其FS的谱线将无限密集，变成连续谱。这就是非周期信号的傅里叶变换。

上面介绍的都的傅里叶变换，为了使无限长的周期信号统一于傅里叶变换的体系内，可引入奇异函数如单位冲激函数，将周期信号的傅里叶级数，表示成单位冲激函数以谐波系数加权的和，这样就可以将有限长非周期信号和无限长周期信号的傅里叶变换纳入到统一的框架中。周期信号的傅里叶级数系数是离散的若干个值，代表各个谐波成分的强度。那么在连续谱的情形下，就可以推广为一族冲激信号的位移加权和。例如，频率为$\omega_0$的复指数信号$ \mathrm{e} ^{ \mathrm{j} \omega_0 t} $，其傅里叶变换$X( \mathrm{j} \omega)$为

$$ X( \mathrm{j} \omega) = 2 \pi \delta (\omega - \omega_0) $$

<details>

<summary>展开：非周期信号CTFT的导出过程。</summary>

![以周期T延拓一个长度为$2T_1$的矩形窗脉冲，所得到的频谱。从图中可以看到，**延拓周期越长，谱线越密集，但是频谱的包络不变。**可以推知，如果延拓周期无穷长，谱线之间的距离会无穷小，最终变成如包络线的连续谱。图源[1]](./image/G3/CTFT.png)

**① 延拓信号的傅里叶级数**

考虑一个时间有限的连续非周期信号$x(t)$。将其以周期T（对应基波频率$\Omega = 2 \pi / T$）重复并延拓，得到延拓后的周期信号$\tilde x(t)$。延拓信号可以表示成傅里叶级数的形式，并且取一个周期为[-T/2, T/2]作为主值周期：

$$ \tilde x(t) = \sum _{k = - \infty} ^{ + \infty} c_k \mathrm{e} ^{ \mathrm{j} k \Omega t} \tag{A1}$$

其频谱系数表达式为：

$$ c_k = \frac {1}{T} \int _{-T/2} ^{T/2} \tilde x(t) \mathrm{e} ^{ - \mathrm{j} k \Omega t} \mathrm{d} t \tag{A2}$$

尝试将频谱系数表达式（A2）中的$\tilde x(t)$换成$x(t)$，因为在[-T/2, T/2]内$ \tilde x(t) = x(t) $，除此之外$x(t) = 0$，因此可以将$\tilde x(t)$换成$x(t)$，同时可以将积分限换成正负无穷：

$$ c_k = \frac {1}{T} \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} k \Omega t} \mathrm{d} t \tag{A3}$$

**② 频谱系数的与延拓周期无关的包络函数**

频谱系数表达式（A3）中的$Tc_k$，可以看成是如下函数$X(\mathrm{j} \omega)$作为包络，在离散频点$\omega = k \Omega$处的采样。

$$ X( \mathrm{j} \omega) = \int _{- \infty} ^{+ \infty} x(t) \mathrm{e} ^{ - \mathrm{j} \omega t} \mathrm{d} t \tag{A4} $$

可见，这个包络函数$X( \mathrm{j} \omega)$与延拓周期$T$（以及基波频率$\Omega$）并没有关系，它仅由原来的非周期信号$x(t)$决定。将频谱系数$c_k$用包络函数$X( \mathrm{j} \omega)$来表示即为

$$ c_k = \frac{1}{T} X(\mathrm{j} k \Omega)$$

至此，延拓信号的傅里叶级数（A1）就可以用（与延拓周期无关，仅由原来的非周期信号决定的）包络函数$X( \mathrm{j} \omega)$表示成（注意$ T = 2 \pi / \Omega $）

$$ \tilde x(t) = \frac{1}{2 \pi} \sum _{k = - \infty} ^{ + \infty} \Omega X(\mathrm{j} k \Omega) \mathrm{e} ^{ \mathrm{j} k \Omega t} \tag{A5} $$

**③ 将周期性延拓信号的FS推广到原来的非周期信号**

若延拓周期$T → \infty$（即基波频率$\Omega → 0$），则延拓信号$\tilde x(t)$就**变成了**原来的非周期信号x(t)。考察延拓信号的傅里叶级数展开式（A5），这个离散谱的各个谐波成分之间的间隔，即基波频率，将趋于0。在这种极限情况下，频点$k \Omega$将变成连续的频率值$\omega$，而单独的基波频率因子$\Omega$变成连续频率的微分$\mathrm{d} \omega$。此时，延拓周期无限长的延拓信号，即原来的非周期信号的傅里叶级数，就从求和式转换成了积分式：

$$ x(t) = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} X(\mathrm{j} \omega) \mathrm{e} ^{ \mathrm{j} \omega t} \mathrm{d} \omega \tag{A6} $$

式（A6）为的合成形式，即$x(t)$的**傅里叶逆变换**（傅里叶积分）。式（A4）为$x(t)$的**傅里叶变换**。式（A6）的自变量之所以是$\mathrm{j} \omega$，是为了兼容拉普拉斯变换。

</details>

## 离散时间傅里叶变换（DTFT）

离散时间傅里叶变换的推导思路与连续时间情形的思路是类似的，即从非周期序列的延拓序列的傅里叶级数出发，推广到非周期序列的傅里叶变换，进而推广到周期序列的傅里叶变换。以下直接给出**离散时间傅里叶变换（DTFT）**的公式：

> **公式 离散时间傅里叶变换 DTFT**

> $$ X(\mathrm{e} ^{ \mathrm{j} \omega}) = \sum _{n = - \infty} ^{ + \infty} x[n] \mathrm{e} ^{- \mathrm{j}  \omega n} $$

> $$ x[n] = \frac{1}{2 \pi} \int _{2 \pi} X(\mathrm{e} ^{ \mathrm{j} \omega}) \mathrm{e} ^{ \mathrm{j} \omega n} \mathrm{d} \omega $$

由于频率相差2π的谐波信号是完全相同的，因此DTFT的积分限是任何长度为2π的区间，这也导致**离散序列的频谱是周期的**。该式实际上就是非周期信号x[n]的谐波组合表示，只不过由于x[n]是非周期的，组成它的谐波成分的基波频率趋于0，因此每个谐波成分之间的间距也趋于0，其频谱$X(\mathrm{e} ^{ \mathrm{j} \omega})$体现为连续谱，也就是说，**非周期信号的频谱是连续的**。

式DTFT的自变量之所以是$\mathrm{e} ^{ \mathrm{j} \omega}$，是为了兼容Z变换。

**离散时间傅里叶级数和DTFT的关系**：非周期有限长序列x[n]的傅里叶变换是连续谱，其等间隔采样就是x[n]的周期延拓序列的傅里叶级数的系数。

## 离散傅里叶变换（DFT）

| | | | | | |
|-----------|
|采样点数|-N|-N/2|0|+N/2|+N|
|物理频率|-fs|-fs/2|0|+fs/2|+fs|
|圆周频率|-2π|-π|0|+π|+2π|
|归—频率|-1|-0.5|0|+0.5|+1|

离散复指数序列，只需要考虑[0,2π)内的**归—化角频率**即可，对应物理频率的[0,fs)。因为如果把离散信号视为连续的冲激序列，它的频谱也是梳状的，并且每一个梳齿周围都是相同的频谱。

对于**无混叠带限实信号**而言，考虑到频谱的共轭对称性，只考虑[0,π)即可，因频谱搬移性质，[π,2π)的部分是[0,π)的镜像。但是对于一般的实信号来说，尽管频谱是共轭对称的，但由于存在混叠的可能性，[π,2π)与[0,π)未必是镜像关系。

一般的复信号，未必是带限的，离散采样后也有混叠的可能性，因此DFT后得到的实际上是有混叠的结果。这就是为什么在做DFT之前，一定要给原始信号加窗。因为不加窗的话，说不清得到的频谱究竟有没有混叠。

## 各种傅里叶变换之间的关系

在傅里叶变换和傅里叶级数中，存在着**离散-连续**和**周期-非周期**两大对立。对偶性质将这两大对立联系起来。一句话总结：**[[#ff0000:离散对周期，采样对延拓#]]**。

**[[#ff0000:信号不可能同时是时限和带限的。#]]**（[参考](https://en.wikipedia.org/wiki/Uncertainty_principle#Signal_processing)）在短时傅里叶变换中，要么牺牲时间分辨率换取频率分辨率，要么牺牲频率分辨率换取时间分辨率。

## 傅里叶变换的性质

如果$x(t) ↔ X(j \omega)$、$x_1(t) ↔ X_1(j \omega)$、$x_2(t) ↔ X_2(j \omega)$：

**4.0 对偶**

$$ X(jt) ↔ 2 \pi x(- \omega) $$

**4.1 线性**

$$ a x_1(t) + b x_2(t) ↔ a X_1(j \omega) + b X_2(j \omega) $$

**4.2 时移（频谱线性相移）**

$$ x(t - t_0) ↔ X(j \omega) \mathrm{e} ^{- j \omega t_0} $$

**4.3 频移（调制）**

$$ x(t) \mathrm{e} ^{j \omega_c t} ↔ X(j (\omega - \omega_c)) $$

**4.4 尺度变换**

$$ x(at) ↔ \frac{1}{|a|} X(j \frac{\omega}{a}) $$

**4.5 微分**

时域微分：

$$ \frac{\mathrm{d}}{\mathrm{d} t} x(t) ↔ j \omega X(j \omega)$$

频域微分：

$$ -jtx(t) ↔ \frac{\mathrm{d}}{\mathrm{d} \omega} X(j \omega)$$

**4.6 积分**

时域积分：

$$ \int _{- \infty} ^{t} x(\tau) \mathrm{d} \tau ↔ \pi \delta(w) X(0) + \frac{1}{jw} X(j \omega)$$

频域积分：

$$ \pi \delta(t) x(0) - \frac{1}{jt} x(t) ↔ \int _{- \infty} ^{\omega} X(\Omega) \mathrm{d} \Omega$$

> 注意：其证明过程需要用到以下关系，即将反褶平移后的单位阶跃函数作为窗口，将变限积分转换为无穷界限积分，以便于构造傅里叶变换的无穷限积分形式。

> $$ \int _{- \infty} ^{t} x(\tau) \mathrm{d} \tau = \int _{- \infty} ^{+ \infty} x(\tau) \epsilon(t - \tau) \mathrm{d} \tau  $$

**4.7 卷积**

时域卷积：

$$ x_1(t) * x_2(t) ↔ X_1(j \omega) \cdot X_2(j \omega)$$

频域卷积：

$$ x_1(t) \cdot x_2(t) ↔ \frac{1}{2 \pi} \left( X_1(j \omega) * X_2(j \omega) \right)$$

**4.8 帕斯瓦尔定理**

$$ \int _{- \infty} ^{+ \infty} | x(t) | ^2 \mathrm{d} t = \frac{1}{2 \pi} \int _{- \infty} ^{+ \infty} | X(j \omega) | ^2 \mathrm{d} \omega $$

**4.9 共轭对称性**

若x(t)为实信号：

- $ X(j \omega) = X^*(-j \omega) $（画图方便理解）
- 频谱的实部为偶函数，对应偶成分（余弦成分）：$ \mathrm{Re} \{ X(j \omega) \} = \mathrm{Re} \{ X(-j \omega) \} $
- 频谱的虚部为奇函数，对应奇成分（正弦成分）：$ \mathrm{Im} \{ X(j \omega) \} = - \mathrm{Im} \{ X(-j \omega) \} $
- 频谱的模为偶函数
- 频谱的辐角为奇函数

一般地，若x(t)为复信号：

$$ x^*(t) ↔ X^*(-j \omega) $$

**4.10 实信号的奇偶分解**

- $ \mathrm{Ev} \{ x(t) \} ↔ \mathrm{Re} \{ X(j \omega) \} $
- $ \mathrm{Od} \{ x(t) \} ↔ j \mathrm{Im} \{ X(j \omega) \} $

## 常用信号的傅里叶变换

![ ](./image/G3/SS-2-常用傅里叶变换对.png)

# 快速傅里叶变换（FFT）

## 二进制反转（2016-09-08）

在FFT算法中，有一步是对数组下标进行“码位倒置”，具体说来就是把一个数字的各二进制位倒过来写。

最直接的想法是使用移位操作将输入数字的各个二进制位提取出来，然后按照相反的顺序压入另一个数字。但是，如果设下标二进制位数为n，那么这种算法的时间复杂度是$O(n)$。

下面是一种更快、更适合硬件的“就地”码位倒置算法。对于八位无符号整数，只需要三步操作即可。

```:C
#include <stdio.h>

unsigned char bit_reverse(unsigned char i)
{
    unsigned char n = i;
    n = ( (n&0x55)<<1 ) | ( (n&0xaa)>>1 );
    n = ( (n&0x33)<<2 ) | ( (n&0xcc)>>2 );
    n = ( (n&0x0f)<<4 ) | ( (n&0xf0)>>4 );
    return n;
}

int main(void)
{
    unsigned char n = 0;

    while(1)
    {
        printf("Please input the number = ");
        scanf("%d", &n);
        n = bit_reverse(n);
        printf("The reversed number is  = %d\n", n);
    }

    return 0;
}
```

该算法可以将码位倒置算法的时间复杂度控制在$O(\mathrm {log}(n))$，挺机智的。

这个算法是在编写FFT算法的时候找到的。

**参考资料**

- [Bit-reversal permutation](https://en.wikipedia.org/wiki/Bit-reversal_permutation)
- [Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html)

## 基于FFT的大数乘法算法（2018-09-10）

大数乘法是很经典的一个问题，说简单也简单，说难也难。从最简单的错位相乘，到加入分治以提高效率，再到各种高效算法，是学习数值计算的很好的切入点。

大数乘法算法可以突破数据宽度的限制，保持运算结果的位数，因此在金融等场景中非常有用。在实现MikuRec解释器的时候，测试阶乘会遇到非常大的数字相乘，为了方便调试，打算使用大数相乘算法，取代JS语言提供的乘法。长远来看，这也有利于实现CAS之类的系统。

两个大整数相乘，本质上是卷积操作。卷积的时间复杂度是O(n<sup>2</sup>)。在数字位数很大的时候，效率不是很理想。

为了提高效率，可以利用卷积定理，通过快速傅里叶变换，将时间复杂度压缩到O(n*log(n))的级别。卷积定理指的是，两个序列卷积的傅里叶变换，等于两个序列傅里叶变换的按位相乘。因此，两个大数相乘，可以按照如下算法进行：

+ 对两个大数分别做FFT，得到两个新序列。
+ 两个序列按位相乘，得到傅里叶变换的乘积序列。这一步的时间复杂度是线性的。
+ 对乘积序列作傅里叶反变换，即为大数相乘结果。

FFT涉及浮点数运算，存在精度问题。如果使用不涉及浮点数运算的快速数论变换（NTT），就可以避免这个问题。

```
// 2018.10.10 大数乘法
function bigIntMultiply(astr, bstr) {
    // 自适应FFT长度
    let maxlen = Math.max(astr.length, bstr.length) * 2;
    let loglen = Math.round(Math.log2(maxlen));
    let FFTSIZE = (loglen % 2 === 0) ? POW[loglen+2] : POW[loglen+1]; // 偶数POW
    // 字符串->复数序列
    let a = new Array(FFTSIZE);
    let b = new Array(FFTSIZE);
    for(let i = 0; i < FFTSIZE; i++) {
        aDigit = (i < astr.length) ? parseInt(astr[astr.length-1-i]) : 0;
        bDigit = (i < bstr.length) ? parseInt(bstr[bstr.length-1-i]) : 0;
        a[i] = new Complex(aDigit, 0);
        b[i] = new Complex(bDigit, 0);
    }
    // 傅氏变换
    let A = FFT(a, FFTSIZE);
    let B = FFT(b, FFTSIZE);
    // 卷积
    let C = new Array();
    for(let i = 0; i < FFTSIZE; i++) {
        let c = A[i].mul(B[i]);
        C.push(c);
    }
    let c = IFFT(C, FFTSIZE);
    // 以字符串输出
    return (function(n) {
        let numstr = '';
        let carry = 0;
        for(let i = 0; i < n.length; i++) {
            let c = Math.round(n[i].rep) + carry;
            if(c >= 0 && c <= 9) {
                numstr = c.toString() + numstr;
                carry = 0;
            }
            else {
                numstr = (c % 10).toString() + numstr;
                carry = Math.round((c - c % 10) / 10);
            }
        }
        return numstr.replace(/^0*/gi, '');
    })(c);
}
```

**参考资料**

+ [Schönhage–Strassen algorithm](https://en.wikipedia.org/wiki/Sch%C3%B6nhage%E2%80%93Strassen_algorithm)
+ [大数乘法（快速傅立叶变换）](https://blog.csdn.net/u013351484/article/details/48739415)
+ [FFT详解&大数乘法](https://blog.csdn.net/ripped/article/details/70241716)

## 离散余弦变换（DCT）

8点快速DCT信号流图（Loeffler C , Ligtenberg A , Moschytz G S . **Practical fast 1-D DCT algorithms with 11 multiplications**[C]. ICASSP-89.）：

![8点快速DCT信号流图](./image/G3/DCT8-fast.svg)

8点快速IDCT信号流图（基于上面的信号流图推导）：

![8点快速IDCT信号流图](./image/G3/IDCT8-fast.svg)

附：蝴蝶结反向的系数关系，本质上是解二元一次方程组。

![蝴蝶结反向的系数关系](./image/G3/butterfly.svg)

**改进的离散余弦变换（MDCT）**

## 快速沃尔什变换

## 快速数论变换（NTT）

## K-L变换

# 采样

## Nyquist采样定理

2022-06-04

从[这篇文章](https://zhuanlan.zhihu.com/p/33554898)提供的第一个视频开始讲起。

譬如，用纸片刮风扇扇叶，如果转速比较慢，那么每个脉冲都保持自己的“音色”，人耳可以区分出每个脉冲。随着转速升高，脉冲连成“一片”，出现音调，并且转速越快，音调越高。

下图蓝色的连续谱是脉宽为1ms的方波的频谱，可见其大部分能量分布在1kHz以内，说明这是个听起来比较低沉的脉冲。

而黄色的离散谱，是以5ms为周期，重复播放这个脉宽为1ms的脉冲的方波。可以看到，谱线的第一基频是200Hz，其余谱线是方波连续谱的采样。这其实就是周期方波的频谱，听起来是典型的“电音”音色。其基音频率，就是第一基频的200Hz。

采样定理在直观上可以理解为对时域的均匀采样，会导致信号（带限）频谱的周期延拓。而上述现象可以理解为采样定理的对偶形式：对时域（时限）信号的周期延拓，会导致信号频谱的离散化。

![实测](./image/G3/pulse_series_spectrogram.jpg)

![理论分析（Octave代码见下文）](./image/G3/pulse_series_spect.png)

```
# Octave

sample_rate = 8000; %采样率（Hz）
T = (0 * sample_rate) : 1 : (1 * sample_rate - 1); %时间轴（采样点）
duration = length(T); %采样点数量
pulse = zeros(1, 1 * sample_rate); %初始化脉冲序列

%% 构造单个脉冲
amp = 1; %脉冲幅度
pulsewidth = 0.001; %脉宽（秒）
for t = T
    if (t >= ((0.5 - (pulsewidth/2)) * sample_rate)) && (t <= ((0.5 + (pulsewidth/2)) * sample_rate))
        pulse(t) = amp;
    endif
end

%% 构造脉冲序列
pulse_series = zeros(1, 1 * sample_rate);
interval = 0.005; %脉冲间隔（秒）
for i = 1 : 1 : floor(length(T) / (interval * sample_rate))
    offset_left  =  floor(interval * sample_rate * i);
    offset_right = -floor(interval * sample_rate * i);
    pulse_series = pulse_series + circshift(pulse, offset_left);
    pulse_series = pulse_series + circshift(pulse, offset_right);
end
%% 能量归一化（便于比较频谱）
pulse_series = pulse_series ./ (2 * length(T) / (interval * sample_rate));

%% 计算并绘制频谱
freq_axis = -(sample_rate / 2) : 1 : (sample_rate / 2) - 1;
pulse_spect = fftshift(abs(fft(pulse).^2 / length(T)));
pulse_series_spect = fftshift(abs(fft(pulse_series).^2 / length(T)));

plot(freq_axis, pulse_spect);
hold on;
plot(freq_axis, pulse_series_spect);

title ("Power Spectrum");
legend("single square pulse", "pulse series");
```

## 压缩感知

**问题：传统Nyquist采样成本高、效率低**

- 传统Nyquist采样是均匀采样。受Nyquist采样定理限制，其采样率一般需要**高于被采样信号带宽的两倍**，才不至于发生混叠失真。
- 对于高分辨率音视频、宽带射频信号等，由于其带宽本就非常宽，因而所需采样率非常高。工程上，高采样率的实现是**非常昂贵、困难**的。
- 自然界中的许多信号，例如音视频信号，在某个表示域内往往是**稀疏的**、存在冗余的，因而消耗大量采样成本采集到的“生”信号，最终往往要被压缩编码才适合处理，这是**对感知资源的浪费**。
- 能否将采样（感知）与压缩合二为一？

**解决方案：压缩感知**

- 对于**在某个表示域稀疏**的信号，可使用一组“采样信号”对原信号作内积（采样），其中采样信号的数量**远少于**原信号维度，这就是对原信号的稀疏采样。
- 从稀疏采样中恢复原始信号的过程，可以理解成解方程组。然而稀疏采样与原信号和采样信号之间构成欠定方程组，因而需要通过求解优化问题的方式，从采样结果中**估计出**最优（即所有可能的原始信号中最稀疏）的原信号。不幸的是，此类问题一般是需遍历所有可能结果的NP-hard的非凸优化问题。但在**某些简化条件**下，问题可被转化为凸优化问题，能行地解决。
- 近年来有使用深度学习算法解决CS采样恢复问题的工作。
- 压缩感知及恢复可行的条件是**原信号稀疏**、采样信号和恢复算法满足一定条件。

------

**稀疏数据与数据压缩**

许多物理信号是稀疏的，或者说存在大量冗余，可能是时域、空域稀疏，也可能是变换域稀疏。

传统的信息通信模型：

数据采集→数据压缩→数据传输→数据解压

- 采集成本高（动辄一亿像素摄像头之类的）
- 压缩成本高（编码器复杂度高）
- 传输成本视乎压缩技术而定
- 解压成本低（解码器复杂度远低于编码器）

新的针对稀疏数据的信息通信模型：

压缩感知→数据编码→数据传输→数据解压

要点是：①如何保证少量的采样数据可以包含原始信号的全局信息，实现采样压缩的合并；②寻找算法从少量数据中尽可能低失真地恢复出原先的信息。

这样可以减少采集和压缩成本，但是理论和工程可行性仍需探索。

传统Nyquist采样痛点：信号带宽越来越大，采样成本越来越高。但是实际采样到的数据又往往存在大量冗余，采样到之后还要进行数据压缩。这种先采样再压缩的过程，是对采样资源的巨大浪费。

**压缩感知一般过程**

![Compressive sensing measurement process with (random Gaussian) measurement matrix Ф and discrete cosine transform (DCT) matrix Ψ. The coefficient vector s is sparse with K = 4.](./image/G3/compressive-sensing-sampling.png)

+ 将原始信号变换为稀疏信号（稀疏变换）。
+ 使用感知信号对稀疏信号作随机欠采样，得到远少于采样定理所要求的数量的少量样本。采集到的少量样本与感知信号构成一个线性欠定方程组。
+ 在“稀疏”和失真最小化的约束下，求解优化问题，以得到欠定方程组的稀疏解。

**压缩感知应用**

单像素照相机

![ ](./image/G3/compressive-single-pixel-camera.png)

**参考资料**

- [形象易懂讲解压缩感知](https://zhuanlan.zhihu.com/p/22445302)
- 戴琼海, 付长军, 季向阳. **[压缩感知研究](http://cjc.ict.ac.cn/quanwenjiansuo/2011-3/dqh.pdf)**[J]. 计算机学报, 2011, 34(3): 425-434.
- Richard Baraniuk. **Compressive Sensing - A New Approach to Signal Acquisition and Processing**[S]. Rice Univ. （包括相关的课程讲义等资料）

传统奈奎斯特采样，底大一级压死人。通过增加时空采样率的方式，提升采样精度。但是这样成本太高，提升采样率的边际收益很低。

对于稀疏的、长度为n的原始信号x[n]，可以事先指定一组信号作为采样信号（探针），这组采样信号构成一个矩阵phi[m*n]（m远小于n），称为采样矩阵。对稀疏信号采样时，使用采样信号与原始信号做内积，得到一个采样值，而采样频率可以远小于原始信号的奈奎斯特频率，得到一组较少的采样y[m] = phi x。

通过这种方式得到的采样值，与原始信号和采样矩阵之间构成了一个欠定方程，一般情况下无法通过采样点恢复出原始的稀疏信号。但是只要满足一些条件，就可以利用某种优化算法去求解这个方程，即在欠定方程的所有可能的解中，寻找最稀疏的解作为恢复出的原始信号。

但是，如果选择稀疏性（0范数）作为优化目标，会使得问题变成NP难问题。选择p范数（0\<p\<1）也有类似的困难。但是，在某些条件下，对0范数的优化可以等价为对1范数的优化，这就使得问题转化为相对简单的线性规划问题。至于为什么不用2范数，可通过图形作粗略说明。

有许多物理信号往往并非稀疏，但是在某个变换域上是稀疏的。如果记输入信号为x，变换矩阵为psi，那么变换域上的稀疏信号为s = psi x。如果对变换域稀疏信号应用上面所说的采样，就得到y = phi s = phi psi x。

记观测矩阵A = phi psi，如果A也满足采样矩阵的某些条件，那么就可以按照上面的论述，通过最优化算法从输出的采样值y估计出输入x。

那么以上方法对于原始信号和观测矩阵都有哪些限定条件？

① 原始信号在某个正交基上是稀疏的（待续）

------

2021-07-17：支持向量机应该是传统二分类算法的极致了。最妙的是核方法和软间隔两个核心思想。重要的是这两者都有坚实的数学基础和能行的算法。这就是理论和实践完美结合的艺术品。压缩感知也算一个艺术品，思想巧妙，理论坚实，计算可行，可惜目前不太实用。

# 拉普拉斯变换

复指数信号$\mathrm{e}^{st}$（$s \in \mathbb{C}$）是我们的好朋友，因为LTI系统对复指数信号的响应也是复指数信号，只不过是被加权了。也就是说，复指数信号是LTI系统的特征函数，而加权权重是系统的特征值。数学推导如下：

设LTI系统的单位冲激响应是$h(t)$，则其对输入信号$x(t) = \mathrm{e}^{st}$的响应

$$ \begin{align}
y(t) &= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot x(t - \tau)} \mathrm{d} \tau \\\\
&= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{s(t - \tau)}} \mathrm{d} \tau \\\\
&= \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{st} \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau \\\\
&= \mathrm{e}^{st} \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau \\\\
\end{align}
$$

如果右边的无穷限积分收敛，则可以写成某个关于s的变量$H(s) = \int _{- \infty} ^{+ \infty} {h(\tau) \cdot \mathrm{e}^{-s \tau}} \mathrm{d} \tau$。这样，系统对复指数信号的响应就可以写成

$$ y(t) = H(s) \cdot \mathrm{e}^{st} $$

意味着，复指数信号就是LTI系统的特征信号。对于离散信号和离散系统也如此。

------

考虑到LTI系统的线性和时不变性，如果LTI系统的输入信号可以被分解成复指数信号的线性组合（正交分解），那么LTI系统对于输入信号的响应，就等于LTI系统对于每个复指数信号的响应的线性组合。

关于信号的正交分解，如果选用三角正交函数族$\{ \mathrm{e} ^{j \omega} \}$，那么这就是傅里叶变换。当然，傅里叶变换是有条件的，也就是Dirichlet条件。如果选用一般的复指数信号作为基底，对信号做正交分解，这就是拉普拉斯变换：

$$ X(s) = \int _{- \infty} ^{+\infty} x(t) \mathrm{e} ^{-st} \mathrm{d} t $$

从形式上看，这就是复指数信号通过LTI系统之后，系统为输入信号所施加的权重（特征值）。

单边拉普拉斯变换：

$$ X(s) = \int _{0^-} ^{+\infty} x(t) \mathrm{e} ^{-st} \mathrm{d} t $$

![引自[www.dspguide.com](http://www.dspguide.com/CH32.PDF)](./image/G3/laplace-transform.png)

常用拉普拉斯变换表：以下处理的均为单边信号、单边拉氏变换，收敛区略。

|$f(t)$|$F(s)$|
|------------------|
|$\delta^{(n)}(t)$|$s^n$|
|$\delta(t)$|$1$|
|$\epsilon(t)$|$\frac{1}{s}$|
|$t \epsilon(t)$|$\frac{1}{s^2}$|
|$\frac{t^n}{n!} \epsilon(t)$|$\frac{1}{s^{n+1}}$|
|$𝐞^{at} \epsilon(t)$|$\frac{1}{s - a}$|
|$t𝐞^{at} \epsilon(t)$|$\frac{1}{(s - a)^2}$|
|$\frac{t^n}{n!} 𝐞^{at} \epsilon(t)$|$\frac{1}{(s - a)^{n+1}}$|
|$\sin (\omega t) \epsilon(t)$|$\frac{\omega}{s^2 + \omega^2}$|
|$\cos (\omega t) \epsilon(t)$|$\frac{s}{s^2 + \omega^2}$|
|$\sinh (\beta t) \epsilon(t)$|$\frac{\beta}{s^2 - \beta^2}$|
|$\cosh (\beta t) \epsilon(t)$|$\frac{s}{s^2 - \beta^2}$|
|$𝐞^{at} \sin (\omega t) \epsilon(t)$|$\frac{\omega}{(s - a)^2 + \omega^2}$|
|$𝐞^{at} \cos (\omega t) \epsilon(t)$|$\frac{s - a}{(s - a)^2 + \omega^2}$|
|$2A 𝐞^{at} \cos(\omega t + \phi)$|$\frac{A 𝐞^{𝓳 \phi}}{s - a - 𝓳 \omega} + \frac{A 𝐞^{-𝓳 \phi}}{s - a + 𝓳 \omega}$|

拉普拉斯逆变换：

- 部分分式展开法
- 留数法

拉氏变换的性质：

- 线性
- 时移
- 频移
- 尺度
- 微分（时域、频域、对参）
- 积分（时域、频域、对参）
- 卷积定理（时域、频域）
- 初值定理
- 终值定理

# z变换

# 信号与系统分析

小波分析

拉东变换

**基于高阶统计量的信号检测方法（2021-05-20）**

- 高斯（有色）噪声的高阶（大于2阶）累积量恒为0，可以提取混杂在高斯噪声中的非高斯信号，并且可以用来度量信号的“非高斯性”。
- 高阶累积量含有相位信息。
- 高阶累积量可以刻画系统的非线性性质。
- 高阶统计量可以作为深度神经网络的输入特征，用来解决频谱感知问题，如信号调制方式分类等。

参考资料：吴嗣亮. 高阶统计量信号处理方法.（本地存档有）

# 数字滤波器

2022-03-06：数字滤波器作为920的最后一个考点，无疑是不简单的。但是它实现起来又是那么简单，落实到代码上，只是一堆简单的加减乘除而已。这就有点像复杂度理论中的现象：验证一个答案是简单的，而得到一个答案是困难的。

## 概述

描述LTI数字滤波器的四种等价方式：差分方程、单位冲激响应、z域传递函数、频率响应。频率响应是TF在单位圆上的取值，是IR的傅里叶变换。

分类方式：

- 按IR分类：FIR、IIR
- 按FR分类：低通、高通、带通、带阻、全通
- 按结构分类：递归滤波器、非递归滤波器。IIR通常是递归的。FIR未必是非递归的。

性能参数：很多性能参数是鱼与熊掌不可兼得的关系。

- 频域参数：截止频率、过渡带宽、通带纹波、阻带衰减…
- 时域参数：主要看单位阶跃响应（边缘）
- 其他：相位特性（是否线性相位）、阶数、结构、稳定性、是否对有限字长效应敏感等

滤波器选型：

- 从传函结构来看，IIR因存在反馈结构，容易受有限字长效应影响，例如如果IIR的极点位于单位圆附近，量化误差容易使极点跑到单位圆外面，引起寄生振荡而不稳定。
- 从IR来看，FIR可以通过卷积计算，而卷积可以通过FFT加速。
- 从成本和复杂度来看，同样的频率选择性，IIR的阶数比FIR要低5~10倍，因此成本也较低。
- 从相位特性来看，FIR可以实现严格的线性相位特性，IIR不行。
- 从设计来看，IIR可以从模拟滤波器出发，用现成的公式或者查表转换得到；而FIR的设计方法多而复杂，性能参数往往没有公式可以算。
- 从功能来看，IIR只适合设计具有片段常数特性的滤波器，如BPF等；FIR花样很多，如微分（差分）器、希尔伯特变换等。
- 总而言之，IIR在实现较高的频率选择性方面有优势，而FIR在保持线性相位上有优势。

滤波器实现结构：

- 基本运算就3种：加法、乘法、延时
- 有理分式形式的TF，可以因式分解，可以部分分式展开，对应不同的结构和计算复杂度（参见[秦九韶算法](https://zh.wikipedia.org/zh-cn/%E7%A7%A6%E4%B9%9D%E9%9F%B6%E7%AE%97%E6%B3%95)）。

从低通滤波器出发…高通 = 全通 - 低通，带通和带阻可以从低通和高通组合而得到。

![引自[www.dspguide.com](http://www.dspguide.com/CH14.PDF)](./image/G3/hpf-bpf-brf.png)

## 无限冲激响应（IIR）滤波器

## 有限冲激响应（FIR）滤波器

FIR滤波器的单位冲激响应是有限长的，其长度（点数）记为N，则其阶数为(N-1)，因为N点FIR滤波器有(N-1)个零点。其传递函数是单位冲激响应$h(n)$的z变换：

$$ H(z) = \sum _{n = 0} ^{N-1} h(n) z^{-n} = h[0] + h[1]z^{-1} + ... + h[N-1]z^{-(N-1)} $$

这实际上描述了一个差分方程的形式。是全零点系统。

<iframe class="MikumarkIframe" src="./html/digital-filter.html" height="600px"></iframe>

```
% Octave

N = 1024;
t = -N/2 : 1 : N/2-1;
a = 0.4;
x = a .* sinc(t .* a);
hamming = 0.54 - 0.46 .* cos(2 * pi * (t - N/2) / N);
lpf = x .* hamming;

%高通 = 全通 - 低通
hpf = lpf .* (-1);
hpf(N/2 + 1) = hpf(N/2 + 1) + 1;

kernel = hpf; %或者hpf

X = fftshift(20 * log10(abs(fft(kernel))));

plot(t ./ N, X, "-");
axis([-0.5, 0.5]);
xlabel("归一化频率");
ylabel("幅度(dB)");
grid on;
```

线性相位特性：滤波器频率响应可以分解为幅度相应和相位响应两部分，所谓线性相位特性指的是相位响应为线性函数。而滤波器的群延时是相位关于频率的导数，因此线性相位特性意味着系统对于所有频率具有相同的群延时。

**FIR滤波器具有线性相位特性，等价于其单位冲激响应具有对称性。**如何理解？根据DFT的时延性质，IR的每个点，都对应一个延迟效果，这反映出IR与差分方程的等价性。从物理直观的角度来看，IR关于某个点对称，意味着IR上每两个对称点所造成的平均延迟，都等于对称中心带来的延迟，总起来看，也就是所有频率上都有相同的群延时。至于IR对称和线性相位两者之间的充要条件，在数学上也容易验证。

线性相位FIR滤波器有4种，每一种都有各自的适用场景和局限性。

## 滑动平均滤波器

其冲激响应h[n]是矩形脉冲，频域响应是sinc。时域上奇数个点，单边或双边（单边会造成相移；线性相位必须双边对称）。Pros：时域边沿陡峭；线性相位（好的平滑滤波器）；滑动平均滤波器用递归实现极其高效（最快的数字滤波器），可通过定点或者整数运算实现。Cons：频域滚降慢；阻带衰減小（差的低通滤波器）。

级联的滑动平均滤波器：矩形窗自卷积+三角窗+...+高斯窗（中心极限定理）高斯窗的时域和频域是同样形状的。（[视频解说](https://www.bilibili.com/video/BV1Yk4y1K7Az/)）

## 窗函数法设计FIR滤波器

理想低通滤波器是矩形窗口，但是其冲激响应sinc函数无限长，物理上不可实现。若强行用矩形窗简单截断冲激响应，在频域上会引发吉布斯效应，劣化纹波、滚降、阻带衰减指标。因此需要为sinc内核加合适的窗，使其频率响应的边缘缓慢过渡。

两个基本参数：归—化截止频率fc∈(0，0.5)和IR点数M。IR点数越长，滚降越快（归一化过渡带宽越窄）：TBW=4/M

## 希尔伯特变换

**实信号**的傅里叶变换具有共轭对称性，又叫Hermitian（厄米特/埃尔米特）对称性，即$F(-x) = F^*(x)$（星号代表共轭，F(x)是复值函数）。反之，共轭对称复信号的傅里叶变换是实信号。

这意味着，**实信号的傅里叶变换（下面姑且称为频谱）是双边带的**，并且其实部是偶对称、虚部是奇对称，进而幅度是偶对称、相位是奇对称。两个边带对称，意味着有一个边带是冗余的，浪费了一倍的带宽。

如果想只保留单边频谱，那么原来的信号就不会是实信号。为了从原来的实信号构造出单边带信号，需要引入希尔伯特变换。

希尔伯特变换，实际上是一种全通滤波器，它的物理意义是为信号施加90°相移。其单位冲激响应记为$h_h(t)$，频率响应为

$$ H_h(\omega) = -j \cdot \mathrm{sgn}(\omega) $$

有了希尔伯特变换，就可以引入**解析信号**的概念。实信号$x(t)$的解析信号$x_a(t)$是一个复信号，其实部是原来的实信号$x(t)$，虚部是$x(t)$的希尔伯特变换$x_h(t) = x(t) * h_h(t)$：

$$ x_a(t) = x(t) + j \cdot x_h(t) $$

解析信号$x_a(t)$的傅里叶变换$X_a(\omega) = X(\omega) + j \cdot X_h(\omega)$，而$X_h(\omega) = X(\omega) \cdot H_h(\omega) = -j \cdot X(\omega) \cdot \mathrm{sgn}(\omega)$，所以$X_a(\omega) = (1 + \mathrm{sgn}(\omega)) \cdot X(\omega)$，即当ω大于0时，$X_a(\omega) = 2 X(\omega)$；ω小于等于0时，$X_a(\omega) = 0$。这是一个单边带频谱。

因此，解析信号$x_a(t)$是单边带信号。直观上来看，对实信号构造解析信号，相当于把实信号频谱的负频率部分（下边带）翻转并叠加到正频率部分，因此是能量守恒的。

为了将单边带的解析信号恢复为双边带的实信号，直接取其实部即可，即

$$ x(t) = \mathrm{Re} \{ x_a(t) \} $$

在实信号和解析信号的互相转换的过程中，没有发生任何信息和能量的损失，其根本原因可能就是某种数学结构内在的共轭对称性。

希尔伯特变换是相移法单边带调制的核心，详见单边带调制的章节。

TODO 希尔伯特变换FIR滤波器的设计实现

# 多采样率数字信号处理

# 数字逻辑系统

## 数值编码

## 组合逻辑

## 时序逻辑

## 74系列逻辑电路

# 模数数模转换器

- [ADC的理论信噪比公式](https://www.analog.com/media/cn/training-seminars/tutorials/mt-001_cn.pdf)

## Δ-Σ调制

# 随机过程

[Box–Muller transform](https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform) is a random number sampling method for generating pairs of independent, standard, normally distributed (zero expectation, unit variance) random numbers, given a source of uniformly distributed random numbers.

# 信息论

# 信道

# 调制

## 模拟连续波调制

**线性调制（调频）**

在通信系统中，信源所产生的基带信号，往往是实信号。为了节约频谱，通过希尔伯特变换（相移网络/数字滤波器）将其变换为解析信号，得到复基带信号，再将其调制到复载波$\mathrm{e}^{j \omega_c t}$上，得到复通带信号。然而发射出去的只能是实信号，因此将复通带信号取实部发射出去，没有损失任何信息。尽管实的通带信号又变成了双边带信号，但是在载波频率附近只保留了基带信号的一个边带，实现了节约频谱的目标。

![ ](./image/G3/ssb-modulation.svg)

![SSB相移调制](./image/G3/SSB相移调制.png)

**非线性调制（调角）**

![调频频谱图和瀑布图](./image/G3/fm-spectrum.png)

![贝塞尔函数](./image/G3/bessel.svg)

使用Octave或Matlab绘制：

```
z = 0:0.1:20;
J = zeros(5,201);
for i = 0:4
    J(i+1,:) = besselj(i,z);
end
plot(z,J);
grid on;
legend('J_0','J_1','J_2','J_3','J_4','Location','northeast');
title('Bessel Functions of the First Kind');
xlabel('z');
ylabel('J')
```

## 模拟脉冲调制

**关于阻尼波通信（2021-05-06）**

国内国际的无线电规章，如ITU《无线电规则》3.15条和《中华人民共和国无线电频率划分规定》2.12条规定，一切电台都不得使用**阻尼波**（减幅波）发射。为什么？按照[维基百科](https://en.wikipedia.org/wiki/Damped_wave_\(radio_transmission\))的说法，“阻尼波”在法律上的定义是模糊的，这也就导致我在读到《频率划分规定》2.12条时产生很大的疑问。

不过一般来讲，阻尼波，与CW连续波相对，是按照指数规律减弱的有阻尼电磁波，一般体现为窄脉冲序列。古早的[火花发报机](https://zhuanlan.zhihu.com/p/29598819)，就是利用发射阻尼波工作的。但阻尼波会占用大量并不需要的带宽，干扰临近的业务，因此CW出现后，火花发报机就被淘汰了。其实现在也存在着某种意义上的火花发报机，那就是煤气灶点火器，一种按下按钮后就会发出连续电火花脉冲的小工具。

如何改进CP16、AM32等图形调制的显示效果？诸如CP16，以及我自己改良的“[AM32](./html/am32.html)”这类技巧，实际上是多个频率上的OOK（开关键控），是ASK的一种特殊情况。如果开关的边沿很陡（相当于时域上加矩形窗），那么在频域上就会体现出比较强的旁瓣成分，导致瀑布图很不好看（见下图左侧）。为了抑制旁瓣，在简单OOK的基础上，在时域上加三角窗。由于边沿变缓，旁瓣被削弱，瀑布图效果明显改善（见下图右侧）。

![ ](./image/G3/CW-bandwidth.jpg)

成品CW发报机实际上也不是简单的矩形窗OOK。如[参考资料](https://zhuanlan.zhihu.com/p/30593852)(*)所述：锋利的上升下降沿会在电码侧音起始和结束时耳机中引起难受的咔嗒声，同时较强的旁瓣会给临近频率的电台带来潜在干扰。设计精良的CW发报机，会使用升余弦滤波器等手段作脉冲整形，以最小化无用的发射。

难道阻尼波真的毫无价值吗？在检索阻尼波相关资料时，了解到[超宽带通信](https://zh.wikipedia.org/wiki/%E8%B6%85%E5%AF%AC%E9%A0%BB)（UWB）这一概念。简单来说，就是用时间上极短（纳秒~皮秒级）、但频域带宽极宽（GHz级）的脉冲进行通信。由于发射信号的功率谱密度很低，因此可以与其他采用连续波载波的体制共用频谱，而不互相干扰。在瀑布图上闲逛的时候，偶尔会在V/U段（短波似乎也有？）看到某些占用带宽非常宽，但持续时间很短、强度很弱的信号（2021-08-20补充：有些是AIS、ADS-B）。猜想这也是某种宽带通信或者扩频通信方式。（2023-01-30补充：100kHz上的[Loran-C](https://en.wikipedia.org/wiki/Loran-C)信号就是一种脉冲信号）

翻阅《实用射频技术手册》时，在第11章（p.138）偶然发现超再生发射/接收机也是利用阻尼波进行通信。

## 数字基带调制

## 数字通带调制

## OFDM

主要参考资料：Yong Soo Cho, et al. **MIMO-OFDM无线通信技术及Matlab实现**[M]. 电子工业出版社, 2013.

**无ISI传输的条件（Nyquist准则）**

信道总体脉冲响应，期望在本码元的**抽样时刻**非零，而在其他码元的**抽样时刻**为零。这样就可以消除ISI。因为信道IR在非本码元抽样时刻上的值，起到了时移的效果，造成延迟和拖尾，将能量叠加到其他码元的抽样时刻上，形成了ISI。

无ISI的时域条件是：$g(nT_s) = \delta[n]$，其中g是信道总体IR，$T_s$是码元周期，n是码元序号，$nT_s$即为抽样时刻。

与其等效的频域条件是：信道总体频率响应可以**等效**成理想矩形窗，这里不展开数学推导，但是可以做一个直观解释：将信道频率响应以$1/T_s$为间隔切成小段，平移到$(-1/T_s, 1/T_s)$区间内，叠加起来，得到的结果应当是常数，也就是在主值区间内得到了一个理想矩形窗。进一步理解，考虑到频域延拓等效于时域采样，既然抽样时刻$nT_s$的时域响应都是0，说明频域每隔$1/T_s$延拓出去的部分并没有引入多余的能量。因此极限地看，如果采样间隔→0（延拓周期$1/T_s$→∞），得到了一个连续的$\delta(t)$，那么频域也就没有延拓，频域响应在无穷长的主值周期内是常数，可以看成是一个无限宽的矩形窗。既然延拓出去的部分并未引入新的能量，那么延拓出去的部分实际上就是把这个矩形窗拆解之后延拓出去的。如果再把它们“收回来”，叠加在一起，就会恢复成原来的矩形窗。

这个理想矩形窗的截止频率是**0.5倍的波特率，此为Nyquist带宽**。如果信道相干带宽低于Nyquist带宽，则无法保证无ISI传输。

**单载波高速传输的难点**

高波特率传输，意味着高带宽需求，容易受到多径衰落的影响。另外，波特率增加，均衡器的复杂度也增加。

**从FMT多载波到OFDM**

FMT（滤波多音）为每个子载波使用独立的信号通路（滤波器、振荡器等），子载波频谱之间是没有重叠的。而OFDM基于能量正交的思想，同样是划分为多个子载波，但子载波频谱之间有重叠，它们之间的正交性是积分（内积）意义上的正交性，可以用数学方式复用和解复用，物理上无需也不能用独立的信号通路去处理。

**OFDM子载波正交条件**

下文将OFDM的symbol称为“符号”，而串并转换前经QAM等单载波调制得到的symbol称为“码元”。OFDM最基本的参数有两个：子载波数$N$、OFDM符号周期$T_{sym}$。为了实现子载波正交（在一个符号周期$T_{sym}$内积分），需要满足以下关系：

+ 第k个子载波频率为$f_k = k / T_{sym}$（基波频率$f_1 = 1 / T_{sym}$）
+ 子载波间隔为$\Delta f = 1 / T_{sym}$

第k个子载波的频率是基波频率的k倍，即$f_k = k / T_{sym}$，且所有子载波在一个符号周期$T_{sym}$内是正交的。第一个子载波就是基波，其频率即为OFDM符号速率。频率最高的子载波，其频率就等于串并转换前码元序列的波特率。

其推导过程见《通信原理》（第七版）P243。如何解释？每个子载波可以认为是被QAM/QPSK符号调制（加权）了的ASK信号，其持续时间有限（$T_{sym}$），频谱是频移了的sinc函数，其中心为子载波频率$f_k = k / T_{sym}$，第一零点（也等于零点间隔）为$1/T_{sym}$。因此OFDM符号的频谱就是多个频移sinc函数在频域上的叠加。如果满足子载波正交条件，那么每个子载波的sinc频谱的中心$f_k = k / T_{sym}$，正好落在其余子载波的sinc频谱的零点位置，直观上看是有“正交”的意思在里面的。

![OFDM示意。[来源](https://rfmw.em.keysight.com/wireless/helpfiles/89600B/WebHelp/Subsystems/wlan-ofdm/Content/ofdm_basicprinciplesoverview.htm)](./image/G3/ofdm-f-t.png)

从正交条件还可以导出以下关系：

- 子载波数$N$ = 每个OFDM符号所携带的码元数
- $T_{sym}$ = 基波频率 = 第一个子载波频率 = 子载波间隔
- 码元周期$T_s$ = $T_{sym} / N$

**OFDM调制过程**

把QPSK/QAM码元分组，每组N个码元，将其调制到N个子载波上，然后将子载波叠加起来，就得到了一个OFDM符号。由于各个子载波间正交，因此解调时可以分离。保持正交的前提是，必须精确地在一个完整的符号周期内积分，这就是为什么OFDM对符号同步非常敏感。如果积分起始位置不对，则会破坏正交条件。

- 把串行QPSK/QAM码元分组，每组N个码元（串并转换）。
- 组号为$l$，组内码元编号$k$，则第$l$组的第$k$个码元记为$X_l[k]$，$k \in [0, N-1]$。
- 将组内每个码元$X_l[k]$调制到第k个正交子载波（时间连续）上，将所有N个调制了的正交子载波加起来，就得到一个连续的OFDM符号。
- 对OFDM符号进行采样：以码元速率为采样率（见下文说明），在$t = l \cdot T_{sym} + k \cdot T_s$（记住$T_{sym} = N \cdot T_s$）时刻对OFDM符号采样，得到N个采样点。可以证明，这N个采样点，就是$\{ X_l[k] \} \vert ^{N-1}_{k=0}$的N点IDFT。

> 2023-07-11：OFDM有一个十分微妙的细节：运用IDFT实现OFDM调制的推导过程中，很重要的一点是在串行码元时刻对OFDM符号波形作采样。于是这里就比较令我费解了：根据采样定理，采样频率不应该大于码元频率的两倍才对吗？

> 然而，这里处理的是复信号。

> 通常所说的采样定理，一般针对的是实信号。对实信号作傅里叶变换，所得到的频谱是共轭对称的，也就是实部/幅度偶对称、虚部/相位奇对称，这就是双边带信号。对实信号采样，相当于频域上周期延拓，因而延拓后的一个边带有与另一个边带混叠的可能性。

> 而复信号的频谱未必是共轭对称的。只有一个边带的单边带复信号可以通过提取实部的方式转化为双边带实信号，而（双边带）实信号也可以通过所谓的解析变换变成解析信号，解析信号是单边带的。这也就是说，单边带复信号实际上就是实信号，这就是IQ调制的理论基础。空中传播的无线电信号，是实信号，经过IQ调制之后，变成单边带复信号，信息没有损失，当然，更没有凭空增加。

> 对带限的单边带复信号作采样，其频谱以采样频率周期延拓，但由于只有一个边带，不会与另一侧边带相混叠，所以复信号的采样频率就是不低于信号带宽，而不是两倍带宽。而在工程实现上，这一结论并未给出偷懒的可能性：尽管采样频率可以降低一半，但却要同时对两路信号进行采样，总的代价并未降低，只是时空相互代换罢了。

> 所以，在OFDM的IDFT实现的推导过程中，以码元频率对复数的OFDM波形进行采样，这并未违反采样定律。

表面上看，OFDM没有带来明显的效率提升或者频谱节约，但是它带来了抗衰落、抗码间串扰（把时间上相邻的码元排列到频域上了，符号速率降低了）、降低信道均衡器复杂度、载波自适应等好处。劣势就是多个载波叠加容易产生高PAPR进而降低PA效率、以及对于同步误差相当敏感。OFDM系统很大一部分复杂度就是在处理这两个问题上。

**保护间隔**

为了消除OFDM符号间的ISI，时域上会在符号间插入保护间隔GI。

信道IR的每一点都可以看成是对传输信号的延迟加权。理想的信道应当是单位冲激，不存在延时，但这几乎不可能。信道IR一般都有一定的宽度，这个宽度称为最大时延扩展τ。这意味着，如果OFDM符号连续发射，上一个符号最多会被延迟τ，叠加到下一个符号上，引起ISI，破坏子载波正交性。这就好比在一个有回声的大厅里说话，如果说得太快，上一个字的回声就会淹没下一个字，什么也听不清。一种解决办法就是说完一个字停顿一下，等回声消失后再说下一个字。

OFDM符号之间的这种“停顿”，就是保护间隔。大致有两种，一种是补零，一种是循环前缀CP或者循环后缀CS。补零适合用于UWB等场景，而CP或CS可利用循环卷积性质。

**保护频带**

由于OFDM符号是时限的，其频谱不是带限的，会有比较强的带外成分。为了减小带外成分，一方面可以对OFDM符号加窗，另一方面可以在最外侧子载波上设置虚拟载波。

**频域注水算法**

**同步技术**


------

2022-03-02

今天发现，OFDM的实现，犯了一个根本性的原理上的错误。这个错误可以归结为对多速率信号处理不熟悉。问题简要记录如下：

OFDM是利用多路正交子载波对复序列（每个点这里姑且称为码元）进行调制。当采样速率等于码元速率时，多载波调制在数学上与IDFT一致，因此可以利用IFFT加速这个过程。但是必须注意的是，这种方法的可行性，是来源于采样速率等于码元速率。对于我现在的设计参数来说，码元速率为2.56kHz，因此通过IFFT输出的复序列，实际上等于是采样率为2.56kHz的离散信号。按照多数文献上的说法，此信号将被分为IQ两路，输出到DAC转换成模拟信号，再进行后续的射频处理。

然而！在浏览器中处理数字音频信号，其采样率是48kHz，跟OFDM算法直接生成的2.56kHz采样率并不一致。这也就是说，需要对OFDM算法生成的序列进行上采样，将其变换到音频信号处理所需的48kHz采样率上，才能在浏览器中生成合适的时域音频信号。于是问题被归约为实现数字上采样。上采样的算法是信号处理领域的基本算法，其过程分为内插和滤波两个步骤。内插就是在低采样率序列中补0，然而这样会在奈奎斯特带宽内引入额外的镜像成分，因此还需要用低通滤波器将所需的基带信号过滤出来。但是，数字低通滤波器对我来说是个尚未掌握的领域，我目前还不具备自行设计FIR滤波器的技能。于是这个问题暂且保持开放，先将现有实现中错误引入的IFFT/FFT去掉。

为了换换脑子，开始读那本《RRU设计原理与实现》，却震惊地发现我刚刚遇到的问题全写在这本书里了…所以说这种闭环的感觉是很奇妙的。另外孙宇彤先生写的那本书，虽然事情是对的，但总觉得像 The Little Schemer 的风格，他会把事情描述清楚，却不告诉你那“是”什么。这样就很难按图索骥地学习。还是要给事情一个名分才行。

------

2022-02-18：信源编码，尤其是音视频编码，往往是编码器的复杂度远高于解码器；但是最近在研究OFDM，发现解码器（解调器）的复杂度要高于编码器（调制器）。原因似乎是因为解调器需要处理无线信道对信号引入的各种失真和噪声，而信源编码层面不需要处理这个问题。

------

2022-02-11

说到通信中的时间同步问题，一般的串行总线协议总是要有一条时钟线（如I2C），或者在协议层面约定同步字和传输速率（如UART）。读取DNA上的遗传信息也是类似，因为密码子是3个碱基一组，所以有3种起始读法。像HIV这类病毒可以实现三种读法都有意义。

对于OFDM，每个符号就是时域上的一个“波包”，由于符号间干扰等因素，接收端并不能单纯通过接收到的时域波形找到波包的起点，也就无法恢复出发射的符号。那么于是就发展出很多巧妙的时间同步技术，这有待深入调研。移动通信系统中，多使用GNSS提供绝对的一致的时钟基准。移动通信系统OFDM符号长度在十几毫秒量级，这个粒度比GNSS的不确定度大得多。

# 编码

## 信源编码

## 信道编码

**Reed-Solomon编码**

2022-02-12：交织的目的是将较长的差错打散为离散的随机差错，有利于纠错。为了克服无线信道衰落的影响，DRM引入了交织。而CD为了克服划痕影响，采用交叉交织的里德-所罗门编码。因此清洁CD光盘提倡径向擦拭。通俗地讲，交织是避免“一死死一片”，如同某些公司不允许多人乘坐同一架飞机。

# 解调与估计

## 数字信号的最优接收

## 匹配滤波

# 扩频

# 同步

## 载波同步

## 码元同步

## 群同步

## 网络同步

# 多址与复用

# 电子对抗与认知无线电

[蓝剑-B](https://zh.wikipedia.org/zh-hans/%E2%80%9C%E8%93%9D%E5%89%91-B%E2%80%9D%E8%AE%A1%E5%88%92)

## 关于“扫描”功能的猜想（2021-05-20）

突然意识到，接收机的扫描功能其实也属于认知无线电，只不过是认知无线电中的一小部分——频谱感知的一部分。单纯的扫描功能没有形成认知无线电的闭环，但它是基础。

没有调查研究过，但我理解（猜想）的扫描，大概有这样几个要点：

- 搜索策略方面。对于窄带接收机，可以简单遍历频段内每个可能的频点，或者依据某种先验知识（如中波广播频道宽度9kHz）缩小搜索空间。对于宽带接收机，尤其是SDR接收机，一方面可否充分利用硬件并行化能力将宽带扫描问题转化为多个子带并行扫描的问题，另一方面是否可以引入压缩感知、深度学习等手段，以“归一化”信道、接收机在不同子带上的不同参数。
- 信号检测方面。对于已知信号（如广播、模拟和数字对讲、CW等），可以引入大量先验知识，人为构造特征（模式）进行匹配。对于未知信号，至少可以通过能量、高阶统计量等通用特征，把感兴趣的信号从底噪中区分出来。

# 信息通信前沿技术展望

**信息通信的目标和愿景**

- 多·宽容泛在：大容量、全模态、全场景、全时空无缝衔接
- 快·又快又稳：高速率、高实时、低时延、稳定低抖动
- 好·优质靠谱：高质量、高精度、高安全可靠可信、高度智能化语义化
- 省·省电廉价：高效率、低成本、自运维自迭代、综合费效比高

**基本矛盾**

**方向·范式·方法论**

战略方向：感知通信计算一体化

- 应用层：交互智能，如NLP、搜索引擎、图像语音、VR/AR；应用智能，如推荐系统、专家系统（智能决策）、智能控制等。
- 表示/会话层：智能信源编码（协议）如音视频、语义网；智能安全如加密、内容识别、风险控制、访问控制。
- 传输/网络层：智能交换如路由寻径、内容分发、负载均衡、任务调度；网络状态感知分析预测、自组织自诊断自恢复自优化。
- DL/物理层：纠错、信道状态感知预测、信道资源控制管理、分集和复用（多天线）、信道编码、端到端TCVR、介质特定算法（光、量子、轨道角动量、智能超表面、毫米波太赫兹等等）。

工程基础：软件定义万物vs介质创新，软硬双向深挖

- 频谱挖潜：太赫兹、可见光…
- 全息挖潜：相位、轨道角动量…
- 材料挖潜：超材料、MEMS、光器件、量子器件

两种范式：

- 数据驱动范式：启发式的、学习式的、归纳式的
- 第一性原理范式：理性的、演绎式的

**通信革命**

语义通信

智能收发信机：

- 基于MLP的QAM解调器
- OFDM接收机：完全数据驱动 vs 数据模型双驱动
- CSI压缩
- 智能序列检测与信道译码

信息超材料：智能超表面、超透镜

认知无线电

智能能源/无线传能

**计算革命**

无线空中计算：通算一体

端到端音视频编码

**架构革命**

- 异构计算、存算融合
- 虚拟化和云化、云网融合
- 云边端协同、算力网络、东数西算
- 计算智能：复杂系统模拟、优化、动力学预测
- AIOps：复杂系统自运维

**赛博安全**

AI for Sec / Sec for AI

**感知/采集革命**

压缩感知：通感一体

全息采集/呈现→元宇宙

成像新技术

**总结与启示**

- 人工智能不完全是“人类智能”。模拟人类的感官、行为、思维，并非人工智能的唯一的任务。
- 人工智能另一方面的重要任务，应当是把人类的知识、经验输入到信息系统里面去，使其与人类协作共生、协同进化。
- 深度学习有潜力应用于一切领域，但它可能并非银弹。
- 与其寻找AI可以与哪些领域相结合，不如寻找还有哪些领域还没有与AI结合。
- 管理预期和深挖需求同等重要。AI等技术只是锤子，而问题在于钉钉子，要明确问题域和方案域。但也必须知道锤子还可以砸核桃。
- 感知、通信、计算、存储、控制，合久必分，分久必合。CI和IT融合，云网融合，信息通信和具体业务融合。
- 有些旧技术、旧理念由于**过于超前**而成为旧东西。旧东西不等于没有潜力，神经网络当年也是旧技术。
- 要注意挖掘传统算法中蕴含的精妙思想，螺蛳壳里做道场的手艺不能丢。当年算力不够技巧来凑，现在不能有了算力就不管技巧了。大力出奇迹和极致优化都是需要的。由奢入俭难。
- 数据驱动范式（开普勒、第谷）和第一性原理范式（牛顿）需要融合。
- 信息论是包括神经网络在内的所有信息系统所遵循的共同底层规律，要注意此类原则性的、尤其是限制性的底层规律。它可以指导优化方向和优化目标，防止研究者提出不切实际的目标，比如数学基础的逻辑主义探索史。
- 要重视成本收益原则。要在多快好省之间权衡。科学追求极致，但工程必须权衡。比特决定瓦特，要竭尽全力提升效率，竭尽全力提升每焦耳的比特数、每赫兹带宽的速率数。

# 计量与测量

本章主要涉及射频仪器、射频测量、精密机械（含机械滤波器、光学和激光仪器、光机电一体化和微机电系统等）、计时和导航（原子钟、天文仪器等）等。主要参考资料：

- 孙长库 等. 精密测量理论与技术基础[M]. 机械工业出版社, 2015.
- 是德科技. 频谱分析基础（应用指南150）[M]. 2016.
- 朱辉. 实用射频测试和测量[M]. 电子工业出版社, 2010.
- 萧治平 等. 钟表技术：原理、装配、维修[M]. 中国轻工业出版社, 2021.

## 机械表

2023年元旦前夕，偶然在小红薯上看到一个机械表机芯的视频，对机械表产生兴趣。

- [Illustrated Professional Dictionary of Horology](https://www.fhs.swiss/berner/?l=en)
- [中国手表Wiki](http://chinesewatchwiki.net/Main_Page)

------

2023-02-06：ETA2824-2机芯发条储能约0.3J，能量密度约1530J/L。如果按续航40h计算，则总功率约2μW，即-33dBm。如果机械表功率的1/4以表音的形式耗散出去，那么表音的功率大概也是在-33dBm这个数量级上。这个声音如果贴近耳朵仔细倾听的话，算得上是震耳欲聋了。考虑到本地FM强台在普通的拉杆天线上也能感应出-30dBm这个数量级的射频功率…一个有趣的对比。

### 机芯型号

|参数|ETA 6497-2|ETA 6497-1|ST3600    |
|------------------------------------|
|年代|1950s     |1950s     |2005      |
|直径|36.6mm    |36.6mm    |36.6mm    |
|厚度|4.5mm     |4.5mm     |4.5mm     |
|摆频|21600     |18000     |21600     |
|续航|60h       |52h       |50h       |
|升角|44°       |44°       |44°       |
|宝石|17        |17        |17        |
|上链|手动      |手动       |手动      |
|避震|Incabloc  |Incabloc  |Incabloc  |
|擒纵|叉瓦式     |叉瓦式    |叉瓦式     |
|表针|9点小秒针  |9点小秒针  |9点小秒针 |
|其他|          |          |日内瓦纹   |

[ETA官方介绍含技术文档](https://shopb2b.eta.ch/en/mecaline/6497-2-6497-2-5.html) / [资料1](https://reference.grail-watch.com/movement/eta-6497-2/) / [资料2](https://calibercorner.com/unitas-caliber-6497/) / [资料3](https://calibercorner.com/eta-unitas-caliber-6497-1-vs-6497-2/)

![海鸥ST36（鹅颈微调版）](./image/K/mechwatch/st36.jpg)

[海鸥ST36官方文档](http://www.tjseagull.com/pd.jsp?id=13#_pp=0_395_2)

> ETA6497的前身是德国Unitas6497怀表机芯，由于它尺寸大、零件大，且板路简洁清晰，因此被作为业内钟表学校学生反复拆解安装的教材。六七十年代的石英危机过后，6497这枚曾经怀表时代的经典机型，一度处于“英雄无用武之地”的尴尬境地。ETA6497大到足可以超过当时手表直径的36.6毫米的尺寸，使其无奈地被放入历史的封箱。在被ETA正式收购（1983年，ETA当时的名字叫做EBAUCHES）之前，Unitas全线生产各种型号的基本手动芯，以稳定的性能著称，且从不设计自动上弦机芯和计时等其他复杂功能。风水轮流转。大表风潮的来临，预示了ETA6497迎来了自己的春天。对于大尺寸机芯来说，最合适不过的归宿，当然是尺寸更大的手表了。大表时代，人们很介意的一个问题是，大表是否真的采用了同样比例的大机芯，还是通过小机芯加上"外套"后，上演"小马拉大车"的尴尬情景剧。可喜的是，ETA6497的尺寸正好迎合了几乎所有大表壳的需要。

> 说到ETA6497，就不能不提及沛纳海。可以说，ETA6497成就了成长过程中的沛纳海，是沛纳海产品及品牌形象发展的一个重要阶段。不过，不可否认的一点是，也有很多人可能正是通过沛纳海，才见识了这个演变自怀表的手表机芯新生代。在沛纳海采用ETA6497的实际案例中，常见的处理工艺有两种：一种是在机芯的夹板上刻有“PANERAI”字样，另一种则是采用常见的日内瓦条纹打磨处理。沛纳海修改ETA6497机芯的案例中，包括带有小秒针的OPXI（ETA6497-2）机芯和没有小秒针的OPX（ETA6497）。ETA6497和ETA6497-2的摆频都已经提升到21600次/小时，而ETA6497-1还保留怀表时期的18000次/小时的低摆频。ETA早在5年前就已经不再对外出售ETA6497-2机芯，仅供应其集团旗下的部分高级腕表品牌使用。特别是沛纳海的款式，使用6497机芯的款式非常多。在停止对外出售ETA6497-2机芯之前，一些机芯商囤积了很多机芯，但据笔者所知，这部分囤货机芯也早在2010年使用完毕了。目前市场上极少量ETA6497售价也要在4500元以上。

> 目前，国内有两种仿ETA6497，一种是海鸥ST3600仿的是ETA6497后期版本，摆频是21600次/小时；另一种是杭州9000仿的ETA6497早期版本，摆频是18000次/小时的低摆频。两者主要用于高仿沛纳海系列腕表。

> 杭州9000比较容易鉴别，这款机芯仿制早期的ETA6497，动力时间50小时，摆频18000/小时。最直接的方法就是测下摆频。外观上来看，杭州9000的避震直口，且和其他两个机芯的开口角度差了90度。杭州9000快慢针是尖的，不同于其他两个机芯的剑型快慢针。再看摆轮下的叉夹板，现在的ETA6497和海鸥ST3600为环形桥式叉夹板，杭州9000为悬臂式叉夹板，像个香肠。

> 海鸥ST3600外形和ETA6497非常相似，尤其是现在一些仿厂还改了外形，更以假乱真，一些JS也藉此冒充原装ETA6497骗了不少小白的钱。不过可以分三步来鉴别：首先看避震，直口避震肯定不是ETA6497；其次看钢印，游丝下面是否有eta的钢印；最后看齿轮打磨，有些海鸥ST3600被仿厂改了豁口避震并加了钢印，那么就看齿轮打磨了，ETA6497齿轮打磨斜面部分在外缘，而海鸥st3600斜面部分要向内深入一些。（[参考资料](https://www.xhmq168.com/html/ddzs/zbgjs/10752.html)）

[沛纳海 Caliber OP XI](https://calibercorner.com/panerai-caliber-op-xi/) → 海鸥ST3600

[ST3600保养维修视频](https://www.bilibili.com/video/BV1VE411j7ut)

|参数|TY2809/ST1601K3|ST1902    |
|-----------------------------------------------------------|
|年代|?         |?         |
|直径|31mm      |31.3mm    |
|厚度|5.18mm    |6.25mm    |
|摆频|21600     |21600     |
|续航|36h       |42h       |
|升角|?°        |52?°        |
|宝石|21        |22        |
|上链|自动      |手动       |
|避震|Incabloc  |Incabloc  |
|擒纵|叉瓦式    |叉瓦式     |
|表针|中央秒针  |9点小秒针  |
|其他|镂空      |30min计时  |

[海鸥TY2809](https://calibercorner.com/seagull-caliber-ty2809/)

国产统一机芯

> 我国在1958年于天津生产出第一块手表，接着上海、北京、辽宁、广州也都先后生产出自制表。一九六九年十二月，轻工业部在上海召开了全国手表行业会议，借鉴一九五九年十二月部级鉴定N1型闹钟统机机芯的研发经验，着手研究手表统一机芯设计问题。会后，轻工业部即组织上海钟表工业公司、上海手表厂、上海手表二厂、北京、天津、辽宁、广州手表厂和西安红旗手表厂、风雷仪表厂，连同轻工业部钟表工业科学研究所（一九六六年在西安成立）、天津大学计时仪器专业等单位的技术人员与学者，组成手表统一机芯设计小组，一九七〇年三月开始工作。设计小组总结了十几年来我国手表生产的实际经验，对比国外各种手表机芯的优缺点，通过机芯设计，样机试制，批量试制和图纸定型几个阶段，于一九七一年七月（也有说是十月的），SZ1型手表统机机芯定型。SZ1型结构简单，零件数量少，只有83种109型，走时精度每昼夜误差在正负30秒之内。
一九七二年，轻工业部将SZ1型机芯正式向全国推广。一九七五年后，全国手表厂绝大多数采用了统机，全国手表产量从一九六七的134.4万只，一九七四年的656.4万只，提高到一九八二年的3301万只，为普及当时的“三大件”做出卓越贡献。八十年代，统机手表产量超过全国手表总产量的80%以上。SZ1型手表经受了各种考验，质量也不断提高，并在此基础上发展了好些子型号，为中国手表事业的最成功的标志性工程。

> 上海牌7120手上条机芯则为后来广为使用的统机心，或者称为SZ1型机芯。SZ1型全国统一机芯，SZ1的”S”代表手表，”Z”代表中国，”1”代表第一型。除上海手表四厂的”钻石牌”，天津手表厂生产的”东风牌”和”海鸥牌”，南京手表厂生产的”钟山牌”外，其他手表厂生产的手表基本上都是统一机芯手表。这些表的牌名是：上海手表一厂的”春蕾牌”和”上海牌”，北京手表厂的”双菱牌”和”北京牌”，西安红旗手表厂的”蝴蝶牌”和”延安牌”，上海手表二厂的”宝石花”牌，广州手表厂的”广州牌”，辽宁手表厂的”孔雀牌”，青岛手表厂的”金锚牌”，重庆手表厂的”山城牌”，苏州手表厂的”苏州牌”，武汉手表厂的”武汉牌”等。

> 统机手表的结构特点：

> - 条盒轮与中心轮轴齿采取1:6的传动比，使发条的力矩输出平稳，降低了落差，提高了手表的等时性，减少了磨损，延长了机芯的运转寿命。
- 摆轮直径大，增加了转动惯量，抗干扰能力增强，显著提高了手表的走时精度。
- 中心轮片安排在条盒轮下面，上夹板和条夹板在同一平面，机芯厚度较薄，改进了外观造型。
- 机芯设计中考虑了增加日历、周历、自动等附加装置，便于多品种发展。
- 由于是统一结构、统一标准、零件数量又较少，因此便于生产、便于维修。（[参考](https://zhuanlan.zhihu.com/p/333761135)）

### 机芯结构

2022-01-08：钟表的擒纵机构十分神秘。如果强行类比的话，大概可以对应到电路中的比较器、触发器。前者对应连续运动的离散化，后者对应若干个离散运动状态的保持和翻转。常用时钟芯片555的内部便是两个比较器和一个RS触发器，搭配弹性元件（电容）对其反复充放电，即可输出周期性信号。擒纵机构一方面将能量从原动系传递给摆轮游丝系统，为摆轮游丝系统提供策动力，维持其受迫振动；另一方面将振动信号离散化，输出给传动轮系，使其匀速运行。有资料认为擒纵机构的机械效率不超过50%，发条的多数能量浪费在擒纵机构上，因此擒纵叉点油十分讲究，以提高精度、减小损耗。中国人很早就发明了擒纵机构。唐代僧人一行建造了含有擒纵机构的水力天文钟，被认为是时钟擒纵机构的发明者。

避震器

![[Incabloc避震器](https://www.xbiao.com/20190704/54644.html)](./image/K/mechwatch/incabloc.gif)

> [维基百科](https://zh.wikipedia.org/zh-cn/%E6%A9%9F%E6%A2%B0%E8%A1%A8%E9%81%BF%E9%9C%87%E5%99%A8)：防震簧都是钢质镀金的。原理是能够把手表受到的剧烈冲击和震动给吸收掉，这个主要靠防震器托钻与防震器座以及防震弹簧的相互配合。手表最娇气和轴榫最细的部位，就是摆轮轴尖，它大约仅有0.07-0.08毫米的直径，和一个成人的头发直径是一样粗细的。但是摆轮整个的质量还大，如果没有保护措施，一旦手表受到剧烈震动后，摆轮轴尖肯定要被震断或震歪。早年不防震的手表或怀表，在摔过以后，摆轴尖指定要断，所以换摆轴是当时手表维修中经常遇到的活。一旦换过摆轴，手表就很难再走准走好了。

> 很多手表专业书籍在理论上都阐述过防震器的工作原理，简尔言之，手表受冲击或震动力的方向，可分解为典型的三种：（1）轴向的、（2）径向的、（3）侧向的。关键在于防震器座和防震器托钻之间是斜面配合的（大约呈45度角），它可以产生滑动位移，防震器托钻也俗称“防震碗”， 当防震碗沿防震器座斜面移动时，防震弹簧被迫隆起变形，同时吸收了来自摆轴的冲击能量。下一步，将是摆轮轴榫尖下端比粗的部位和防震基座孔的内沿相碰击，摆轮轴这个部位直径比粗，它能够承受得住的。防震器仅仅保护的是摆轮哪个像发丝般的轴尖，来自所有方向的受力（包括轴向和径向的冲击力）基本上都是这样保护的。

> 防震器除了起防震作用外，它还有保油作用，在防震碗和防震盖眼之间，要加适量的表油，这里的加油也非常严格和讲究。要知道，每天摆轮轴榫在这里要高速的摆动摩擦达69万次之多。

> 瑞士手表使用最多的牌号防震器就是大名鼎鼎的因加百禄 （INCABLOC），据说其防震效果非常之完美，不可超越，你只要稍微更改一点点尺寸或形状，那防震效果肯定就不好了。以前国产手表也做类似样式的防震器，就是看上去有点瘦长些。除此之外还有KIF，它哪个防震簧看上去就像蝎子的两个前臂那样，弯曲然后合拢，我有个因加百禄防震器的样品盒，里面大大小小的不同规格竟然有40种之多，ETA机心上使用因加百禄防震器最为普遍，但是往往主夹板和摆夹板上面的防震器大小不一样，主夹板上的要小一些。

> 瑞士名牌大表通常是选用KIF防震器，比如劳力士ROLEX、百达菲丽Patek pilippe、江诗丹顿Vacheron Constantin、爱彼AUDEMARS PIGUET等等。它也有很多种类和规格，在修表拆装防震器加油时，那可是一个高难度的“惊险”过程，因为一是容易弄丢了零件，二是容易使防震簧脱落，我的经验是不可以把防震簧拨开后掀起过高，还有是防震盖眼一定要很平的、压放到位的装入防震碗内，然后再封闭防震簧。

> 防震器是机械手表里面的一个重要部件，通过它可以揣摩评判出手表的档次，甚至还可以分辨出真假。因为瑞士名牌手表不可能使用日本或国产的防震器，顶级大牌手表也不会使用低档的防震器，比如三角型防震器（见照片），说它是三角防震器，实际样子有点像个梅花，只不过是3个掰的。仿冒瑞士品牌的假表，使用的是廉价的瑞士表芯，因此在防震器上，往往就露出了马脚。

> - 三角避震器：三角避震器是最廉价的一种避震器，其避震弹簧在避震底座上有三个支点。
- Incabloc（因加百禄）避震器：因加百禄避震器是较为高级的一种避震器，其弹簧成马蹄形状，常见于瑞士制的机械腕表。
- Kif避震器：Kif避震器是最高级的手表避震器之一。Kif性能优越，尤其是对微弱冲击，凭借其单棱角，缓和了渐进的冲撞，而且防震簧替换简便，三个支撑点平衡了压力，使摆轴能够回到最佳中心位。
- Nivachoc避震器：Swatch集团旗下的宝玑于2006年发布Nivachoc避震器，由于那个弹簧片如同两个英文字母“T”的组合，所以也有人称这种避震器为“双T避震器”， 这种避震器可以更好的减少摆轮轴尖的位移，同时还可以大幅度降低给手表朝下的冲击力，现在欧米茄OMEGA、浪琴LONGINES、雷达（RADO）等品牌都有装配这种避震器。
- Paraflex避震器：弹簧金属片经过力学计算，结构较Incabloc与Kif复杂不少，首款运用于劳力士7040机芯。根据官方资料，Paraflex较KIF增加了50%的抗震能力，能有效增加机芯耐用度。

### 维修技术

2023-01-06：实际操作发现，其实手并不抖，最大的问题是眼睛…看几分钟眼睛就花了，对不上焦，可能需要整一个台式的显微镜一类的东西，问题的重点在于支撑结构。

2023-01-06：为了搞清楚煤油的安全性问题，调研了一番，一方面是可燃性问题，煤油闪点38℃以上，冬天相对安全，甚至比酒精安全（消毒酒精闪点在20℃左右）。另一方面是毒性问题，煤油属于微毒，有刺激性和一定的神经毒性。打火机油里面可能混有其他有毒杂质，如苯等，应避免吸入。

润滑油

- 国产上海：701钟油、702表油
- 瑞士Moebius：

### 校表仪

校表仪如何计算摆轮摆幅？以下是目前（2023-01-09）的调研结论。

校表仪采集两个参数，一是滴答声的重复周期，二是每个滴答声本身的持续时间。只要测得滴答声的持续周期，立刻可以得到系统的实际固有频率$\Omega$(rad/s)，等价于钟表行业常用的摆频$f_{bph}$(bph)指标，进而可以计算出日差、频率偏差等参数。

每个滴答声在微观上由三个脉冲构成。第一个脉冲是圆盘钉撞击擒纵叉，导致擒纵叉释放擒纵轮所产生，可称为释放（unlocking）脉冲。第二个脉冲是擒纵轮通过擒纵叉向摆轮传递冲量时轮齿和叉瓦间发生碰撞而产生，可称为传冲（impulse）脉冲。第三个脉冲是擒纵轮传冲完毕后加速前进，其轮齿突然被出瓦挡住，发生碰撞，可称为跌落（drop）脉冲。

这三个脉冲从开始到结束，构成一个滴答声。而在机械结构上，擒纵机构产生滴答声的运动阶段，大致对应摆轮经过摆轮升角（lift angle）的阶段。因此，可以用滴答声的持续时间来度量摆轮转过摆轮升角的时间。而在信号处理层面，选取释放脉冲上升沿和跌落脉冲上升沿之间的时间，作为滴答声的持续时间T。摆轮升角$A_L$（deg）是钟表的机械设计参数，一般来说不会发生变化。ETA原厂6497-2机芯的$A_L$是44°，但是海鸥ST36（手上实际有的，其原型是沛纳海对ETA的6497-2机芯的魔改版Caliber OP XI）的摆轮升角不知道是多少，或许需要用高速摄影一类的手段去实测吧。

为了计算摆轮的摆幅，将其视为简谐振动，用简单的正弦函数$x(t)=A \cdot \sin(\Omega t)$对其建模，其中$A$即为摆幅（deg）。需要说明的是，实际上摆轮游丝系统是受迫振动的，在传冲阶段前后的运动状态应该是不同的。但系统的固有频率是固定的，为了方便分析，将其视为简谐振动。另一方面，摆轮运动的一个半周期，其摆幅位置并不是关于擒纵叉位置对称的。但是为了方便分析，姑且认为擒纵叉方向是平衡位置，因而上式中x是圆盘钉相对于擒纵叉方向的旋转角度。忽略初相项，以圆盘钉位于擒纵叉槽中心位置（即平衡位置）的时刻为零时刻。由于做了简谐运动的假设，摆轮（圆盘钉）零时刻前后的运动状态是对称的，而零时刻圆盘钉位于擒纵叉槽中心，是摆轮升角的一半，因此有如下结论：当$t=T/2$时，$x=A_L/2$。$T$是实测的，$A_L$是机芯设计参数，代入运动方程得

$$ A = \frac{A_L}{2 \cdot \sin( \Omega T / 2)} $$

但是考虑到滴答声持续时间$T$远远小于摆动周期，因此对sin项做等价无穷小代换就得到一个更简单的式子

$$ A = \frac{A_L}{\Omega T} = \frac{A_L \cdot 3600}{\pi \cdot f_{bph} \cdot T}$$

其中$f_{bph}$是摆频（每小时滴答数）、$\pi$是圆周率、$A_L$是摆轮升角(deg)、$T$是前面测得的滴答声持续时间(s)。这就是目前在参考资料中看到的式子。当然这个式子做了很多假设和近似，不见得能精确计算真实摆幅，但是考虑到校表仪给出的摆幅实际上是对表观滴答声信号特征的一种形象化描述，按照公式计算出来的摆幅也确实能够为校表工作提供参考，因此这样计算应该是合理的

![海鸥ST36机芯实测滴答信号（2023-01-09）](./image/K/mechwatch/st36-ticktock-waveform.png)

- [TNP #26 - Magic of Mechanical Timekeeping & Measuring the Accuracy of a Raymond-Weil Skeleton Watch](https://www.youtube.com/watch?v=DEhWEKGwG2s)

### 其他笔记

2023-01-05

+ 买了两个祖国版6497机芯当机械手办，严格来说是某种类似于指尖陀螺、手串之类的玩物，每天随身携带，什么都不想干的时候，就盯着摆轮看，放空大脑。
+ 修表视频配上古典音乐真是太优～雅啦。欧洲人很久以前就开始研究精密机械了，古希腊曾制造过一台精巧的天文机械，被称为[安提基特拉机械](https://zh.wikipedia.org/wiki/%E5%AE%89%E6%8F%90%E5%9F%BA%E7%89%B9%E6%8B%89%E6%9C%BA%E6%A2%B0)。另外古罗马人用石头建造一种高塔，称为“[风之塔](https://zh.wikipedia.org/wiki/%E9%A2%A8%E4%B9%8B%E5%A1%94)”，其功能类似于我国的钟鼓楼。
+ 说起精密机械和风之塔，空之轨迹的设定当中，导力器似乎是一种由虚构“导力”驱动的类似于怀表的精密机械，随身携带，赋予其主人以导力魔法。而洛连特城中心有一座重要地标建筑，似乎就是风之塔一类的建筑。
+ 空之轨迹的结晶回路配置系统很有特色。
+ 不打算在机械表这个领域投入太多，适可而止就好。

## 心得笔记

**2022-05-01**

有个所谓的“手表定律”，表示人不能戴两块表，否则就会失去对准确时间的信心（但是戴三块以上似乎就可以通过统计的方式估计出一个准确时间了）。诸如频谱仪的精密仪器也有类似的现象：如果两台仪器给出不同的读数，就会同时削弱实验者对两台仪器的信任。当然，严肃的仪器都会给出不确定度指标，这与其说是统计问题，不如说是一种建立信任的机制。**很多情况下，相对的“信任”比绝对的“真相”更重要。**

**2022-03-22**

频谱仪有气压计，可以用作高度表。但是气压和海拔高度并没有确定的对应关系，因此我一度怀疑高度表这个功能是不是只是用来凑数的。后来突然意识到，无线电工程，很多情况下是要登高作业的，这个时候，相对高度表就非常有用了。以及今天看《空中浩劫》的时候了解到，飞机的高度表实际上也是要经常人工校准的。如果校准不及时或者不正确，就会测得错误的高度。（美国航空1572）

**2021-11-09**

从入手KC908U频谱仪、以及取得B类操作资格开始，我的业余无线电的玩法从定性的方式，逐渐进化到定量的方式。

统计学上，把数量（尺度）分成4类：定类量、定序量、定距量、定比量。代数学上似乎对应不同的代数结构，但这里不深究，只需要知道，即使是定量的玩法，也是有量化程度的差异的。

一般的业余无线电玩法，有许多量化的因素。如波段划分是典型的定类量，RST信号报告是定序量，信号强度S值、天线增益是定距量，电压、功率、频率、场强是定比量，等等。但这种程度的量化，多数以定序、定距为主，强调的是区分高下和方便放缩、叠加，并不追求绝对的物理数值。比如天线增益就是个典型的定距量，它的定义是与标准天线之间的增益之比，主要用途是比较天线性能高下，并不关心标准天线的绝对性能。实际上“增益”这个词就已经提示它（一般）是等距量了，因为“增益”是相对于某个基准点的增益。

但是在严肃的射频技术中，关注的定比量就多起来了，要关注五花八门的“分贝”背后的基准值究竟为何。最典型的就是S表，S表在不同波段的基准值是不一样的，这是B类考题里提到的事情。在无线电领域，最神秘的物理量大概就是场强了。场强在物理学上的标准单位是V/m，即单位距离上的电势差。但是这个量很难测量，一般要用参数已知的天线作为探头，使被测电磁场在天线上感应出交变电压，驱动已知负载产生交变电流，通过测量负载上消耗的功率（同时可知电压和电流），结合天线增益、馈线损耗等参数（统称为天线系数），反推出被测场强的绝对值。

从场强测量的例子可以看出，对于电子/射频测量来说，探头（如天线）实际上是极为重要的、甚至是决定性的环节，因此高质量的探头十分昂贵。

一般的射频测量仪器，如现有的KC908U，测量的是50欧固定负载上的输入电平。“电平”也是个十分神秘的术语，表面上看它指的是电压，但它实际上指的是功率。并且它一般以dBm为单位，这就意味着它是在指定负载和参考电平的条件下，用来描述相对功率的一个定距量。

绝对基准问题是个困难的问题。计量领域，有“标定”“校准”“检定”“校验”等术语。在我看来，标定，就是确定绝对基准、消除系统误差的过程；校准，就是确定相对增量的变化规律，使其保持精确。校准件确实一般都比较贵，因为它提供了绝对的基准。我的理解是，未经标定的仪器就是玩具，只能获取定距尺度。只有确定了绝对基准的仪器，才能获取准确可信的定比尺度。

仪器这东西，信则准，不信则不准。

**2021-01-14**

科创论坛上学到一招<sup>\[1\]</sup>：古时候的实时频谱分析，因为没有像今天这样的高速器件，所以会想办法把被测信号调制到光信号上，然后用棱镜之类的光学器件对光信号作时域傅里叶变换<sup>\[2\]</sup>（其实就是色散），就可以得到被测信号的实时频谱。

- [参考1：实时频谱仪的历史](https://www.kechuang.org/s/vpsc7jmj)
- [参考2：傅里叶光学](https://www.zhihu.com/question/23225011/answer/833003906)



# 光电子学·光机电一体化

- 光器件的复数能带具有某种拓扑不变性
- 光能量在光材料中可实现增益或损耗
- 类似于电感和电容在数学上的共轭关系
- 利用“拓扑荷”可以制成：
-- 低损耗光波导：可用作光IO
-- 高Q光学微谐振腔：可用作片上集成激光源

# 微纳制造·MEMS·合成化学

2023-02-03：评[材料科学新进展](https://weibo.com/1730177302/MriSNh5xG)：但是我感觉虽然微观尺度上的确存在合理的设计，但是并不能实现合理的控制。什么时候能生产出像生物组织那样的复合材料呢？有信号和能量的微观通路穿插其中，微观结构可以在局部范围内响应主动的控制。可重构信息超材料已经在往这个方向走了。








# 复杂系统及其可视化

推荐文献：

- 保罗·西利亚斯. [**复杂性与后现代主义：理解复杂系统**](https://book.douban.com/subject/1794206/)[M]. 上海世纪出版集团, 2006.

零散概念：

- [Deutsch limit](https://en.wikipedia.org/wiki/Deutsch_limit): The problem with visual programming is that you can't have more than 50 visual primitives on the screen at the same time.
- [邓巴数](https://zh.wikipedia.org/wiki/%E9%82%93%E5%B7%B4%E6%95%B0)：也称150定律，指能与某个人维持紧密人际关系的人数上限，通常人们认为是150。所以公司一个完整的基层部门的人数在100人～150人。党的支部要建立在连上，因为一个连大约也是100多人。
- [时间晶体](https://zh.wikipedia.org/wiki/%E6%99%82%E9%96%93%E6%99%B6%E9%AB%94)
- 选择与适应：控制的两个基本方面。

## 元胞自动机

<iframe class="MikumarkIframe" src="./html/conway-gol.html" height="750px"></iframe>

- [Particle Life | シャポ庫](https://www.shapoco.net/particlelife/)

## 单峰映射系统

2018-05-15

<iframe class="MikumarkIframe" src="./html/logistic-map.html" height="500px"></iframe>

![分枝图](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7d/LogisticMap_BifurcationDiagram.png/640px-LogisticMap_BifurcationDiagram.png)

: [单峰映射](https://en.wikipedia.org/wiki/Logistic_map) | [费根鲍姆常数](https://en.wikipedia.org/wiki/Feigenbaum_constants) | [分岔理论](https://zh.wikipedia.org/wiki/%E5%88%86%E5%B2%94%E7%90%86%E8%AB%96)

## 化学振荡·自复制自催化·图灵模式

<details>
<summary>蓝瓶实验</summary>

2018-02-27

[蓝瓶实验](https://en.wikipedia.org/wiki/Blue_bottle_experiment)是非常容易实现的并且效果明显的小实验。淘宝上有卖蓝瓶实验的材料，很久以前就加入购物车了，但是因为在购物车的底部，所以直到最近才买回来。实验材料包括一个小瓶子和三种试剂，其中两种试剂是白色的粉末，还有一小管亚甲蓝溶液。说明书上并没有说试剂具体是什么，猜想除了亚甲蓝溶液之外，其余两种应该是葡萄糖和氢氧化钠。

实验前，向小瓶子里加入一半多一点的水，总之不要装满。将三种试剂加入装水的小瓶子，拧紧盖子，振荡，直至所有固体溶解。静置片刻，就会发现蓝色的溶液变成了无色溶液。当溶液变成无色之后，充分振荡，无色的溶液又变回蓝色。静置，溶液又变成无色。如此重复，瓶中的溶液在蓝色—白色之间循环变化，很有意思。

**原理解释**

亚甲蓝容易被氧气氧化，氧化的亚甲蓝呈蓝色；碱性溶液中，亚甲蓝也容易被葡萄糖这样的弱还原剂还原为无色的亚甲蓝。

所谓的“氧化性”，可以简单地理解为夺取电子的能力。例如，氟气氧化性极强，因为它的最外层电子轨道非常饥渴，很容易捕获一个电子，变成氟离子$\mathrm{F}^-$。反过来看，“还原性”可以理解为失去电子的容易程度。

某种物质的氧化性越强，意味着它越容易抢到电子，同时自身被还原。氧化剂被还原后得到的还原产物，应当是具有某种程度的还原性的，因为也许有更强的氧化剂，可以夺走它刚刚抢到的电子。因此，根据置换反应能否发生，就可以定性地判断出各种氧化剂的氧化性强弱。例如，对于氯气氧化氢溴酸的反应：

$$ \mathrm{Cl_2 + 2HBr = 2HCl + Br_2} $$

这个反应之所以能进行，就是因为氯气的氧化性比溴强。设想，氢溴酸中的溴离子，本身就是溴单质抢到电子后的产物，结果被氯气抢走了自己凭本事抢到的电子，说明氯气的本事比溴大。反过来，盐酸和溴水之间就不会发生这样的置换反应，因为溴没有足够的本领夺走氯离子手中的电子。

可见，氧化还原反应的本质，就是电子的转移。这样，所有的氧化还原反应都可以看成**电池**，吸取电子（电流流出）的[[#ff0000:**氧化剂**#]]是电池的[[#ff0000:**正极**#]]，提供电子（电流流入）的[[#0000ff:**还原剂**#]]是电池的[[#0000ff:**负极**#]]。如果氧化剂足够从还原剂中夺取电子，或者说还原剂足够容易失去电子，那么电池反应可以自发进行；反之，电池反应不能自发进行。

有电池，就有**电动势**。如果电池可以对外放电，也就是氧化还原反应可以自发进行，就可以测出一个正的电势差；反之，则不会有电势差产生。为了定量地衡量物质的氧化还原性强弱，通过实验，可以测定某种条件下，两种电极物质之间的相对电极电势。如果选定氢原子的电极电位为0，并确定标准状况，那么就可以得到其他物质的有正有负的**标准电极电位**。

如果某种物质的标准电极电位为正，意味着它能够从氢离子中夺取电子；反之，意味着这种物质可以被氢夺走电子。

举两个极端的例子。氟是氧化性最强的元素，反应$\mathrm{ F_2 + 2H^+ + 2e^- = 2HF }$的标准电极电势高达3.05V。作为对比，最强碱金属之一的铯，反应$\mathrm{ Cs^+ + e^- = Cs }$的标准电极电势达到了-2.92V。

有了标准电极电势这个指标，就可以定量判断氧化性（还原性）孰强孰弱了。

查资料可知，葡萄糖/葡萄糖酸是0.05V，亚甲蓝/无色亚甲蓝的标准电极电位是0.36V，氧气/水（酸性溶液）是1.229V，氧气/氢氧根是0.401V。显然，亚甲蓝就是夹在中间的那一个。在蓝色亚甲蓝分子中，硫原子带正电荷，呈现一定的氧化性。在蓝色溶液中，亚甲蓝会氧化葡萄糖，自身转变为下图右侧的无色亚甲蓝，而葡萄糖被氧化成葡萄糖酸。摇晃瓶子，使氧气与溶液充分接触，在碱性条件下，无色亚甲蓝将氧气还原成水。总反应中，体系中的葡萄糖被氧化为葡萄糖酸，消耗氧气，而亚甲蓝只是起到了电子传递的作用，自身并没有消耗，随着传递的过程在蓝色和无色之间来回变化，所以又称为亚甲蓝的**化学振荡**。

![图自维基百科](./image/H/blue-bottle-experiment.png)

亚甲蓝是一种有毒性的染料。由于亚甲蓝可以氧化血红蛋白为易于与$\mathrm{CN^-}$结合的高铁血红蛋白，暂时缓解细胞缺氧，因此可作为氰化物中毒的解毒剂。

</details>

其他化学振荡：#(碘钟实验)#、[#(B-Z反应)#](https://zh.wikipedia.org/wiki/B-Z%E5%8F%8D%E5%BA%94)

化学自复制自催化行为：[会自我复制和进化的分子](https://zhuanlan.zhihu.com/p/20491568)、朊病毒等

- [Turing pattern](https://en.wikipedia.org/wiki/Turing_pattern)、[反应-扩散系统](https://en.wikipedia.org/wiki/Reaction%E2%80%93diffusion_system)
- [人为什么会有指纹？](https://www.zhihu.com/question/19962632/answer/3289200022)
- [从简单规则中产生复杂图案，自然是如何做到的](https://swarma.org/?p=28086)

## Orchestrated objective reduction

彭罗斯提出的一种意识理论，详见[维基百科](https://zh.wikipedia.org/zh-cn/%E5%8D%8F%E8%B0%83%E5%AE%A2%E8%A7%82%E8%BF%98%E5%8E%9F)。

## 藏本模型

- 时间：2020-12-17
- 参考1：[维基百科](https://zh.wikipedia.org/wiki/%E8%97%8F%E6%9C%AC%E6%A8%A1%E5%9E%8B)
- 参考2：[视频](https://weibo.com/3176804502/JyuTd8JCj)

藏本模型，是一种描述耦合振子同步的模型。藏本模型（Kuramoto model）是一种用来描述同步的数学模型，由日本物理学家藏本由纪首先提出。具体说来，它描述了大量耦合振子的同步行为。这个模型原本是为了描述化学振子、生物振子而构建，后发现具有广泛的应用，例如神经振荡，以及振荡火焰的动力学。惊人的是，一些物理系统的行为也符合这个模型，比如耦合约瑟夫森结的阵列。这个模型假设，所有振子都是完全相同的或几乎完全相同的，相互之间的耦合很弱、并且任意两个振子之间的相互作用强度取决于它们相位差的正弦。
